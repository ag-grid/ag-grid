{"version":3,"sources":["reactUi/cells/popupEditorComp.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,kDAAuE;AACvE,+CAA0D;AAC1D,yCAAyC;AAEzC,kDAA+C;AAC/C,oDAAiD;AAEjD,MAAM,eAAe,GAAG,CAAC,KAMhB,EAAE,EAAE;IAET,MAAM,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,GAAG,gBAAQ,EAAsB,CAAC;IAEnF,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,aAAa,EAAE,kBAAkB,EAAE,GAAG,kBAAU,CAAC,2BAAY,CAAC,CAAC;IAE9F,6BAAa,CAAE,GAAG,EAAE;QAChB,MAAM,EAAC,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAC,GAAG,KAAK,CAAC;QACnD,MAAM,EAAC,WAAW,EAAC,GAAG,WAAW,CAAC;QAElC,MAAM,aAAa,GAAG,kBAAkB,CAAC,EAAE,CAAC,+BAA+B,CAAC,CAAC;QAE7E,MAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,yBAAkB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC;QAC/E,MAAM,SAAS,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;QAEnC,IAAI,KAAK,CAAC,WAAW,EAAE;YACnB,MAAM,SAAS,GAAG,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAC7C,IAAI,SAAS,EAAE;gBACX,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;aACpC;SACJ;QAED,MAAM,cAAc,GAAG;YACnB,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE;YAC5B,OAAO,EAAE,QAAQ,CAAC,UAAU,EAAE;YAC9B,IAAI,EAAE,iBAAiB;YACvB,WAAW,EAAE,WAAW;YACxB,MAAM,EAAE,SAAS;YACjB,QAAQ,EAAE,WAAY,CAAC,aAAa;YACpC,gBAAgB,EAAE,IAAI;SACzB,CAAC;QAEF,MAAM,gBAAgB,GAAG,YAAY,CAAC,wBAAwB,CAAC,IAAI,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;QAElG,MAAM,SAAS,GAAG,aAAa,CAAC,iBAAiB,EAAE,CAAC;QAEpD,MAAM,WAAW,GAAG,YAAY,CAAC,QAAQ,CAAC;YACtC,KAAK,EAAE,aAAa;YACpB,MAAM,EAAE,SAAS;YACjB,UAAU,EAAE,IAAI;YAChB,cAAc,EAAE,GAAG,EAAE,GAAG,QAAQ,CAAC,mBAAmB,EAAE,CAAC,CAAC,CAAC;YACzD,eAAe,EAAE,WAAW;YAC5B,gBAAgB;YAChB,SAAS,EAAE,SAAS,CAAC,qBAAqB,EAAE,aAAa,CAAC;SAC7D,CAAC,CAAC;QAEH,MAAM,eAAe,GAA2B,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC;QAE/F,qBAAqB,CAAC,OAAO,CAAC,CAAC;QAE/B,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW,CAAC,gBAAgB,IAAI,KAAK,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;QAEhG,OAAO,GAAE,EAAE;YACP,IAAI,eAAe,IAAE,IAAI,EAAE;gBACvB,eAAe,EAAE,CAAC;aACrB;YACD,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC,CAAC;IAEN,CAAC,CAAC,CAAC;IAEH,OAAO,CACH,8DACM,kBAAkB,IAAI,KAAK,CAAC,cAAc;WACpB,wBAAY,CAAC,KAAK,CAAC,cAAc,EAAE,kBAAkB,CAAC,MAAM,EAAE,CAAC,CACxF,CACN,CAAC;AACN,CAAC,CAAC;AAEF,kBAAe,YAAI,CAAC,eAAe,CAAC,CAAC","file":"popupEditorComp.js","sourcesContent":["import { CellCtrl, PopupEditorWrapper } from '@ag-grid-community/core';\nimport React, { useState, memo, useContext } from 'react';\nimport { createPortal } from 'react-dom';\nimport { EditDetails } from './cellComp';\nimport { BeansContext } from '../beansContext';\nimport { useEffectOnce } from '../useEffectOnce';\n\nconst PopupEditorComp = (props: {\n            editDetails: EditDetails, \n            cellCtrl: CellCtrl, \n            eParentCell: HTMLElement,\n            wrappedContent?: any,\n            jsChildComp?: any\n        }) => {\n\n    const [popupEditorWrapper, setPopupEditorWrapper] = useState<PopupEditorWrapper>();\n\n    const { context, popupService, localeService, gridOptionsService } = useContext(BeansContext);\n\n    useEffectOnce( () => {\n        const {editDetails, cellCtrl, eParentCell} = props;\n        const {compDetails} = editDetails;\n\n        const useModelPopup = gridOptionsService.is('stopEditingWhenCellsLoseFocus');\n        \n        const wrapper = context.createBean(new PopupEditorWrapper(compDetails.params));\n        const ePopupGui = wrapper.getGui();\n\n        if (props.jsChildComp) {\n            const eChildGui = props.jsChildComp.getGui();\n            if (eChildGui) {\n                ePopupGui.appendChild(eChildGui);\n            }\n        }\n\n        const positionParams = {\n            column: cellCtrl.getColumn(),\n            rowNode: cellCtrl.getRowNode(),\n            type: 'popupCellEditor',\n            eventSource: eParentCell,\n            ePopup: ePopupGui,\n            position: editDetails!.popupPosition,\n            keepWithinBounds: true\n        };\n\n        const positionCallback = popupService.positionPopupByComponent.bind(popupService, positionParams);\n\n        const translate = localeService.getLocaleTextFunc();\n    \n        const addPopupRes = popupService.addPopup({\n            modal: useModelPopup,\n            eChild: ePopupGui,\n            closeOnEsc: true,\n            closedCallback: () => { cellCtrl.onPopupEditorClosed(); },\n            anchorToElement: eParentCell,\n            positionCallback,\n            ariaLabel: translate('ariaLabelCellEditor', 'Cell Editor')\n        });\n    \n        const hideEditorPopup: (()=>void) | undefined = addPopupRes ? addPopupRes.hideFunc : undefined;\n\n        setPopupEditorWrapper(wrapper);\n\n        props.jsChildComp && props.jsChildComp.afterGuiAttached && props.jsChildComp.afterGuiAttached();\n\n        return ()=> {\n            if (hideEditorPopup!=null) {\n                hideEditorPopup();\n            }\n            context.destroyBean(wrapper);\n        };\n\n    });\n\n    return (\n        <>\n            { popupEditorWrapper && props.wrappedContent \n                                 && createPortal(props.wrappedContent, popupEditorWrapper.getGui()) }\n        </>\n    );\n};\n\nexport default memo(PopupEditorComp);\n"]}