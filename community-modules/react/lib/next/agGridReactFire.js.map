{"version":3,"sources":["next/agGridReactFire.tsx"],"names":[],"mappings":"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","file":"agGridReactFire.js","sourcesContent":["import React, { Component } from 'react';\nimport { _, ColumnApi, ComponentUtil, Context, GridApi, GridCoreCreator, GridOptions, GridParams } from '@ag-grid-community/core';\nimport { AgGridColumn } from '../agGridColumn';\nimport { ChangeDetectionService, ChangeDetectionStrategyType } from '../changeDetectionService';\nimport { AgReactUiProps } from '../interfaces';\nimport { ReactFrameworkOverrides } from './reactFrameworkOverrides';\nimport GridComp from './gridComp';\n\nexport class AgGridReactFire extends Component<AgReactUiProps, { context: Context | undefined }> {\n\n    public api!: GridApi;\n    public columnApi!: ColumnApi;\n\n    private gridOptions!: GridOptions;\n\n    private destroyFuncs: (() => void)[] = [];\n    private changeDetectionService = new ChangeDetectionService();\n    private eGui = React.createRef<HTMLDivElement>();\n\n    constructor(public props: any) {\n        super(props);\n        this.state = {context: undefined};\n    }\n\n    public render() {\n        return (\n            <div style={ this.createStyleForDiv() } className={ this.props.className } ref={ this.eGui }>\n                { this.state.context && <GridComp context={ this.state.context }/> }\n            </div>\n        );\n    }\n\n    private createStyleForDiv() {\n        return {\n            height: '100%',\n            ...(this.props.containerStyle || {})\n        };\n    }\n\n    public componentDidMount() {\n\n        const modules = this.props.modules || [];\n        const gridParams: GridParams = {\n            // providedBeanInstances: {\n            //     agGridReact: this,\n            //     frameworkComponentWrapper: new ReactFrameworkComponentWrapper(this)\n            // },\n            modules,\n            frameworkOverrides: new ReactFrameworkOverrides()\n        };\n\n        this.gridOptions = {...this.props.gridOptions};\n        const {children} = this.props;\n\n        if (AgGridColumn.hasChildColumns(children)) {\n            this.gridOptions.columnDefs = AgGridColumn.mapChildColumnDefs(children);\n        }\n\n        this.gridOptions = ComponentUtil.copyAttributesToGridOptions(this.gridOptions, this.props);\n\n        // don't need the return value\n        const gridCoreCreator = new GridCoreCreator();\n        gridCoreCreator.create(this.eGui.current!, this.gridOptions, context => {\n            this.setState({context: context});\n        }, gridParams);\n\n        this.destroyFuncs.push(() => this.gridOptions.api!.destroy());\n\n        this.api = this.gridOptions.api!;\n        this.columnApi = this.gridOptions.columnApi!;\n\n        this.props.setGridApi(this.api, this.columnApi);\n    }\n\n    public componentWillUnmount() {\n        this.destroyFuncs.forEach(f => f());\n    }\n\n    public componentDidUpdate(prevProps: any) {\n        this.processPropsChanges(prevProps, this.props);\n    }\n\n    public processPropsChanges(prevProps: any, nextProps: any) {\n        const changes = {};\n\n        this.extractGridPropertyChanges(prevProps, nextProps, changes);\n        this.extractDeclarativeColDefChanges(nextProps, changes);\n\n        this.processChanges(changes);\n    }\n\n    private extractDeclarativeColDefChanges(nextProps: any, changes: any) {\n        // if columnDefs are provided on gridOptions we use those - you can't combine both\n        // we also skip if columnDefs are provided as a prop directly on AgGridReact\n        if ((this.props.gridOptions && this.props.gridOptions.columnDefs) || this.props.columnDefs) {\n            return;\n        }\n\n        const debugLogging = !!nextProps.debug;\n        const propKey = 'columnDefs';\n        const currentColDefs = this.gridOptions.columnDefs;\n\n        if (AgGridColumn.hasChildColumns(nextProps.children)) {\n            const detectionStrategy = this.changeDetectionService.getStrategy(this.getStrategyTypeForProp(propKey));\n            const newColDefs = AgGridColumn.mapChildColumnDefs(nextProps.children);\n\n            if (!detectionStrategy.areEqual(currentColDefs, newColDefs)) {\n                if (debugLogging) {\n                    console.log(`agGridReact: colDefs definitions changed`);\n                }\n\n                changes[propKey] =\n                    {\n                        previousValue: currentColDefs,\n                        currentValue: newColDefs\n                    };\n            }\n        } else if (currentColDefs && currentColDefs.length > 0) {\n            changes[propKey] =\n                {\n                    previousValue: currentColDefs,\n                    currentValue: []\n                };\n        }\n    }\n\n    private extractGridPropertyChanges(prevProps: any, nextProps: any, changes: any) {\n        const debugLogging = !!nextProps.debug;\n\n        Object.keys(nextProps).forEach(propKey => {\n            if (_.includes(ComponentUtil.ALL_PROPERTIES, propKey)) {\n                const changeDetectionStrategy = this.changeDetectionService.getStrategy(this.getStrategyTypeForProp(propKey));\n\n                if (!changeDetectionStrategy.areEqual(prevProps[propKey], nextProps[propKey])) {\n                    if (debugLogging) {\n                        console.log(`agGridReact: [${propKey}] property changed`);\n                    }\n\n                    changes[propKey] = {\n                        previousValue: prevProps[propKey],\n                        currentValue: nextProps[propKey]\n                    };\n                }\n            }\n        });\n\n        ComponentUtil.getEventCallbacks().forEach(funcName => {\n            if (this.props[funcName] !== nextProps[funcName]) {\n                if (debugLogging) {\n                    console.log(`agGridReact: [${funcName}] event callback changed`);\n                }\n\n                changes[funcName] = {\n                    previousValue: prevProps[funcName],\n                    currentValue: nextProps[funcName]\n                };\n            }\n        });\n    }\n\n    private processChanges(changes: {}) {\n        if (this.api) {\n            ComponentUtil.processOnChange(changes, this.gridOptions, this.api, this.columnApi)\n        }\n    }\n\n    private getStrategyTypeForProp(propKey: string) {\n        if (propKey === 'rowData') {\n            if (this.props.rowDataChangeDetectionStrategy) {\n                return this.props.rowDataChangeDetectionStrategy;\n            }\n            if (this.isImmutableDataActive()) {\n                return ChangeDetectionStrategyType.IdentityCheck;\n            }\n        }\n\n        // all other cases will default to DeepValueCheck\n        return ChangeDetectionStrategyType.DeepValueCheck;\n    }\n\n    private isImmutableDataActive() {\n        return (this.props.deltaRowDataMode || this.props.immutableData) ||\n            (this.props.gridOptions && (this.props.gridOptions.deltaRowDataMode || this.props.gridOptions.immutableData));\n    }\n}\n"]}