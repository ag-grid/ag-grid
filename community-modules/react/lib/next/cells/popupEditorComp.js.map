{"version":3,"sources":["next/cells/popupEditorComp.tsx"],"names":[],"mappings":";;;;;;;;;;AAAA,gDAAuE;AACvE,6CAAqE;AACrE,uCAAyC;AAEzC,gDAA+C;AAE/C,IAAM,eAAe,GAAG,UAAC,KAMhB;IAEC,IAAA,uBAA4E,EAA3E,0BAAkB,EAAE,6BAAuD,CAAC;IAE7E,IAAA,oDAAsE,EAArE,oBAAO,EAAE,8BAAY,EAAE,0CAA8C,CAAC;IAE7E,iBAAS,CAAE;QACA,IAAA,+BAAW,EAAE,yBAAQ,EAAE,+BAAW,CAAU;QAC5C,IAAA,qCAAW,CAAgB;QAElC,IAAM,aAAa,GAAG,kBAAkB,CAAC,+BAA+B,EAAE,CAAC;QAE3E,IAAM,OAAO,GAAG,IAAI,yBAAkB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAC3D,IAAM,SAAS,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;QAEnC,IAAI,KAAK,CAAC,WAAW,EAAE;YACnB,IAAM,SAAS,GAAG,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAC7C,IAAI,SAAS,EAAE;gBACX,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;aACpC;SACJ;QAED,IAAM,cAAc,GAAG;YACnB,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE;YAC5B,OAAO,EAAE,QAAQ,CAAC,UAAU,EAAE;YAC9B,IAAI,EAAE,iBAAiB;YACvB,WAAW,EAAE,WAAW;YACxB,MAAM,EAAE,SAAS;YACjB,gBAAgB,EAAE,IAAI;SACzB,CAAC;QAEF,IAAM,gBAAgB,GAAG,WAAY,CAAC,aAAa,KAAK,OAAO,CAAC,CAAC;YAC7D,YAAY,CAAC,2BAA2B,CAAC,IAAI,CAAC,YAAY,EAAE,cAAc,CAAC;YAC3E,CAAC,CAAC,YAAY,CAAC,0BAA0B,CAAC,IAAI,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;QAEjF,IAAM,WAAW,GAAG,YAAY,CAAC,QAAQ,CAAC;YACtC,KAAK,EAAE,aAAa;YACpB,MAAM,EAAE,SAAS;YACjB,UAAU,EAAE,IAAI;YAChB,cAAc,EAAE,cAAQ,QAAQ,CAAC,mBAAmB,EAAE,CAAC,CAAC,CAAC;YACzD,eAAe,EAAE,WAAW;YAC5B,gBAAgB,kBAAA;SACnB,CAAC,CAAC;QAEH,IAAM,eAAe,GAA2B,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC;QAE/F,qBAAqB,CAAC,OAAO,CAAC,CAAC;QAE/B,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW,CAAC,gBAAgB,IAAI,KAAK,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;QAEhG,OAAO;YACH,IAAI,eAAe,IAAE,IAAI,EAAE;gBACvB,eAAe,EAAE,CAAC;aACrB;YACD,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC,CAAC;IAEN,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,OAAO,CACH,8DACM,kBAAkB,IAAI,KAAK,CAAC,cAAc;WACpB,wBAAY,CAAC,KAAK,CAAC,cAAc,EAAE,kBAAkB,CAAC,MAAM,EAAE,CAAC,CACxF,CACN,CAAC;AACN,CAAC,CAAC;AAEF,kBAAe,YAAI,CAAC,eAAe,CAAC,CAAC","file":"popupEditorComp.js","sourcesContent":["import { CellCtrl, PopupEditorWrapper } from '@ag-grid-community/core';\nimport React, { useEffect, useState, memo, useContext } from 'react';\nimport { createPortal } from 'react-dom';\nimport { EditDetails } from './cellComp';\nimport { BeansContext } from '../beansContext';\n\nconst PopupEditorComp = (props: {\n            editDetails: EditDetails, \n            cellCtrl: CellCtrl, \n            eParentCell: HTMLElement,\n            wrappedContent?: any,\n            jsChildComp?: any\n        }) => {\n\n    const [popupEditorWrapper, setPopupEditorWrapper] = useState<PopupEditorWrapper>();\n\n    const {context, popupService, gridOptionsWrapper} = useContext(BeansContext);\n\n    useEffect( () => {\n        const {editDetails, cellCtrl, eParentCell} = props;\n        const {compDetails} = editDetails;\n\n        const useModelPopup = gridOptionsWrapper.isStopEditingWhenCellsLoseFocus();\n        \n        const wrapper = new PopupEditorWrapper(compDetails.params);\n        const ePopupGui = wrapper.getGui();\n\n        if (props.jsChildComp) {\n            const eChildGui = props.jsChildComp.getGui();\n            if (eChildGui) {\n                ePopupGui.appendChild(eChildGui);\n            }\n        }\n\n        const positionParams = {\n            column: cellCtrl.getColumn(),\n            rowNode: cellCtrl.getRowNode(),\n            type: 'popupCellEditor',\n            eventSource: eParentCell,\n            ePopup: ePopupGui,\n            keepWithinBounds: true\n        };\n    \n        const positionCallback = editDetails!.popupPosition === 'under' ?\n            popupService.positionPopupUnderComponent.bind(popupService, positionParams)\n            : popupService.positionPopupOverComponent.bind(popupService, positionParams);\n    \n        const addPopupRes = popupService.addPopup({\n            modal: useModelPopup,\n            eChild: ePopupGui,\n            closeOnEsc: true,\n            closedCallback: () => { cellCtrl.onPopupEditorClosed(); },\n            anchorToElement: eParentCell,\n            positionCallback\n        });\n    \n        const hideEditorPopup: (()=>void) | undefined = addPopupRes ? addPopupRes.hideFunc : undefined;\n\n        setPopupEditorWrapper(wrapper);\n\n        props.jsChildComp && props.jsChildComp.afterGuiAttached && props.jsChildComp.afterGuiAttached();\n\n        return ()=> {\n            if (hideEditorPopup!=null) {\n                hideEditorPopup();\n            }\n            context.destroyBean(wrapper);\n        };\n\n    }, []);\n\n    return (\n        <>\n            { popupEditorWrapper && props.wrappedContent \n                                 && createPortal(props.wrappedContent, popupEditorWrapper.getGui()) }\n        </>\n    );\n};\n\nexport default memo(PopupEditorComp);\n"]}