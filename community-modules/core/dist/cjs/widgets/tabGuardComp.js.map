{"version":3,"sources":["../../src/ts/widgets/tabGuardComp.ts"],"names":[],"mappings":"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","file":"tabGuardComp.js","sourcesContent":["import { Component } from \"./component\";\nimport { isNodeOrElement, clearElement } from \"../utils/dom\";\nimport { TabGuardCtrl, ITabGuard } from \"./tabGuardCtrl\";\n\nexport class TabGuardComp extends Component {\n\n    private eTopGuard: HTMLElement;\n    private eBottomGuard: HTMLElement;\n    private eFocusableElement: HTMLElement;\n\n    protected tabGuardCtrl: TabGuardCtrl;\n\n    protected initialiseTabGuard(params: {\n        focusInnerElement?: (fromBottom: boolean) => void;\n        shouldStopEventPropagation?: () => boolean;\n        /**\n         * @return `true` to prevent the default onFocusIn behavior\n         */\n        onFocusIn?: (e: FocusEvent) => boolean;\n        /**\n         * @return `true` to prevent the default onFocusOut behavior\n         */\n        onFocusOut?: (e: FocusEvent) => boolean;\n        onTabKeyDown?: (e: KeyboardEvent) => void;\n        handleKeyDown?: (e: KeyboardEvent) => void;\n    }) {\n        this.eTopGuard = this.createTabGuard('top');\n        this.eBottomGuard = this.createTabGuard('bottom');\n        this.eFocusableElement = this.getFocusableElement();\n\n        const tabGuards = [this.eTopGuard, this.eBottomGuard];\n\n        const compProxy: ITabGuard = {\n            setTabIndex: tabIndex => {\n                tabGuards.forEach(tabGuard => tabIndex != null ? tabGuard.setAttribute('tabIndex', tabIndex) : tabGuard.removeAttribute('tabIndex'));\n            }\n        }\n\n        this.addTabGuards(this.eTopGuard, this.eBottomGuard);\n\n        this.tabGuardCtrl = this.createManagedBean(new TabGuardCtrl({\n            comp: compProxy,\n            eTopGuard: this.eTopGuard,\n            eBottomGuard: this.eBottomGuard,\n            eFocusableElement: this.eFocusableElement,\n            \n            onFocusIn: params.onFocusIn,\n            onFocusOut: params.onFocusOut,\n            focusInnerElement: params.focusInnerElement,\n            handleKeyDown: params.handleKeyDown,\n            onTabKeyDown: params.onTabKeyDown,\n            shouldStopEventPropagation: params.shouldStopEventPropagation\n        }));\n    }\n\n    private createTabGuard(side: 'top' | 'bottom'): HTMLElement {\n        const tabGuard = document.createElement('div');\n\n        tabGuard.classList.add('ag-tab-guard');\n        tabGuard.classList.add(`ag-tab-guard-${side}`);\n        tabGuard.setAttribute('role', 'presentation');\n\n        return tabGuard;\n    }\n\n    private addTabGuards(topTabGuard: HTMLElement, bottomTabGuard: HTMLElement): void {\n        this.eFocusableElement.insertAdjacentElement('afterbegin', topTabGuard);\n        this.eFocusableElement.insertAdjacentElement('beforeend', bottomTabGuard);\n    }\n\n    protected removeAllChildrenExceptTabGuards(): void {\n        const tabGuards: [HTMLElement, HTMLElement] = [this.eTopGuard, this.eBottomGuard];\n        clearElement(this.getFocusableElement());\n        this.addTabGuards(...tabGuards);\n    }\n\n    public forceFocusOutOfContainer(up: boolean = false): void {\n        this.tabGuardCtrl.forceFocusOutOfContainer(up);\n    }\n\n    public appendChild(newChild: HTMLElement | Component, container?: HTMLElement): void {\n        if (!isNodeOrElement(newChild)) {\n            newChild = (newChild as Component).getGui();\n        }\n\n        const { eBottomGuard: bottomTabGuard } = this;\n\n        if (bottomTabGuard) {\n            bottomTabGuard.insertAdjacentElement('beforebegin', newChild as HTMLElement);\n        } else {\n            super.appendChild(newChild, container);\n        }\n    }\n}"]}