{"version":3,"sources":["../../src/ts/widgets/agSelect.ts"],"names":[],"mappings":"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","file":"agSelect.js","sourcesContent":["import { AgAbstractField } from \"./agAbstractField\";\nimport { AgPickerField } from \"./agPickerField\";\nimport { ListOption, AgList } from \"./agList\";\nimport { Autowired, PostConstruct } from \"../context/context\";\nimport { PopupService } from \"./popupService\";\nimport { setElementWidth, getAbsoluteWidth, getInnerHeight } from \"../utils/dom\";\nimport { IAgLabel } from './agAbstractLabel';\n\nexport class AgSelect extends AgPickerField<HTMLSelectElement, string> {\n    protected listComponent: AgList;\n    private hideList: ((event?: any) => void) | null;\n\n    @Autowired('popupService') private popupService: PopupService;\n\n    constructor(config?: IAgLabel) {\n        super(config, 'ag-select', 'smallDown', 'listbox');\n    }\n\n    @PostConstruct\n    public init(): void {\n        this.listComponent = this.createBean(new AgList('select'));\n        this.listComponent.setParentComponent(this);\n        this.eWrapper.tabIndex = 0;\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgList.EVENT_ITEM_SELECTED,\n            () => { if (this.hideList) { this.hideList(); } }\n        );\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgAbstractField.EVENT_CHANGED,\n            () => {\n                this.setValue(this.listComponent.getValue(), false, true);\n\n                if (this.hideList) { this.hideList(); }\n            }\n        );\n    }\n\n    public showPicker() {\n        const listGui = this.listComponent.getGui();\n\n        const destroyMouseWheelFunc = this.addManagedListener(document.body, 'wheel', (e: MouseEvent) => {\n            if (!listGui.contains(e.target as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n\n        const destroyFocusOutFunc = this.addManagedListener(listGui, 'focusout', (e: FocusEvent) => {\n            if (!listGui.contains(e.relatedTarget as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n\n        const addPopupRes = this.popupService.addPopup({\n            modal: true,\n            eChild: listGui,\n            closeOnEsc: true,\n            closedCallback: () => {\n                this.hideList = null;\n                this.isPickerDisplayed = false;\n                destroyFocusOutFunc!();\n                destroyMouseWheelFunc!();\n\n                if (this.isAlive()) {\n                    this.getFocusableElement().focus();\n                }\n            }\n        });\n\n        if (addPopupRes) {\n            this.hideList = addPopupRes.hideFunc;\n        }\n        this.isPickerDisplayed = true;\n\n        setElementWidth(listGui, getAbsoluteWidth(this.eWrapper));\n\n        listGui.style.maxHeight = getInnerHeight(this.popupService.getPopupParent()) + 'px';\n        listGui.style.position = 'absolute';\n\n        this.popupService.positionPopupUnderComponent({\n            type: 'ag-list',\n            eventSource: this.eWrapper,\n            ePopup: listGui,\n            keepWithinBounds: true\n        });\n\n        this.listComponent.refreshHighlighted();\n\n        return this.listComponent;\n    }\n\n    public addOptions(options: ListOption[]): this {\n        options.forEach(option => this.addOption(option));\n\n        return this;\n    }\n\n    public addOption(option: ListOption): this {\n        this.listComponent.addOption(option);\n\n        return this;\n    }\n\n    public setValue(value?: string | null, silent?: boolean, fromPicker?: boolean): this {\n        if (this.value === value) { return this; }\n\n        if (!fromPicker) {\n            this.listComponent.setValue(value, true);\n        }\n\n        const newValue = this.listComponent.getValue();\n\n        if (newValue === this.getValue()) { return this; }\n\n        this.eDisplayField.innerHTML = this.listComponent.getDisplayValue()!;\n\n        return super.setValue(value, silent);\n    }\n\n    protected destroy(): void {\n        if (this.hideList) {\n            this.hideList();\n        }\n\n        this.destroyBean(this.listComponent);\n        super.destroy();\n    }\n}\n"]}