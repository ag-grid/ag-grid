{"version":3,"file":"animation_compiler.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/animation/animation_compiler.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n\nimport {isPresent} from '../facade/lang';\nimport {Identifiers, resolveIdentifier} from '../identifiers';\nimport * as o from '../output/output_ast';\nimport {ANY_STATE, DEFAULT_STATE, EMPTY_STATE} from '../private_import_core';\n\nimport {AnimationAst, AnimationAstVisitor, AnimationEntryAst, AnimationGroupAst, AnimationKeyframeAst, AnimationSequenceAst, AnimationStateDeclarationAst, AnimationStateTransitionAst, AnimationStepAst, AnimationStylesAst} from './animation_ast';\n\nexport class AnimationEntryCompileResult {\n  constructor(public name: string, public statements: o.Statement[], public fnExp: o.Expression) {}\n}\n\nexport class AnimationCompiler {\n  compile(factoryNamePrefix: string, parsedAnimations: AnimationEntryAst[]):\n      AnimationEntryCompileResult[] {\n    return parsedAnimations.map(entry => {\n      const factoryName = `${factoryNamePrefix}_${entry.name}`;\n      const visitor = new _AnimationBuilder(entry.name, factoryName);\n      return visitor.build(entry);\n    });\n  }\n}\n\nvar _ANIMATION_FACTORY_ELEMENT_VAR = o.variable('element');\nvar _ANIMATION_DEFAULT_STATE_VAR = o.variable('defaultStateStyles');\nvar _ANIMATION_FACTORY_VIEW_VAR = o.variable('view');\nvar _ANIMATION_FACTORY_VIEW_CONTEXT = _ANIMATION_FACTORY_VIEW_VAR.prop('animationContext');\nvar _ANIMATION_FACTORY_RENDERER_VAR = _ANIMATION_FACTORY_VIEW_VAR.prop('renderer');\nvar _ANIMATION_CURRENT_STATE_VAR = o.variable('currentState');\nvar _ANIMATION_NEXT_STATE_VAR = o.variable('nextState');\nvar _ANIMATION_PLAYER_VAR = o.variable('player');\nvar _ANIMATION_TIME_VAR = o.variable('totalTime');\nvar _ANIMATION_START_STATE_STYLES_VAR = o.variable('startStateStyles');\nvar _ANIMATION_END_STATE_STYLES_VAR = o.variable('endStateStyles');\nvar _ANIMATION_COLLECTED_STYLES = o.variable('collectedStyles');\nvar EMPTY_MAP = o.literalMap([]);\n\nclass _AnimationBuilder implements AnimationAstVisitor {\n  private _fnVarName: string;\n  private _statesMapVarName: string;\n  private _statesMapVar: any;\n\n  constructor(public animationName: string, factoryName: string) {\n    this._fnVarName = factoryName + '_factory';\n    this._statesMapVarName = factoryName + '_states';\n    this._statesMapVar = o.variable(this._statesMapVarName);\n  }\n\n  visitAnimationStyles(ast: AnimationStylesAst, context: _AnimationBuilderContext): o.Expression {\n    var stylesArr: any[] = [];\n    if (context.isExpectingFirstStyleStep) {\n      stylesArr.push(_ANIMATION_START_STATE_STYLES_VAR);\n      context.isExpectingFirstStyleStep = false;\n    }\n\n    ast.styles.forEach(entry => {\n      const entries =\n          Object.keys(entry).map((key): [string, o.Expression] => [key, o.literal(entry[key])]);\n      stylesArr.push(o.literalMap(entries));\n    });\n\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationStyles)).instantiate([\n      o.importExpr(resolveIdentifier(Identifiers.collectAndResolveStyles)).callFn([\n        _ANIMATION_COLLECTED_STYLES, o.literalArr(stylesArr)\n      ])\n    ]);\n  }\n\n  visitAnimationKeyframe(ast: AnimationKeyframeAst, context: _AnimationBuilderContext):\n      o.Expression {\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationKeyframe)).instantiate([\n      o.literal(ast.offset), ast.styles.visit(this, context)\n    ]);\n  }\n\n  visitAnimationStep(ast: AnimationStepAst, context: _AnimationBuilderContext): o.Expression {\n    if (context.endStateAnimateStep === ast) {\n      return this._visitEndStateAnimation(ast, context);\n    }\n\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n    var keyframeExpressions =\n        ast.keyframes.map(keyframeEntry => keyframeEntry.visit(this, context));\n    return this._callAnimateMethod(\n        ast, startingStylesExpr, o.literalArr(keyframeExpressions), context);\n  }\n\n  /** @internal */\n  _visitEndStateAnimation(ast: AnimationStepAst, context: _AnimationBuilderContext): o.Expression {\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n    var keyframeExpressions = ast.keyframes.map(keyframe => keyframe.visit(this, context));\n    var keyframesExpr =\n        o.importExpr(resolveIdentifier(Identifiers.balanceAnimationKeyframes)).callFn([\n          _ANIMATION_COLLECTED_STYLES, _ANIMATION_END_STATE_STYLES_VAR,\n          o.literalArr(keyframeExpressions)\n        ]);\n\n    return this._callAnimateMethod(ast, startingStylesExpr, keyframesExpr, context);\n  }\n\n  /** @internal */\n  _callAnimateMethod(\n      ast: AnimationStepAst, startingStylesExpr: any, keyframesExpr: any,\n      context: _AnimationBuilderContext) {\n    context.totalTransitionTime += ast.duration + ast.delay;\n    return _ANIMATION_FACTORY_RENDERER_VAR.callMethod('animate', [\n      _ANIMATION_FACTORY_ELEMENT_VAR, startingStylesExpr, keyframesExpr, o.literal(ast.duration),\n      o.literal(ast.delay), o.literal(ast.easing)\n    ]);\n  }\n\n  visitAnimationSequence(ast: AnimationSequenceAst, context: _AnimationBuilderContext):\n      o.Expression {\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationSequencePlayer)).instantiate([\n      o.literalArr(playerExprs)\n    ]);\n  }\n\n  visitAnimationGroup(ast: AnimationGroupAst, context: _AnimationBuilderContext): o.Expression {\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationGroupPlayer)).instantiate([\n      o.literalArr(playerExprs)\n    ]);\n  }\n\n  visitAnimationStateDeclaration(\n      ast: AnimationStateDeclarationAst, context: _AnimationBuilderContext): void {\n    var flatStyles: {[key: string]: string | number} = {};\n    _getStylesArray(ast).forEach(\n        entry => { Object.keys(entry).forEach(key => { flatStyles[key] = entry[key]; }); });\n    context.stateMap.registerState(ast.stateName, flatStyles);\n  }\n\n  visitAnimationStateTransition(\n      ast: AnimationStateTransitionAst, context: _AnimationBuilderContext): any {\n    var steps = ast.animation.steps;\n    var lastStep = steps[steps.length - 1];\n    if (_isEndStateAnimateStep(lastStep)) {\n      context.endStateAnimateStep = <AnimationStepAst>lastStep;\n    }\n\n    context.totalTransitionTime = 0;\n    context.isExpectingFirstStyleStep = true;\n\n    var stateChangePreconditions: o.Expression[] = [];\n\n    ast.stateChanges.forEach(stateChange => {\n      stateChangePreconditions.push(\n          _compareToAnimationStateExpr(_ANIMATION_CURRENT_STATE_VAR, stateChange.fromState)\n              .and(_compareToAnimationStateExpr(_ANIMATION_NEXT_STATE_VAR, stateChange.toState)));\n\n      if (stateChange.fromState != ANY_STATE) {\n        context.stateMap.registerState(stateChange.fromState);\n      }\n\n      if (stateChange.toState != ANY_STATE) {\n        context.stateMap.registerState(stateChange.toState);\n      }\n    });\n\n    var animationPlayerExpr = ast.animation.visit(this, context);\n\n    var reducedStateChangesPrecondition = stateChangePreconditions.reduce((a, b) => a.or(b));\n    var precondition =\n        _ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR).and(reducedStateChangesPrecondition);\n\n    var animationStmt = _ANIMATION_PLAYER_VAR.set(animationPlayerExpr).toStmt();\n    var totalTimeStmt = _ANIMATION_TIME_VAR.set(o.literal(context.totalTransitionTime)).toStmt();\n\n    return new o.IfStmt(precondition, [animationStmt, totalTimeStmt]);\n  }\n\n  visitAnimationEntry(ast: AnimationEntryAst, context: _AnimationBuilderContext): any {\n    // visit each of the declarations first to build the context state map\n    ast.stateDeclarations.forEach(def => def.visit(this, context));\n\n    // this should always be defined even if the user overrides it\n    context.stateMap.registerState(DEFAULT_STATE, {});\n\n    var statements: o.Statement[] = [];\n    statements.push(_ANIMATION_FACTORY_VIEW_CONTEXT\n                        .callMethod(\n                            'cancelActiveAnimation',\n                            [\n                              _ANIMATION_FACTORY_ELEMENT_VAR, o.literal(this.animationName),\n                              _ANIMATION_NEXT_STATE_VAR.equals(o.literal(EMPTY_STATE))\n                            ])\n                        .toStmt());\n\n\n    statements.push(_ANIMATION_COLLECTED_STYLES.set(EMPTY_MAP).toDeclStmt());\n    statements.push(_ANIMATION_PLAYER_VAR.set(o.NULL_EXPR).toDeclStmt());\n    statements.push(_ANIMATION_TIME_VAR.set(o.literal(0)).toDeclStmt());\n\n    statements.push(\n        _ANIMATION_DEFAULT_STATE_VAR.set(this._statesMapVar.key(o.literal(DEFAULT_STATE)))\n            .toDeclStmt());\n\n    statements.push(\n        _ANIMATION_START_STATE_STYLES_VAR.set(this._statesMapVar.key(_ANIMATION_CURRENT_STATE_VAR))\n            .toDeclStmt());\n\n    statements.push(new o.IfStmt(\n        _ANIMATION_START_STATE_STYLES_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_START_STATE_STYLES_VAR.set(_ANIMATION_DEFAULT_STATE_VAR).toStmt()]));\n\n    statements.push(\n        _ANIMATION_END_STATE_STYLES_VAR.set(this._statesMapVar.key(_ANIMATION_NEXT_STATE_VAR))\n            .toDeclStmt());\n\n    statements.push(new o.IfStmt(\n        _ANIMATION_END_STATE_STYLES_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_END_STATE_STYLES_VAR.set(_ANIMATION_DEFAULT_STATE_VAR).toStmt()]));\n\n    var RENDER_STYLES_FN = o.importExpr(resolveIdentifier(Identifiers.renderStyles));\n\n    // before we start any animation we want to clear out the starting\n    // styles from the element's style property (since they were placed\n    // there at the end of the last animation\n    statements.push(RENDER_STYLES_FN\n                        .callFn([\n                          _ANIMATION_FACTORY_ELEMENT_VAR, _ANIMATION_FACTORY_RENDERER_VAR,\n                          o.importExpr(resolveIdentifier(Identifiers.clearStyles))\n                              .callFn([_ANIMATION_START_STATE_STYLES_VAR])\n                        ])\n                        .toStmt());\n\n    ast.stateTransitions.forEach(transAst => statements.push(transAst.visit(this, context)));\n\n    // this check ensures that the animation factory always returns a player\n    // so that the onDone callback can be used for tracking\n    statements.push(new o.IfStmt(\n        _ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_PLAYER_VAR\n             .set(o.importExpr(resolveIdentifier(Identifiers.NoOpAnimationPlayer)).instantiate([]))\n             .toStmt()]));\n\n    // once complete we want to apply the styles on the element\n    // since the destination state's values should persist once\n    // the animation sequence has completed.\n    statements.push(\n        _ANIMATION_PLAYER_VAR\n            .callMethod(\n                'onDone',\n                [o.fn(\n                    [],\n                    [RENDER_STYLES_FN\n                         .callFn([\n                           _ANIMATION_FACTORY_ELEMENT_VAR, _ANIMATION_FACTORY_RENDERER_VAR,\n                           o.importExpr(resolveIdentifier(Identifiers.prepareFinalAnimationStyles))\n                               .callFn([\n                                 _ANIMATION_START_STATE_STYLES_VAR, _ANIMATION_END_STATE_STYLES_VAR\n                               ])\n                         ])\n                         .toStmt()])])\n            .toStmt());\n\n    statements.push(_ANIMATION_FACTORY_VIEW_CONTEXT\n                        .callMethod(\n                            'queueAnimation',\n                            [\n                              _ANIMATION_FACTORY_ELEMENT_VAR, o.literal(this.animationName),\n                              _ANIMATION_PLAYER_VAR\n                            ])\n                        .toStmt());\n\n    statements.push(new o.ReturnStatement(\n        o.importExpr(resolveIdentifier(Identifiers.AnimationTransition)).instantiate([\n          _ANIMATION_PLAYER_VAR, _ANIMATION_CURRENT_STATE_VAR, _ANIMATION_NEXT_STATE_VAR,\n          _ANIMATION_TIME_VAR\n        ])));\n\n    return o.fn(\n        [\n          new o.FnParam(\n              _ANIMATION_FACTORY_VIEW_VAR.name,\n              o.importType(resolveIdentifier(Identifiers.AppView), [o.DYNAMIC_TYPE])),\n          new o.FnParam(_ANIMATION_FACTORY_ELEMENT_VAR.name, o.DYNAMIC_TYPE),\n          new o.FnParam(_ANIMATION_CURRENT_STATE_VAR.name, o.DYNAMIC_TYPE),\n          new o.FnParam(_ANIMATION_NEXT_STATE_VAR.name, o.DYNAMIC_TYPE)\n        ],\n        statements, o.importType(resolveIdentifier(Identifiers.AnimationTransition)));\n  }\n\n  build(ast: AnimationAst): AnimationEntryCompileResult {\n    var context = new _AnimationBuilderContext();\n    var fnStatement = ast.visit(this, context).toDeclStmt(this._fnVarName);\n    var fnVariable = o.variable(this._fnVarName);\n\n    var lookupMap: any[] = [];\n    Object.keys(context.stateMap.states).forEach(stateName => {\n      const value = context.stateMap.states[stateName];\n      var variableValue = EMPTY_MAP;\n      if (isPresent(value)) {\n        let styleMap: any[] = [];\n        Object.keys(value).forEach(key => { styleMap.push([key, o.literal(value[key])]); });\n        variableValue = o.literalMap(styleMap);\n      }\n      lookupMap.push([stateName, variableValue]);\n    });\n\n    const compiledStatesMapStmt = this._statesMapVar.set(o.literalMap(lookupMap)).toDeclStmt();\n    const statements: o.Statement[] = [compiledStatesMapStmt, fnStatement];\n\n    return new AnimationEntryCompileResult(this.animationName, statements, fnVariable);\n  }\n}\n\nclass _AnimationBuilderContext {\n  stateMap = new _AnimationBuilderStateMap();\n  endStateAnimateStep: AnimationStepAst = null;\n  isExpectingFirstStyleStep = false;\n  totalTransitionTime = 0;\n}\n\nclass _AnimationBuilderStateMap {\n  private _states: {[key: string]: {[prop: string]: string | number}} = {};\n  get states() { return this._states; }\n  registerState(name: string, value: {[prop: string]: string | number} = null): void {\n    var existingEntry = this._states[name];\n    if (!existingEntry) {\n      this._states[name] = value;\n    }\n  }\n}\n\nfunction _compareToAnimationStateExpr(value: o.Expression, animationState: string): o.Expression {\n  var emptyStateLiteral = o.literal(EMPTY_STATE);\n  switch (animationState) {\n    case EMPTY_STATE:\n      return value.equals(emptyStateLiteral);\n\n    case ANY_STATE:\n      return o.literal(true);\n\n    default:\n      return value.equals(o.literal(animationState));\n  }\n}\n\nfunction _isEndStateAnimateStep(step: AnimationAst): boolean {\n  // the final animation step is characterized by having only TWO\n  // keyframe values and it must have zero styles for both keyframes\n  if (step instanceof AnimationStepAst && step.duration > 0 && step.keyframes.length == 2) {\n    var styles1 = _getStylesArray(step.keyframes[0])[0];\n    var styles2 = _getStylesArray(step.keyframes[1])[0];\n    return Object.keys(styles1).length === 0 && Object.keys(styles2).length === 0;\n  }\n  return false;\n}\n\nfunction _getStylesArray(obj: any): {[key: string]: any}[] {\n  return obj.styles.styles;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}