/**
          * @ag-grid-enterprise/server-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v29.2.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/server-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v29.2.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("@ag-grid-community/core"),o=require("@ag-grid-enterprise/core"),r=(e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)},function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}),n=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},i=function(e){function o(o,r,n){var i=e.call(this,0)||this;return i.nodeIdSequence=new t.NumberSequence,i.info={},i.ssrmParams=o,i.parentRowNode=n,i.level=n.level+1,i.groupLevel=o.rowGroupCols?i.level<o.rowGroupCols.length:void 0,i.leafGroup=!!o.rowGroupCols&&i.level===o.rowGroupCols.length-1,i}return r(o,e),o.prototype.postConstruct=function(){var e=this;if(this.usingTreeData=this.gridOptionsService.isTreeData(),this.nodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.parentRowNode),!this.usingTreeData&&this.groupLevel){var t=this.ssrmParams.rowGroupCols[this.level];this.groupField=t.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}var o=1,r=-1===this.parentRowNode.level,n=this.storeUtils.getServerSideInitialRowCount();r&&void 0!==n&&(o=n),this.initialiseRowNodes(o),this.rowNodeBlockLoader.addBlock(this),this.addDestroyFunc((function(){return e.rowNodeBlockLoader.removeBlock(e)}))},o.prototype.destroyRowNodes=function(){this.blockUtils.destroyRowNodes(this.allRowNodes),this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={}},o.prototype.initialiseRowNodes=function(e,t){void 0===t&&(t=!1),this.destroyRowNodes();for(var o=0;o<e;o++){var r=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});t&&(r.failedLoad=!0),this.allRowNodes.push(r),this.nodesAfterFilter.push(r),this.nodesAfterSort.push(r)}},o.prototype.getBlockStateJson=function(){return{id:this.nodeIdPrefix?this.nodeIdPrefix:"",state:this.getState()}},o.prototype.loadFromDatasource=function(){this.storeUtils.loadFromDatasource({startRow:void 0,endRow:void 0,parentBlock:this,parentNode:this.parentRowNode,storeParams:this.ssrmParams,successCallback:this.pageLoaded.bind(this,this.getVersion()),success:this.success.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),fail:this.pageLoadFailed.bind(this,this.getVersion())})},o.prototype.getStartRow=function(){return 0},o.prototype.getEndRow=function(){return this.nodesAfterSort.length},o.prototype.createDataNode=function(e,o){var r=this.blockUtils.createRowNode({field:this.groupField,group:this.groupLevel,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn});null!=o?t._.insertIntoArray(this.allRowNodes,r,o):this.allRowNodes.push(r);var n=this.prefixId(this.nodeIdSequence.next());return this.blockUtils.setDataIntoRowNode(r,e,n,void 0),this.nodeManager.addRowNode(r),this.blockUtils.checkOpenByDefault(r),this.allNodesMap[r.id]=r,r},o.prototype.prefixId=function(e){return this.nodeIdPrefix?this.nodeIdPrefix+"-"+e:e.toString()},o.prototype.processServerFail=function(){this.initialiseRowNodes(1,!0),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()},o.prototype.processServerResult=function(e){if(this.isAlive()){var o=e.storeInfo||e.groupLevelInfo;o&&Object.assign(this.info,o);var r=this.allRowNodes.length>0?this.allNodesMap:void 0;if(this.allRowNodes=[],this.nodesAfterSort=[],this.nodesAfterFilter=[],this.allNodesMap={},!e.rowData){t._.doOnce((function(){return console.warn('AG Grid: "params.data" is missing from Server-Side Row Model success() callback. Please use the "data" attribute. If no data is returned, set an empty list.',e)}),"FullStore.noData")}this.createOrRecycleNodes(r,e.rowData),r&&this.blockUtils.destroyRowNodes(t._.getAllValuesInObject(r)),this.filterAndSortNodes(),this.fireStoreUpdatedEvent(),this.flushAsyncTransactions()}},o.prototype.createOrRecycleNodes=function(e,t){var o=this;if(t){t.forEach((function(t){var r=function(t){if(e){var r=o.gridOptionsService.getRowIdFunc();if(r){var n=o.parentRowNode.getGroupKeys(),i=o.level,s=r({data:t,parentKeys:n.length>0?n:void 0,level:i}),a=e[s];if(a)return delete e[s],a}}}(t);r?function(e,t){o.allNodesMap[e.id]=e,o.blockUtils.updateDataIntoRowNode(e,t),o.allRowNodes.push(e)}(r,t):o.createDataNode(t)}))}},o.prototype.flushAsyncTransactions=function(){var e=this;window.setTimeout((function(){return e.transactionManager.flushAsyncTransactions()}),0)},o.prototype.filterAndSortNodes=function(){this.filterRowNodes(),this.sortRowNodes()},o.prototype.sortRowNodes=function(){var e=this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerSideSortOnServer(),t=this.sortController.getSortOptions(),o=!t||0==t.length;this.nodesAfterSort=e||o?this.nodesAfterFilter:this.rowNodeSorter.doFullSort(this.nodesAfterFilter,t)},o.prototype.filterRowNodes=function(){var e=this,t=this.storeUtils.isServerSideFilterAllLevels()||this.storeUtils.isServerSideFilterOnServer(),o=this.groupLevel;this.nodesAfterFilter=t||o?this.allRowNodes:this.allRowNodes.filter((function(t){return e.filterManager.doesRowPassFilter({rowNode:t})}))},o.prototype.clearDisplayIndexes=function(){var e=this;this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.allRowNodes.forEach((function(t){return e.blockUtils.clearDisplayIndex(t)}))},o.prototype.getDisplayIndexEnd=function(){return this.displayIndexEnd},o.prototype.isDisplayIndexInStore=function(e){return 0!==this.getRowCount()&&(e>=this.displayIndexStart&&e<this.displayIndexEnd)},o.prototype.setDisplayIndexes=function(e,t){var o=this;this.displayIndexStart=e.peek(),this.topPx=t.value;var r={};this.nodesAfterSort.forEach((function(n){o.blockUtils.setDisplayIndex(n,e,t),r[n.id]=!0})),this.allRowNodes.forEach((function(e){r[e.id]||o.blockUtils.clearDisplayIndex(e)})),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx},o.prototype.forEachStoreDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),e(this,o.next()),this.allRowNodes.forEach((function(t){var r=t.childStore;r&&r.forEachStoreDeep(e,o)}))},o.prototype.forEachNodeDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),this.allRowNodes.forEach((function(t){e(t,o.next());var r=t.childStore;r&&r.forEachNodeDeep(e,o)}))},o.prototype.forEachNodeDeepAfterFilterAndSort=function(e,o){void 0===o&&(o=new t.NumberSequence),this.nodesAfterSort.forEach((function(t){e(t,o.next());var r=t.childStore;r&&r.forEachNodeDeepAfterFilterAndSort(e,o)}))},o.prototype.getRowUsingDisplayIndex=function(e){if(this.isDisplayIndexInStore(e))return this.blockUtils.binarySearchForDisplayIndex(e,this.nodesAfterSort)},o.prototype.getRowBounds=function(e){for(var t=0;t<this.nodesAfterSort.length;t++){var o=this.nodesAfterSort[t],r=this.blockUtils.extractRowBounds(o,e);if(r)return r}return null},o.prototype.isPixelInRange=function(e){return e>=this.topPx&&e<this.topPx+this.heightPx},o.prototype.getRowIndexAtPixel=function(e){var t=this;if(e<=this.topPx)return this.nodesAfterSort[0].rowIndex;if(e>=this.topPx+this.heightPx){var o=this.nodesAfterSort[this.nodesAfterSort.length-1],r=o.rowTop+o.rowHeight;if(e>=r&&o.expanded){if(o.childStore&&o.childStore.getRowCount()>0)return o.childStore.getRowIndexAtPixel(e);if(o.detailNode)return o.detailNode.rowIndex}return o.rowIndex}var n=null;return this.nodesAfterSort.forEach((function(o){var r=t.blockUtils.getIndexAtPixel(o,e);null!=r&&(n=r)})),null==n?this.displayIndexEnd-1:n},o.prototype.getChildStore=function(e){var t=this;return this.storeUtils.getChildStore(e,this,(function(e){return t.allRowNodes.find((function(t){return t.key==e}))}))},o.prototype.forEachChildStoreShallow=function(e){this.allRowNodes.forEach((function(t){var o=t.childStore;o&&e(o)}))},o.prototype.refreshAfterFilter=function(e){var t=this.storeUtils.isServerSideFilterOnServer(),o=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(this.storeUtils.isServerSideFilterAllLevels()||t&&o)return this.refreshStore(!0),void this.sortRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((function(t){return t.refreshAfterFilter(e)}))},o.prototype.refreshAfterSort=function(e){var t=this.storeUtils.isServerSideSortOnServer(),o=this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e);if(this.storeUtils.isServerSideSortAllLevels()||t&&o)return this.refreshStore(!0),void this.filterRowNodes();this.filterRowNodes(),this.sortRowNodes(),this.forEachChildStoreShallow((function(t){return t.refreshAfterSort(e)}))},o.prototype.applyTransaction=function(e){switch(this.getState()){case t.RowNodeBlock.STATE_FAILED:return{status:t.ServerSideTransactionResultStatus.StoreLoadingFailed};case t.RowNodeBlock.STATE_LOADING:return{status:t.ServerSideTransactionResultStatus.StoreLoading};case t.RowNodeBlock.STATE_WAITING_TO_LOAD:return{status:t.ServerSideTransactionResultStatus.StoreWaitingToLoad}}var o=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(o&&!o({transaction:e,parentNode:this.parentRowNode,storeInfo:this.info,groupLevelInfo:this.info}))return{status:t.ServerSideTransactionResultStatus.Cancelled};var r={status:t.ServerSideTransactionResultStatus.Applied,remove:[],update:[],add:[]},n=[];return this.executeAdd(e,r),this.executeRemove(e,r,n),this.executeUpdate(e,r,n),this.filterAndSortNodes(),this.updateSelection(n),r},o.prototype.updateSelection=function(e){if(e.length>0){e.forEach((function(e){e.setSelected(!1,!1,!0,"rowDataChanged")}));var o={type:t.Events.EVENT_SELECTION_CHANGED,source:"rowDataChanged"};this.eventService.dispatchEvent(o)}},o.prototype.executeAdd=function(e,o){var r=this,n=e.add,i=e.addIndex;t._.missingOrEmpty(n)||("number"==typeof i&&i>=0?n.reverse().forEach((function(e){var t=r.createDataNode(e,i);o.add.push(t)})):n.forEach((function(e){var t=r.createDataNode(e);o.add.push(t)})))},o.prototype.executeRemove=function(e,t,o){var r=this,n=e.remove;if(null!=n){var i={};n.forEach((function(e){var n=r.lookupRowNode(e);n&&(n.isSelected()&&o.push(n),n.clearRowTopAndRowIndex(),i[n.id]=!0,delete r.allNodesMap[n.id],t.remove.push(n),r.nodeManager.removeNode(n))})),this.allRowNodes=this.allRowNodes.filter((function(e){return!i[e.id]}))}},o.prototype.executeUpdate=function(e,t,o){var r=this,n=e.update;null!=n&&n.forEach((function(e){var n=r.lookupRowNode(e);n&&(r.blockUtils.updateDataIntoRowNode(n,e),!n.selectable&&n.isSelected()&&o.push(n),t.update.push(n))}))},o.prototype.lookupRowNode=function(e){var t,o=this.gridOptionsService.getRowIdFunc();if(null!=o){var r=this.level,n=this.parentRowNode.getGroupKeys(),i=o({data:e,parentKeys:n.length>0?n:void 0,level:r});if(!(t=this.allNodesMap[i]))return console.error("AG Grid: could not find row id="+i+", data item was not found for this id"),null}else if(!(t=this.allRowNodes.find((function(t){return t.data===e}))))return console.error("AG Grid: could not find data item as object was not found",e),null;return t},o.prototype.addStoreStates=function(e){e.push({suppressInfiniteScroll:!0,route:this.parentRowNode.getGroupKeys(),rowCount:this.allRowNodes.length,info:this.info}),this.forEachChildStoreShallow((function(t){return t.addStoreStates(e)}))},o.prototype.refreshStore=function(e){if(e){var t=this.nodesAfterSort?this.nodesAfterSort.length:1;this.initialiseRowNodes(t)}this.scheduleLoad(),this.fireStoreUpdatedEvent()},o.prototype.retryLoads=function(){this.getState()===t.RowNodeBlock.STATE_FAILED&&(this.initialiseRowNodes(1),this.scheduleLoad()),this.forEachChildStoreShallow((function(e){return e.retryLoads()}))},o.prototype.scheduleLoad=function(){this.setStateWaitingToLoad(),this.rowNodeBlockLoader.checkBlockToLoad()},o.prototype.fireStoreUpdatedEvent=function(){var e={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)},o.prototype.getRowCount=function(){return this.nodesAfterSort.length},o.prototype.getTopLevelRowDisplayedIndex=function(e){return this.nodesAfterSort[e].rowIndex},o.prototype.isLastRowIndexKnown=function(){return this.getState()==t.RowNodeBlock.STATE_LOADED},o.prototype.getRowNodesInRange=function(e,o){var r=[],n=!1;return t._.missing(e)&&(n=!0),this.nodesAfterSort.forEach((function(t){var i=t===e||t===o;(n||i)&&r.push(t),i&&(n=!n)})),n?[]:r},n([t.Autowired("ssrmStoreUtils")],o.prototype,"storeUtils",void 0),n([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),n([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),n([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),n([t.Autowired("rowNodeSorter")],o.prototype,"rowNodeSorter",void 0),n([t.Autowired("sortController")],o.prototype,"sortController",void 0),n([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),n([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),n([t.Autowired("ssrmTransactionManager")],o.prototype,"transactionManager",void 0),n([t.PostConstruct],o.prototype,"postConstruct",null),n([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.RowNodeBlock),s=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),a=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},d=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},l=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},c=function(e){function o(t,o,r){var n=e.call(this)||this;return n.loadingNodes=new Set,n.loaderTimeout=void 0,n.nextBlockToLoad=void 0,n.parentNode=o,n.cache=t,n.storeParams=r,n}return s(o,e),o.prototype.init=function(){var e=this;this.addManagedListener(this.rowNodeBlockLoader,t.RowNodeBlockLoader.BLOCK_LOADED_EVENT,(function(){return e.queueLoadAction()}))},o.prototype.isRowLoading=function(e){return this.loadingNodes.has(e)},o.prototype.doesRowNeedLoaded=function(e){if(this.loadingNodes.has(e))return!1;var t=this.cache.getRowByStoreIndex(e);if(!t)return!1;if(t.__needsRefresh)return!0;var o=this.api.getFirstDisplayedRow(),r=this.api.getLastDisplayedRow();return!!(null!=t.rowIndex&&t.rowIndex>=o&&t.rowIndex<=r)&&(t.stub&&!t.failedLoad||t.__needsRefreshWhenVisible)},o.prototype.getBlocksToLoad=function(){var e=this,t=new Set;return this.cache.getNodeMapEntries().forEach((function(o){var r=d(o,2),n=r[0];r[1];var i=Number(n),s=e.getBlockStartIndexForIndex(i);e.doesRowNeedLoaded(i)&&t.add(s)})),l(t)},o.prototype.getNodeRanges=function(){var e=this,r={};return this.getBlocksToLoad().forEach((function(n){var i=t._.oneOrGreater(e.gridOptionsService.getNum("cacheBlockSize"))||o.DEFAULT_BLOCK_SIZE,s=n-n%i;r[s]=s+i})),r},o.prototype.reset=function(){this.loadingNodes.clear(),clearTimeout(this.loaderTimeout),this.loaderTimeout=void 0},o.prototype.executeLoad=function(e,t){var o,r=this,n=this.cache.getSsrmParams(),i={startRow:e,endRow:t,rowGroupCols:n.rowGroupCols,valueCols:n.valueCols,pivotCols:n.pivotCols,pivotMode:n.pivotMode,groupKeys:this.parentNode.getGroupKeys(),filterModel:n.filterModel,sortModel:n.sortModel},s=function(){for(var o=0;o<t-e;o++)r.loadingNodes.delete(e+o)},a=function(o){r.rowNodeBlockLoader.loadComplete(),r.cache.onLoadSuccess(e,t-e,o),s(),r.queueLoadAction()},d=function(){r.rowNodeBlockLoader.loadComplete(),r.cache.onLoadFailed(e,t-e),s(),r.queueLoadAction()},l={request:i,successCallback:function(e,t){return a({rowData:e,rowCount:t})},success:a,failCallback:d,fail:d,parentNode:this.parentNode,api:this.api,columnApi:this.columnApi,context:this.gridOptionsService.context};!function(){for(var o=0;o<t-e;o++)r.loadingNodes.add(e+o)}(),null===(o=this.cache.getSsrmParams().datasource)||void 0===o||o.getRows(l)},o.prototype.isBlockInViewport=function(e,t){var o=this.api.getFirstDisplayedRow(),r=this.api.getLastDisplayedRow();return e<=o&&t>=r||t>o&&t<r||e>o&&e<r},o.prototype.getNextBlockToLoad=function(){var e=this,t=this.getNodeRanges(),o=Object.entries(t);if(0===o.length)return null;var r=this.api.getFirstDisplayedRow();return o.sort((function(t,o){var n=d(t,2),i=n[0],s=n[1],a=d(o,2),l=a[0],c=a[1],u=e.isBlockInViewport(Number(i),s),p=e.isBlockInViewport(Number(l),c);return u?-1:p?1:Math.abs(r-Number(i))-Math.abs(r-Number(l))})),o[0]},o.prototype.queueLoadAction=function(){var e,t=this,o=this.getNextBlockToLoad();if(!o)return window.clearTimeout(this.loaderTimeout),this.loaderTimeout=void 0,void(this.nextBlockToLoad=void 0);if(!this.nextBlockToLoad||this.nextBlockToLoad[0]!==o[0]&&this.nextBlockToLoad[1]!==o[1]){this.nextBlockToLoad=o,window.clearTimeout(this.loaderTimeout);var r=d(this.nextBlockToLoad,2),n=r[0],i=r[1],s=Number(n);this.loaderTimeout=window.setTimeout((function(){t.cache.isAlive()&&(t.loaderTimeout=void 0,t.attemptLoad(s,i),t.nextBlockToLoad=void 0)}),null!==(e=this.gridOptionsService.getNum("blockLoadDebounceMillis"))&&void 0!==e?e:0)}},o.prototype.attemptLoad=function(e,t){var o=this.rowNodeBlockLoader.getAvailableLoadingCount();null!=o&&0===o||(this.rowNodeBlockLoader.registerLoads(1),this.executeLoad(e,t),this.queueLoadAction())},o.prototype.getBlockSize=function(){return this.storeParams.cacheBlockSize||o.DEFAULT_BLOCK_SIZE},o.prototype.getBlockStartIndexForIndex=function(e){return e-e%this.getBlockSize()},o.prototype.getBlockBoundsForIndex=function(e){var t=this.getBlockStartIndexForIndex(e);return[t,t+this.getBlockSize()]},o.DEFAULT_BLOCK_SIZE=100,a([t.Autowired("gridApi")],o.prototype,"api",void 0),a([t.Autowired("columnApi")],o.prototype,"columnApi",void 0),a([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),a([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),u=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),p=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},h=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},f=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e},v=function(e){function o(t,o,r){var n=e.call(this)||this;return n.live=!0,n.store=t,n.numberOfRows=o,n.isLastRowKnown=!1,n.storeParams=r,n}return u(o,e),o.prototype.init=function(){this.nodeIndexMap={},this.nodeIds=new Set,this.defaultNodeIdPrefix=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),this.rowLoader=this.createManagedBean(new c(this,this.store.getParentNode(),this.storeParams))},o.prototype.destroyRowNodes=function(){this.numberOfRows=0,this.blockUtils.destroyRowNodes(this.getAllNodes()),this.nodeIndexMap={},this.nodeIds.clear(),this.live=!1},o.prototype.getRowByDisplayIndex=function(e){var t;if(this.store.isDisplayIndexInStore(e)){for(var o,r=this.getNodeMapEntries(),n=0;n<r.length;n++){var i=h(r[n],2),s=i[0],a=i[1];if(a.rowIndex===e)return(a.stub||a.__needsRefreshWhenVisible)&&this.rowLoader.queueLoadAction(),a;var d=a.master&&a.expanded,l=a.detailNode;if(d&&l&&l.rowIndex===e)return l;if(null===(t=a.childStore)||void 0===t?void 0:t.isDisplayIndexInStore(e))return a.childStore.getRowUsingDisplayIndex(e);if(a.rowIndex>e){o=s;break}}if(null==o){var c=this.store.getRowCount()-(this.store.getDisplayIndexEnd()-e);return this.createStubNode(c,e)}var u=Number(o),p=u-(this.nodeIndexMap[u].rowIndex-e);return this.createStubNode(p,e)}},o.prototype.createStubNode=function(e,t){var o=this.store.getRowBounds(t),r=this.createRowAtIndex(e,null,(function(e){e.setRowIndex(t),e.setRowTop(o.rowTop)}));return this.rowLoader.queueLoadAction(),r},o.prototype.getRowByStoreIndex=function(e){return this.nodeIndexMap[e]},o.prototype.skipDisplayIndexes=function(e,t,o){var r=this.gridOptionsService.getRowHeightAsNumber();t.skip(e),o.value+=e*r},o.prototype.setDisplayIndexes=function(e,t){var o=this,r=this.getNodeMapEntries(),n=-1;r.forEach((function(r){var i=h(r,2),s=i[0],a=i[1],d=Number(s),l=d-1-n;o.skipDisplayIndexes(l,e,t),o.blockUtils.setDisplayIndex(a,e,t),n=d}));var i=this.numberOfRows-1-n;this.skipDisplayIndexes(i,e,t),this.purgeExcessRows()},o.prototype.getRowCount=function(){return this.numberOfRows},o.prototype.setRowCount=function(e,t){if(e<0)throw new Error("AG Grid: setRowCount can only accept a positive row count.");this.numberOfRows=e,null!=t&&(this.isLastRowKnown=t),this.fireStoreUpdatedEvent()},o.prototype.getNodeMapEntries=function(){return Object.entries(this.nodeIndexMap)},o.prototype.getAllNodes=function(){return Object.values(this.nodeIndexMap)},o.prototype.getDisplayIndexFromStoreIndex=function(e){var t,o=this.nodeIndexMap[e],r=this.store.getDisplayIndexStart();if(null==r)return null;if(o&&null!=o.rowIndex)return o.rowIndex;for(var n=this.getNodeMapEntries(),i=void 0,s=-1,a=0;a<n.length;a++){var d=h(n[a],2),l=d[0],c=d[1],u=Number(l);if(u>e)break;i=c,s=u}if(null==i)return r+e;var p=e-s,f=null===(t=i.childStore)||void 0===t?void 0:t.getDisplayIndexEnd();return null!=f?f+p-1:null!=i.rowIndex?i.rowIndex+p:r+e},o.prototype.createRowAtIndex=function(e,t,o){var r=this,n=this.isUsingRowIds(),i=this.nodeIndexMap[e];if(i){if(i.__needsRefresh=!1,i.__needsRefreshWhenVisible=!1,this.doesNodeMatch(t,i))return this.blockUtils.updateDataIntoRowNode(i,t),i;if(!n&&i.group&&i.expanded)return i;this.destroyRowAtIndex(e)}if(t&&n){var s=this.getNodeMapEntries().find((function(e){var o=h(e,2);o[0];var n=o[1];return r.doesNodeMatch(t,n)}));if(s){var a=h(s,2),d=a[0],l=a[1],c=Number(d);return this.blockUtils.updateDataIntoRowNode(l,t),delete this.nodeIndexMap[c],this.nodeIndexMap[e]=l,this.markBlockForVerify(c),l}}var u=this.blockUtils.createRowNode(this.store.getRowDetails());if(null!=t){var p=this.getPrefixedId(this.store.getIdSequence().next());this.blockUtils.setDataIntoRowNode(u,t,p,void 0),this.blockUtils.checkOpenByDefault(u),this.nodeManager.addRowNode(u),this.nodeIds.add(u.id)}return this.nodeIndexMap[e]=u,o&&o(u),u.stub&&this.rowLoader.queueLoadAction(),u},o.prototype.getBlockStates=function(){var e=this,t={},o={},r=new Set;this.getNodeMapEntries().forEach((function(n){var i,s=h(n,2),a=s[0],d=s[1],l=Number(a),c=e.rowLoader.getBlockStartIndexForIndex(l);d.stub||d.failedLoad||(t[c]=(null!==(i=t[c])&&void 0!==i?i:0)+1);var u="loaded";d.failedLoad?u="failed":e.rowLoader.isRowLoading(c)?u="loading":d.__needsRefresh&&(u="needsLoading"),(d.__needsRefreshWhenVisible||d.stub)&&r.add(c),o[c]||(o[c]=new Set),o[c].add(u)}));var n={loading:4,failed:3,needsLoading:2,loaded:1},i=this.blockUtils.createNodeIdPrefix(this.store.getParentNode()),s={};return Object.entries(o).forEach((function(o){var r,a=h(o,2),d=a[0],l=a[1],c=f(l).sort((function(e,t){var o,r;return(null!==(o=n[e])&&void 0!==o?o:0)-(null!==(r=n[t])&&void 0!==r?r:0)}))[0],u=Number(d)/e.rowLoader.getBlockSize(),p=i?i+"-"+u:String(u);s[p]={blockNumber:u,startRow:Number(d),endRow:Number(d)+e.rowLoader.getBlockSize(),pageStatus:c,loadedRowCount:null!==(r=t[d])&&void 0!==r?r:0}})),s},o.prototype.destroyRowAtIndex=function(e){var t=this.nodeIndexMap[e];this.nodeIds.delete(t.id),this.blockUtils.destroyRowNode(t),delete this.nodeIndexMap[e]},o.prototype.getSsrmParams=function(){return this.store.getSsrmParams()},o.prototype.getPrefixedId=function(e){return this.defaultNodeIdPrefix?this.defaultNodeIdPrefix+"-"+e:e.toString()},o.prototype.markBlockForVerify=function(e){for(var t=h(this.rowLoader.getBlockBoundsForIndex(e),2),o=t[0],r=t[1],n=o;n<r;n++){var i=this.nodeIndexMap[n];i&&(i.__needsRefreshWhenVisible=!0)}},o.prototype.doesNodeMatch=function(e,t){if(t.stub)return!1;if(this.isUsingRowIds()){var o=this.getRowId(e);return t.id===o}return t.data===e},o.prototype.purgeStubsOutsideOfViewport=function(){var e=this,t=this.api.getFirstDisplayedRow(),o=this.api.getLastDisplayedRow(),r=this.rowLoader.getBlockStartIndexForIndex(t),n=h(this.rowLoader.getBlockBoundsForIndex(o),2);n[0];var i=n[1];this.getNodeMapEntries().forEach((function(t){var o=h(t,2),n=o[0],s=o[1],a=Number(n);e.rowLoader.isRowLoading(a)||s.stub&&(a<r||a>i)&&e.destroyRowAtIndex(a)}))},o.prototype.getNumberOfRowsToRetain=function(e,t){var o=this.storeParams.maxBlocksInCache;if(null==o)return null;var r=this.rowLoader.getBlockSize(),n=Math.ceil((t-e)/r);return Math.max(o,n)*r},o.prototype.getBlocksDistanceFromRow=function(e,t){var o=this,r={};return e.forEach((function(e){var n=h(e,2),i=n[0],s=n[1],a=h(o.rowLoader.getBlockBoundsForIndex(Number(i)),2),d=a[0],l=a[1];if(!(d in r)){var c,u=Math.abs(s.rowIndex-t);o.nodeIndexMap[l-1]&&(c=Math.abs(o.nodeIndexMap[l-1].rowIndex-t));var p=null==c||u<c?u:c;r[d]=p}})),Object.entries(r)},o.prototype.purgeExcessRows=function(){var e=this;this.purgeStubsOutsideOfViewport();var t=this.api.getFirstDisplayedRow(),o=this.api.getLastDisplayedRow(),r=this.rowLoader.getBlockStartIndexForIndex(t),n=h(this.rowLoader.getBlockBoundsForIndex(o),2);n[0];var i=n[1],s=this.getNumberOfRowsToRetain(r,i);if(null!=this.store.getDisplayIndexEnd()&&null!=s){var a=this.getNodeMapEntries().filter((function(t){var o=h(t,2);o[0];var r=o[1];return!r.stub&&!e.isNodeCached(r)}));if(!(a.length<=s)){var d=t+(o-t)/2,l=this.getBlocksDistanceFromRow(a,d),c=this.rowLoader.getBlockSize(),u=Math.ceil(s/c);if(!(l.length<=u)){l.sort((function(e,t){return Math.sign(t[1]-e[1])}));for(var p=l.length-u,f=0;f<p;f++)for(var v=Number(l[f][0]),g=v;g<v+c;g++){var y=this.nodeIndexMap[g];y&&!this.isNodeCached(y)&&this.destroyRowAtIndex(g)}}}}},o.prototype.isNodeFocused=function(e){var t=this.focusService.getFocusCellToUseAfterRefresh();return!!t&&(null==t.rowPinned&&t.rowIndex===e.rowIndex)},o.prototype.isNodeCached=function(e){return!!e.group&&e.expanded||this.isNodeFocused(e)},o.prototype.extractDuplicateIds=function(e){var t=this;if(!this.isUsingRowIds())return[];var o=new Set,r=new Set;return e.forEach((function(e){var n=t.getRowId(e);o.has(n)?r.add(n):o.add(n)})),f(r)},o.prototype.onLoadSuccess=function(e,t,o){var r=this;if(this.live){if(this.isUsingRowIds()){var n=this.extractDuplicateIds(o.rowData);if(n.length>0){var i=n.join(", ");return console.warn("AG Grid: Unable to display rows as duplicate row ids ("+i+") were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids."),void this.onLoadFailed(e,t)}}if(o.rowData.forEach((function(t,o){var n=e+o,i=r.nodeIndexMap[n];if(!(null==i?void 0:i.stub))return i&&r.doesNodeMatch(t,i)?(r.blockUtils.updateDataIntoRowNode(i,t),i.__needsRefresh=!1,void(i.__needsRefreshWhenVisible=!1)):void r.createRowAtIndex(n,t);r.createRowAtIndex(n,t)})),null!=o.rowCount&&-1!==o.rowCount)this.numberOfRows=o.rowCount,this.isLastRowKnown=!0;else if(t>o.rowData.length)this.numberOfRows=e+o.rowData.length,this.isLastRowKnown=!0;else if(!this.isLastRowKnown){var s=e+o.rowData.length+1;s>this.numberOfRows&&(this.numberOfRows=s)}if(this.isLastRowKnown)for(var a=this.getNodeMapEntries(),d=a.length-1;d>=0;d--){var l=Number(a[d][0]);if(l<this.numberOfRows)break;this.destroyRowAtIndex(l)}this.fireStoreUpdatedEvent()}},o.prototype.isLastRowIndexKnown=function(){return this.isLastRowKnown},o.prototype.onLoadFailed=function(e,t){if(this.live){for(var o=e;o<e+t;o++){var r=this.nodeIndexMap[o];r&&(r.failedLoad=!0)}this.fireStoreUpdatedEvent()}},o.prototype.markNodesForRefresh=function(){this.getAllNodes().forEach((function(e){return e.__needsRefresh=!0})),this.rowLoader.queueLoadAction()},o.prototype.isNodeInCache=function(e){return this.nodeIds.has(e)},o.prototype.fireStoreUpdatedEvent=function(){this.live&&this.store.fireStoreUpdatedEvent()},o.prototype.isUsingRowIds=function(){return null!=this.gridOptionsService.getRowIdFunc()},o.prototype.getRowId=function(e){var t=this.gridOptionsService.getRowIdFunc();if(null==t)return null;var o=this.store.getRowDetails().level,r=this.store.getParentNode().getGroupKeys(),n=t({data:e,parentKeys:r.length>0?r:void 0,level:o});return String(n)},o.prototype.lookupRowNode=function(e){var t;if(!this.isUsingRowIds())throw new Error("AG Grid: Insert transactions can only be applied when row ids are supplied.");var o=this.getRowId(e);return null!==(t=this.getAllNodes().find((function(e){return e.id===o})))&&void 0!==t?t:null},o.prototype.updateRowNodes=function(e){var t=this,o=[];return e.forEach((function(e){var r=t.lookupRowNode(e);r&&(t.blockUtils.updateDataIntoRowNode(r,e),o.push(r))})),o},o.prototype.insertRowNodes=function(e,t){var o=this,r=null==t&&this.isLastRowKnown?this.store.getRowCount():t;if(null==r||this.store.getRowCount()<r)return[];if(!this.isUsingRowIds())throw new Error("AG Grid: Insert transactions can only be applied when row ids are supplied.");var n={};e.forEach((function(e){var t=o.getRowId(e);t&&o.isNodeInCache(t)||(n[t]=e)}));var i=Object.values(n),s=i.length;if(0===s)return[];for(var a=this.getNodeMapEntries(),d=a.length-1;d>=0;d--){var l=h(a[d],2),c=l[0],u=l[1],p=Number(c);if(p<r)break;var f=p+s;if(this.getRowByStoreIndex(f))throw new Error("AG Grid: Something went wrong, node in wrong place.");this.nodeIndexMap[p+s]=u,delete this.nodeIndexMap[p]}return this.numberOfRows+=s,i.map((function(e,t){return o.createRowAtIndex(r+t,e)}))},o.prototype.removeRowNodes=function(e){if(!this.isUsingRowIds())throw new Error("AG Grid: Insert transactions can only be applied when row ids are supplied.");for(var t=[],o=this.getNodeMapEntries(),r=0,n=f(e),i=[],s=function(e){var s=h(o[e],2),d=s[0],l=s[1],c=n.findIndex((function(e){return e===l.id}));if(-1!==c)return n.splice(c,1),a.destroyRowAtIndex(Number(d)),t.push(l),r+=1,"continue";if(0===r)return"continue";var u=Number(d);e!==u&&i.push(l),a.nodeIndexMap[u-r]=a.nodeIndexMap[u],delete a.nodeIndexMap[u]},a=this,d=0;d<o.length;d++)s(d);return this.numberOfRows-=this.isLastRowIndexKnown()?e.length:r,n.length>0&&i.length>0&&(i.forEach((function(e){return e.__needsRefreshWhenVisible=!0})),this.rowLoader.queueLoadAction()),t},p([t.Autowired("gridApi")],o.prototype,"api",void 0),p([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),p([t.Autowired("focusService")],o.prototype,"focusService",void 0),p([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),p([t.PostConstruct],o.prototype,"init",null),p([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.BeanStub),g=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),y=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},w=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},S=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e},R=function(e){function o(o,r,n){var i=e.call(this)||this;return i.idSequence=new t.NumberSequence,i.ssrmParams=o,i.parentRowNode=n,i.storeParams=r,i.level=n.level+1,i.group=!!o.rowGroupCols&&i.level<o.rowGroupCols.length,i.leafGroup=!!o.rowGroupCols&&i.level===o.rowGroupCols.length-1,i}return g(o,e),o.prototype.init=function(){var e=1;if(0===this.level&&(e=this.storeUtils.getServerSideInitialRowCount()),this.cache=this.createManagedBean(new v(this,e,this.storeParams)),!this.gridOptionsService.isTreeData()&&this.group){var t=this.ssrmParams.rowGroupCols[this.level];this.groupField=t.field,this.rowGroupColumn=this.columnModel.getRowGroupColumns()[this.level]}},o.prototype.destroyRowNodes=function(){this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.destroyBean(this.cache)},o.prototype.applyTransaction=function(e){var o,r,n,i=this,s=this.gridOptionsService.getRowIdFunc();if(!s)return console.warn("AG Grid: getRowId callback must be implemented for transactions to work. Transaction was ignored."),{status:t.ServerSideTransactionResultStatus.Cancelled};var a=this.gridOptionsService.getCallback("isApplyServerSideTransaction");if(a&&!a({transaction:e,parentNode:this.parentRowNode,storeInfo:this.info,groupLevelInfo:this.info}))return{status:t.ServerSideTransactionResultStatus.Cancelled};var d=void 0;(null===(o=e.update)||void 0===o?void 0:o.length)&&(d=this.cache.updateRowNodes(e.update));var l=void 0;if(null===(r=e.add)||void 0===r?void 0:r.length){var c=e.addIndex;null!=c&&c<0&&(c=void 0),l=this.cache.insertRowNodes(e.add,c)}var u=void 0;if(null===(n=e.remove)||void 0===n?void 0:n.length){var p=e.remove.map((function(e){return s({level:i.level,parentKeys:i.parentRowNode.getGroupKeys(),data:e})})),h=S(new Set(p));u=this.cache.removeRowNodes(h)}return this.updateSelectionAfterTransaction(d,u),{status:t.ServerSideTransactionResultStatus.Applied,update:d,add:l,remove:u}},o.prototype.updateSelectionAfterTransaction=function(e,o){var r=!1;if(null==e||e.forEach((function(e){e.isSelected()&&!e.selectable&&(e.setSelected(!1,!1,!0,"rowDataChanged"),r=!0)})),null==o||o.forEach((function(e){e.isSelected()&&(e.setSelected(!1,!1,!0,"rowDataChanged"),r=!0)})),r){var n={type:t.Events.EVENT_SELECTION_CHANGED,source:"rowDataChanged"};this.eventService.dispatchEvent(n)}},o.prototype.clearDisplayIndexes=function(){var e=this;this.displayIndexStart=void 0,this.displayIndexEnd=void 0,this.cache.getAllNodes().forEach((function(t){return e.blockUtils.clearDisplayIndex(t)}))},o.prototype.getDisplayIndexStart=function(){return this.displayIndexStart},o.prototype.getDisplayIndexEnd=function(){return this.displayIndexEnd},o.prototype.getRowCount=function(){return this.cache.getRowCount()},o.prototype.setRowCount=function(e,t){this.cache.setRowCount(e,t)},o.prototype.isDisplayIndexInStore=function(e){return 0!==this.cache.getRowCount()&&(this.displayIndexStart<=e&&e<this.getDisplayIndexEnd())},o.prototype.setDisplayIndexes=function(e,t){this.displayIndexStart=e.peek(),this.topPx=t.value,this.cache.setDisplayIndexes(e,t),this.displayIndexEnd=e.peek(),this.heightPx=t.value-this.topPx},o.prototype.forEachStoreDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),e(this,o.next()),this.cache.getAllNodes().forEach((function(t){var r=t.childStore;r&&r.forEachStoreDeep(e,o)}))},o.prototype.forEachNodeDeep=function(e,o){void 0===o&&(o=new t.NumberSequence),this.cache.getAllNodes().forEach((function(t){e(t,o.next());var r=t.childStore;r&&r.forEachNodeDeep(e,o)}))},o.prototype.forEachNodeDeepAfterFilterAndSort=function(e,o){void 0===o&&(o=new t.NumberSequence),this.cache.getAllNodes().forEach((function(t){e(t,o.next());var r=t.childStore;r&&r.forEachNodeDeepAfterFilterAndSort(e,o)}))},o.prototype.retryLoads=function(){this.cache.getAllNodes().forEach((function(e){e.failedLoad&&(e.failedLoad=!1,e.__needsRefreshWhenVisible=!0,e.stub=!0)})),this.forEachChildStoreShallow((function(e){return e.retryLoads()})),this.fireStoreUpdatedEvent()},o.prototype.getRowUsingDisplayIndex=function(e){return this.cache.getRowByDisplayIndex(e)},o.prototype.getRowBounds=function(e){if(!this.isDisplayIndexInStore(e))return null;for(var t=this.cache.getAllNodes(),o=null,r=null,n=0;n<t.length;n++){var i=t[n];if(i.rowIndex>e){r=i;break}o=i}if(o){var s=this.blockUtils.extractRowBounds(o,e);if(null!=s)return s}var a=this.gridOptionsService.getRowHeightAsNumber();if(r){var d=Math.floor((r.rowIndex-e)*a);return{rowTop:r.rowTop-d,rowHeight:a}}return{rowTop:this.topPx+this.heightPx-Math.floor((this.getDisplayIndexEnd()-e)*a),rowHeight:a}},o.prototype.isPixelInRange=function(e){return e>=this.topPx&&e<this.topPx+this.heightPx},o.prototype.getRowIndexAtPixel=function(e){if(e<this.topPx)return this.getDisplayIndexStart();if(e>=this.topPx+this.heightPx)return this.getDisplayIndexEnd()-1;for(var t=this.cache.getAllNodes(),o=null,r=null,n=0;n<t.length;n++){var i=t[n];if(i.rowTop>e){r=i;break}o=i}if(o){var s=this.blockUtils.getIndexAtPixel(o,e);if(null!=s)return s}var a=this.gridOptionsService.getRowHeightAsNumber();if(r){var d=r.rowTop,l=Math.ceil((d-e)/a);return r.rowIndex-l}var c=this.topPx+this.heightPx,u=Math.floor((c-e)/a);return this.getDisplayIndexEnd()-u},o.prototype.getChildStore=function(e){var t=this;return this.storeUtils.getChildStore(e,this,(function(e){return t.cache.getAllNodes().find((function(t){return t.key==e}))}))},o.prototype.forEachChildStoreShallow=function(e){this.cache.getAllNodes().forEach((function(t){t.childStore&&e(t.childStore)}))},o.prototype.refreshAfterSort=function(e){if(this.storeUtils.isServerSideSortAllLevels()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)){var t=this.cache.getRowCount();return this.destroyBean(this.cache),this.cache=this.createManagedBean(new v(this,t,this.storeParams)),void this.fireStoreUpdatedEvent()}this.forEachChildStoreShallow((function(t){return t.refreshAfterSort(e)}))},o.prototype.refreshAfterFilter=function(e){this.storeUtils.isServerSideFilterAllLevels()||this.storeUtils.isServerRefreshNeeded(this.parentRowNode,this.ssrmParams.rowGroupCols,e)?this.refreshStore(!0):this.forEachChildStoreShallow((function(t){return t.refreshAfterFilter(e)}))},o.prototype.refreshStore=function(e){if(e)return this.destroyBean(this.cache),this.cache=this.createManagedBean(new v(this,1,this.storeParams)),void this.fireStoreUpdatedEvent();this.cache.markNodesForRefresh()},o.prototype.getTopLevelRowDisplayedIndex=function(e){var t=this.cache.getDisplayIndexFromStoreIndex(e);return null!=t?t:e},o.prototype.isLastRowIndexKnown=function(){return this.cache.isLastRowIndexKnown()},o.prototype.getRowNodesInRange=function(e,o){var r=[],n=!1;return t._.missing(e)&&(n=!0),this.cache.getAllNodes().forEach((function(t){var i=t===e||t===o;(n||i)&&r.push(t),i&&(n=!n)})),n?[]:r},o.prototype.addStoreStates=function(e){e.push({suppressInfiniteScroll:!1,route:this.parentRowNode.getGroupKeys(),rowCount:this.getRowCount(),lastRowIndexKnown:this.isLastRowIndexKnown(),info:this.info,maxBlocksInCache:this.storeParams.maxBlocksInCache,cacheBlockSize:this.storeParams.cacheBlockSize}),this.forEachChildStoreShallow((function(t){return t.addStoreStates(e)}))},o.prototype.getIdSequence=function(){return this.idSequence},o.prototype.getParentNode=function(){return this.parentRowNode},o.prototype.getRowDetails=function(){return{field:this.groupField,group:this.group,leafGroup:this.leafGroup,level:this.level,parent:this.parentRowNode,rowGroupColumn:this.rowGroupColumn}},o.prototype.getSsrmParams=function(){return this.ssrmParams},o.prototype.setStoreInfo=function(e){this.info=e},o.prototype.fireStoreUpdatedEvent=function(){var e={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)},o.prototype.getBlockStates=function(){return this.cache.getBlockStates()},y([t.Autowired("ssrmBlockUtils")],o.prototype,"blockUtils",void 0),y([t.Autowired("ssrmStoreUtils")],o.prototype,"storeUtils",void 0),y([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),y([t.PostConstruct],o.prototype,"init",null),y([t.PreDestroy],o.prototype,"destroyRowNodes",null),o}(t.BeanStub),N=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),m=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},A=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},I=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o.onRowHeightChanged_debounced=t._.debounce(o.onRowHeightChanged.bind(o),100),o.pauseStoreUpdateListening=!1,o.started=!1,o}return N(o,e),o.prototype.ensureRowHeightsValid=function(){return!1},o.prototype.start=function(){this.started=!0;var e=this.gridOptionsService.get("serverSideDatasource");e&&this.setDatasource(e)},o.prototype.destroyDatasource=function(){this.datasource&&(this.datasource.destroy&&this.datasource.destroy(),this.rowRenderer.datasourceChanged(),this.datasource=void 0)},o.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,t.Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,t.Events.EVENT_STORE_UPDATED,this.onStoreUpdated.bind(this));var e=this.resetRootStore.bind(this);this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_VALUE_CHANGED,e),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_PIVOT_CHANGED,e),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.verifyProps()},o.prototype.verifyProps=function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")||this.gridOptionsService.exists("defaultGroupOrderComparator")){t._.doOnce((function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Server Side Row Model. If using Full Store, then provide the rows to the grid in the desired sort order. If using Infinite Scroll, then sorting is done on the server side, nothing to do with the client.")}),"SSRM.InitialGroupOrderComparator")}if(this.gridOptionsService.isRowSelection()&&!this.gridOptionsService.exists("getRowId")){t._.doOnce((function(){return console.warn("AG Grid: getRowId callback must be provided for Server Side Row Model selection to work correctly.")}),"SSRM.SelectionNeedsRowNodeIdFunc")}},o.prototype.setDatasource=function(e){this.started&&(this.destroyDatasource(),this.datasource=e,this.resetRootStore())},o.prototype.isLastRowIndexKnown=function(){var e=this.getRootStore();return!!e&&e.isLastRowIndexKnown()},o.prototype.onColumnEverything=function(){if(this.storeParams){var e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),o=this.columnsToValueObjects(this.columnModel.getValueColumns()),r=this.columnsToValueObjects(this.columnModel.getPivotColumns()),n=function(e){var t={};e.oldCols.forEach((function(e){return t[e.id]=e}));var o=e.newCols.every((function(e){var o=t[e.id];return o&&delete t[e.id],o&&o.field===e.field&&o.aggFunc===e.aggFunc})),r=!e.allowRemovedColumns&&!!Object.values(t).length;return o&&!r},i=!t._.jsonEquals(this.storeParams.sortModel,this.sortListener.extractSortModel()),s=!n({oldCols:this.storeParams.rowGroupCols,newCols:e}),a=!n({oldCols:this.storeParams.pivotCols,newCols:r}),d=!!(null==e?void 0:e.length)&&!n({oldCols:this.storeParams.valueCols,newCols:o,allowRemovedColumns:!0});if(i||s||a||d)this.resetRootStore();else{var l=this.createStoreParams();this.storeParams.rowGroupCols=l.rowGroupCols,this.storeParams.pivotCols=l.pivotCols,this.storeParams.valueCols=l.valueCols}}else this.resetRootStore()},o.prototype.destroyRootStore=function(){this.rootNode&&this.rootNode.childStore&&(this.rootNode.childStore=this.destroyBean(this.rootNode.childStore),this.nodeManager.clear())},o.prototype.refreshAfterSort=function(e,t){this.storeParams&&(this.storeParams.sortModel=e);var o=this.getRootStore();o&&(o.refreshAfterSort(t),this.onStoreUpdated())},o.prototype.resetRootStore=function(){this.destroyRootStore(),this.rootNode=new t.RowNode(this.beans),this.rootNode.group=!0,this.rootNode.level=-1,this.datasource&&(this.storeParams=this.createStoreParams(),this.rootNode.childStore=this.createBean(this.storeFactory.createStore(this.storeParams,this.rootNode)),this.updateRowIndexesAndBounds());var e={type:t.Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(e),this.dispatchModelUpdated(!0)},o.prototype.columnsToValueObjects=function(e){var t=this;return e.map((function(e){return{id:e.getId(),aggFunc:e.getAggFunc(),displayName:t.columnModel.getDisplayNameForColumn(e,"model"),field:e.getColDef().field}}))},o.prototype.createStoreParams=function(){var e=this.columnsToValueObjects(this.columnModel.getRowGroupColumns()),o=this.columnsToValueObjects(this.columnModel.getValueColumns()),r=this.columnsToValueObjects(this.columnModel.getPivotColumns()),n=this.gridOptionsService.isGetRowHeightFunction();return{valueCols:o,rowGroupCols:e,pivotCols:r,pivotMode:this.columnModel.isPivotMode(),filterModel:this.filterManager.getFilterModel(),sortModel:this.sortListener.extractSortModel(),datasource:this.datasource,lastAccessedSequence:new t.NumberSequence,dynamicRowHeight:n}},o.prototype.getParams=function(){return this.storeParams},o.prototype.dispatchModelUpdated=function(e){void 0===e&&(e=!1);var o={type:t.Events.EVENT_MODEL_UPDATED,animate:!e,keepRenderedRows:!e,newPage:!1,newData:!1};this.eventService.dispatchEvent(o)},o.prototype.onStoreUpdated=function(){this.pauseStoreUpdateListening||(this.updateRowIndexesAndBounds(),this.dispatchModelUpdated())},o.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},o.prototype.onRowHeightChanged=function(){this.updateRowIndexesAndBounds(),this.dispatchModelUpdated()},o.prototype.updateRowIndexesAndBounds=function(){var e=this.getRootStore();e&&e.setDisplayIndexes(new t.NumberSequence,{value:0})},o.prototype.retryLoads=function(){var e=this.getRootStore();e&&(e.retryLoads(),this.onStoreUpdated())},o.prototype.getRow=function(e){var t=this.getRootStore();if(t)return t.getRowUsingDisplayIndex(e)},o.prototype.expandAll=function(e){this.pauseStoreUpdateListening=!0,this.forEachNode((function(t){t.stub||t.hasChildren()&&t.setExpanded(e)})),this.pauseStoreUpdateListening=!1,this.onStoreUpdated()},o.prototype.refreshAfterFilter=function(e,t){this.storeParams&&(this.storeParams.filterModel=e);var o=this.getRootStore();o&&(o.refreshAfterFilter(t),this.onStoreUpdated())},o.prototype.getRootStore=function(){if(this.rootNode&&this.rootNode.childStore)return this.rootNode.childStore},o.prototype.getRowCount=function(){var e=this.getRootStore();return e?e.getDisplayIndexEnd():0},o.prototype.getTopLevelRowCount=function(){var e=this.getRootStore();return e?e.getRowCount():1},o.prototype.getTopLevelRowDisplayedIndex=function(e){var t=this.getRootStore();return t?t.getTopLevelRowDisplayedIndex(e):e},o.prototype.getRowBounds=function(e){var t=this.getRootStore();return t?t.getRowBounds(e):{rowTop:0,rowHeight:this.gridOptionsService.getRowHeightAsNumber()}},o.prototype.getBlockStates=function(){var e=this.getRootStore();if(e){var t={};return e.forEachStoreDeep((function(e){if(e instanceof i){var o=e.getBlockStateJson(),r=o.id,n=o.state;t[r]=n}else{if(!(e instanceof R))throw new Error("AG Grid: Unsupported store type");Object.entries(e.getBlockStates()).forEach((function(e){var o=A(e,2),r=o[0],n=o[1];t[r]=n}))}})),t}},o.prototype.getRowIndexAtPixel=function(e){var t=this.getRootStore();return e<=0||!t?0:t.getRowIndexAtPixel(e)},o.prototype.isEmpty=function(){return!1},o.prototype.isRowsToRender=function(){return null!=this.getRootStore()&&this.getRowCount()>0},o.prototype.getType=function(){return"serverSide"},o.prototype.forEachNode=function(e){var t=this.getRootStore();t&&t.forEachNodeDeep(e)},o.prototype.forEachNodeAfterFilterAndSort=function(e){var t=this.getRootStore();t&&t.forEachNodeDeepAfterFilterAndSort(e)},o.prototype.executeOnStore=function(e,t){var o=this.getRootStore();if(o){var r=o.getChildStore(e);r&&t(r)}},o.prototype.refreshStore=function(e){void 0===e&&(e={});var t=e.route?e.route:[];this.executeOnStore(t,(function(t){return t.refreshStore(1==e.purge)}))},o.prototype.getStoreState=function(){var e=[],t=this.getRootStore();return t&&t.addStoreStates(e),e},o.prototype.getNodesInRangeForSelection=function(e,o){if(!t._.exists(e))return[];if(!o)return[e];var r=e.rowIndex,n=o.rowIndex;if(null===r||null===n)return[e];var i=[],s=A([r,n].sort((function(e,t){return e-t})),2),a=s[0],d=s[1];return this.forEachNode((function(e){var t=e.rowIndex;null==t||e.stub||t>=a&&t<=d&&i.push(e)})),i.every((function(e,t,o){return 0===t?e.rowIndex===a:o[t-1].rowIndex===e.rowIndex-1}))&&i.length===d-a+1?i:[e]},o.prototype.getRowNode=function(e){var t;return this.forEachNode((function(o){o.id===e&&(t=o),o.detailNode&&o.detailNode.id===e&&(t=o.detailNode)})),t},o.prototype.isRowPresent=function(e){return!!this.getRowNode(e.id)},o.prototype.setRowCount=function(e,t){var o=this.getRootStore();if(o){if(o instanceof R)return void o.setRowCount(e,t);console.error("AG Grid: Infinite scrolling must be enabled in order to set the row count.")}},m([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),m([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),m([t.Autowired("rowRenderer")],o.prototype,"rowRenderer",void 0),m([t.Autowired("ssrmSortService")],o.prototype,"sortListener",void 0),m([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),m([t.Autowired("ssrmStoreFactory")],o.prototype,"storeFactory",void 0),m([t.Autowired("beans")],o.prototype,"beans",void 0),m([t.PreDestroy],o.prototype,"destroyDatasource",null),m([t.PostConstruct],o.prototype,"addEventListeners",null),m([t.PreDestroy],o.prototype,"destroyRootStore",null),o=m([t.Bean("rowModel")],o)}(t.BeanStub),C=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),b=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},x=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return C(o,e),o.prototype.loadFromDatasource=function(e){var t=e.storeParams,o=e.parentBlock,r=e.parentNode.getGroupKeys();if(t.datasource){var n={startRow:e.startRow,endRow:e.endRow,rowGroupCols:t.rowGroupCols,valueCols:t.valueCols,pivotCols:t.pivotCols,pivotMode:t.pivotMode,groupKeys:r,filterModel:t.filterModel,sortModel:t.sortModel},i={successCallback:e.successCallback,success:e.success,failCallback:e.failCallback,fail:e.fail,request:n,parentNode:e.parentNode,api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};window.setTimeout((function(){t.datasource&&o.isAlive()?t.datasource.getRows(i):e.failCallback()}),0)}},o.prototype.getChildStore=function(e,o,r){if(t._.missingOrEmpty(e))return o;var n=r(e[0]);if(n){var i=e.slice(1,e.length),s=n.childStore;return s?s.getChildStore(i):null}return null},o.prototype.isServerRefreshNeeded=function(e,t,o){if(o.valueColChanged||o.secondaryColChanged)return!0;var r=e.level+1;if(!(r<t.length))return!0;var n=t[r].id;return o.changedColumns.indexOf(n)>-1||this.columnModel.getAllGridColumns().filter((function(e){return e.getColDef().showRowGroup&&o.changedColumns.includes(e.getId())})).map((function(e){return e.getColDef().showRowGroup})).some((function(e){return!0===e||e===n}))},o.prototype.getServerSideInitialRowCount=function(){var e=this.gridOptionsService.getNum("serverSideInitialRowCount");return"number"==typeof e&&e>0?e:1},o.prototype.assertRowModelIsServerSide=function(e){return!!this.gridOptionsService.isRowModelType("serverSide")||(t._.doOnce((function(){return console.warn("AG Grid: The '"+e+"' property can only be used with the Server Side Row Model.")}),e),!1)},o.prototype.assertNotTreeData=function(e){return!this.gridOptionsService.is("treeData")||(t._.doOnce((function(){return console.warn("AG Grid: The '"+e+"' property cannot be used while using tree data.")}),e+"_TreeData"),!1)},o.prototype.isServerSideSortAllLevels=function(){return this.gridOptionsService.is("serverSideSortAllLevels")&&this.assertRowModelIsServerSide("serverSideSortAllLevels")},o.prototype.isServerSideFilterAllLevels=function(){return this.gridOptionsService.is("serverSideFilterAllLevels")&&this.assertRowModelIsServerSide("serverSideFilterAllLevels")},o.prototype.isServerSideSortOnServer=function(){return this.gridOptionsService.is("serverSideSortOnServer")&&this.assertRowModelIsServerSide("serverSideSortOnServer")&&this.assertNotTreeData("serverSideSortOnServer")},o.prototype.isServerSideFilterOnServer=function(){return this.gridOptionsService.is("serverSideFilterOnServer")&&this.assertRowModelIsServerSide("serverSideFilterOnServer")&&this.assertNotTreeData("serverSideFilterOnServer")},b([t.Autowired("columnApi")],o.prototype,"columnApi",void 0),b([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),b([t.Autowired("gridApi")],o.prototype,"gridApi",void 0),o=b([t.Bean("ssrmStoreUtils")],o)}(t.BeanStub),E=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),O=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},M=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return E(o,e),o.prototype.postConstruct=function(){this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.usingTreeData=this.gridOptionsService.isTreeData(),this.usingMasterDetail=this.gridOptionsService.isMasterDetail()},o.prototype.createRowNode=function(e){var o=new t.RowNode(this.beans),r=null!=e.rowHeight?e.rowHeight:this.rowHeight;return o.setRowHeight(r),o.group=e.group,o.leafGroup=e.leafGroup,o.level=e.level,o.uiLevel=e.level,o.parent=e.parent,o.stub=!0,o.__needsRefresh=!1,o.__needsRefreshWhenVisible=!1,o.group&&(o.expanded=!1,o.field=e.field,o.rowGroupColumn=e.rowGroupColumn),o},o.prototype.destroyRowNodes=function(e){var t=this;e&&e.forEach((function(e){return t.destroyRowNode(e)}))},o.prototype.destroyRowNode=function(e,t){void 0===t&&(t=!1),e.childStore&&!t&&(this.destroyBean(e.childStore),e.childStore=null),e.clearRowTopAndRowIndex(),null!=e.id&&this.nodeManager.removeNode(e)},o.prototype.setTreeGroupInfo=function(e){e.updateHasChildren();var t=this.gridOptionsService.get("getServerSideGroupKey");e.hasChildren()&&null!=t&&(e.key=t(e.data)),e.hasChildren()||null==e.childStore||(this.destroyBean(e.childStore),e.childStore=null,e.expanded=!1)},o.prototype.setRowGroupInfo=function(e){e.key=this.valueService.getValue(e.rowGroupColumn,e),null!==e.key&&void 0!==e.key||t._.doOnce((function(){console.warn("AG Grid: null and undefined values are not allowed for server side row model keys"),e.rowGroupColumn&&console.warn("column = "+e.rowGroupColumn.getId()),console.warn("data is ",e.data)}),"ServerSideBlock-CannotHaveNullOrUndefinedForKey")},o.prototype.setMasterDetailInfo=function(e){var t=this.gridOptionsService.get("isRowMaster");e.master=null==t||t(e.data)},o.prototype.updateDataIntoRowNode=function(e,t){e.updateData(t),this.usingTreeData?(this.setTreeGroupInfo(e),this.setChildCountIntoRowNode(e)):e.group?this.setChildCountIntoRowNode(e):this.usingMasterDetail},o.prototype.setDataIntoRowNode=function(e,o,r,n){e.stub=!1,t._.exists(o)?(e.setDataAndId(o,r),this.usingTreeData?this.setTreeGroupInfo(e):e.group?this.setRowGroupInfo(e):this.usingMasterDetail&&this.setMasterDetailInfo(e)):(e.setDataAndId(void 0,void 0),e.key=null),(this.usingTreeData||e.group)&&(this.setGroupDataIntoRowNode(e),this.setChildCountIntoRowNode(e)),t._.exists(o)&&e.setRowHeight(this.gridOptionsService.getRowHeightForNode(e,!1,n).height)},o.prototype.setChildCountIntoRowNode=function(e){var t=this.gridOptionsService.get("getChildCount");t&&e.setAllChildrenCount(t(e.data))},o.prototype.setGroupDataIntoRowNode=function(e){var t=this,o=this.columnModel.getGroupDisplayColumns(),r=this.gridOptionsService.isTreeData();o.forEach((function(o){if(null==e.groupData&&(e.groupData={}),r)e.groupData[o.getColId()]=e.key;else if(o.isRowGroupDisplayed(e.rowGroupColumn.getId())){var n=t.valueService.getValue(e.rowGroupColumn,e);e.groupData[o.getColId()]=n}}))},o.prototype.clearDisplayIndex=function(e){(e.clearRowTopAndRowIndex(),e.hasChildren()&&t._.exists(e.childStore))&&e.childStore.clearDisplayIndexes();e.master&&e.detailNode&&e.detailNode.clearRowTopAndRowIndex()},o.prototype.setDisplayIndex=function(e,o,r){if(e.setRowIndex(o.next()),e.setRowTop(r.value),r.value+=e.rowHeight,e.master&&(e.expanded&&e.detailNode?(e.detailNode.setRowIndex(o.next()),e.detailNode.setRowTop(r.value),r.value+=e.detailNode.rowHeight):e.detailNode&&e.detailNode.clearRowTopAndRowIndex()),e.hasChildren()&&t._.exists(e.childStore)){var n=e.childStore;e.expanded?n.setDisplayIndexes(o,r):n.clearDisplayIndexes()}},o.prototype.binarySearchForDisplayIndex=function(e,o){var r=0,n=o.length-1;if(t._.missing(n)||t._.missing(r))console.warn("AG Grid: error: topPointer = "+n+", bottomPointer = "+r);else for(;;){var i=Math.floor((r+n)/2),s=o[i];if(s.rowIndex===e)return s;var a=s.master&&s.expanded,d=s.detailNode;if(a&&d&&d.rowIndex===e)return s.detailNode;var l=s.childStore;if(s.expanded&&l&&l.isDisplayIndexInStore(e))return l.getRowUsingDisplayIndex(e);if(s.rowIndex<e)r=i+1;else{if(!(s.rowIndex>e))return void console.warn("AG Grid: error: unable to locate rowIndex = "+e+" in cache");n=i-1}}},o.prototype.extractRowBounds=function(e,o){var r=function(e){return{rowHeight:e.rowHeight,rowTop:e.rowTop}};if(e.rowIndex===o)return r(e);if(e.hasChildren()&&e.expanded&&t._.exists(e.childStore)){var n=e.childStore;if(n.isDisplayIndexInStore(o))return n.getRowBounds(o)}else if(e.master&&e.expanded&&t._.exists(e.detailNode)&&e.detailNode.rowIndex===o)return r(e.detailNode)},o.prototype.getIndexAtPixel=function(e,o){if(e.isPixelInRange(o))return e.rowIndex;var r=e.master&&e.expanded,n=e.detailNode;if(r&&n&&n.isPixelInRange(o))return e.detailNode.rowIndex;if(e.hasChildren()&&e.expanded&&t._.exists(e.childStore)){var i=e.childStore;if(i.isPixelInRange(o))return i.getRowIndexAtPixel(o)}return null},o.prototype.createNodeIdPrefix=function(e){for(var t=[],o=e;o&&o.level>=0;)""===o.key?t.push("ag-Grid-MissingKey"):t.push(o.key),o=o.parent;if(t.length>0)return t.reverse().join("-")},o.prototype.checkOpenByDefault=function(e){if(e.isExpandable()){var t=this.gridOptionsService.getCallback("isServerSideGroupOpenByDefault");if(t)t({data:e.data,rowNode:e})&&window.setTimeout((function(){return e.setExpanded(!0)}),0)}},O([t.Autowired("valueService")],o.prototype,"valueService",void 0),O([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),O([t.Autowired("ssrmNodeManager")],o.prototype,"nodeManager",void 0),O([t.Autowired("beans")],o.prototype,"beans",void 0),O([t.PostConstruct],o.prototype,"postConstruct",null),o=O([t.Bean("ssrmBlockUtils")],o)}(t.BeanStub),_=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},D=function(){function e(){this.rowNodes={}}return e.prototype.addRowNode=function(e){var t=e.id;this.rowNodes[t]&&(console.warn("AG Grid: Duplicate node id "+e.id+". Row ID's are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values."),console.warn("first instance",this.rowNodes[t].data),console.warn("second instance",e.data)),this.rowNodes[t]=e},e.prototype.removeNode=function(e){var t=e.id;this.rowNodes[t]&&(this.rowNodes[t]=void 0)},e.prototype.clear=function(){this.rowNodes={}},_([t.PreDestroy],e.prototype,"clear",null),e=_([t.Bean("ssrmNodeManager")],e)}(),P=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),T=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},L=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.asyncTransactions=[],t}return P(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")},o.prototype.applyTransactionAsync=function(e,t){null==this.asyncTransactionsTimeout&&this.scheduleExecuteAsync(),this.asyncTransactions.push({transaction:e,callback:t})},o.prototype.scheduleExecuteAsync=function(){var e=this,t=this.gridOptionsService.getAsyncTransactionWaitMillis();this.asyncTransactionsTimeout=window.setTimeout((function(){e.executeAsyncTransactions()}),t)},o.prototype.executeAsyncTransactions=function(){var e=this;if(this.asyncTransactions){var o=[],r=[],n=[],i=!1;if(this.asyncTransactions.forEach((function(s){var a;e.serverSideRowModel.executeOnStore(s.transaction.route,(function(e){a=e.applyTransaction(s.transaction)})),null==a&&(a={status:t.ServerSideTransactionResultStatus.StoreNotFound}),r.push(a),a.status==t.ServerSideTransactionResultStatus.StoreLoading?n.push(s):(s.callback&&o.push((function(){return s.callback(a)})),a.status===t.ServerSideTransactionResultStatus.Applied&&(i=!0))})),o.length>0&&window.setTimeout((function(){o.forEach((function(e){return e()}))}),0),this.asyncTransactionsTimeout=void 0,this.asyncTransactions=n,i&&(this.valueCache.onDataChanged(),this.eventService.dispatchEvent({type:t.Events.EVENT_STORE_UPDATED})),r.length>0){var s={type:t.Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:r};this.eventService.dispatchEvent(s)}}},o.prototype.flushAsyncTransactions=function(){null!=this.asyncTransactionsTimeout&&clearTimeout(this.asyncTransactionsTimeout),this.executeAsyncTransactions()},o.prototype.applyTransaction=function(e){var o,r=this;if(this.serverSideRowModel.executeOnStore(e.route,(function(t){o=t.applyTransaction(e)})),o){if(this.valueCache.onDataChanged(),o.remove){var n=o.remove.map((function(e){return e.id}));this.selectionService.deleteSelectionStateFromParent(e.route||[],n)}return this.eventService.dispatchEvent({type:t.Events.EVENT_STORE_UPDATED}),o.update&&o.update.length&&setTimeout((function(){r.rowRenderer.refreshFullWidthRows(o.update)}),0),o}return{status:t.ServerSideTransactionResultStatus.StoreNotFound}},T([t.Autowired("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),T([t.Autowired("valueCache")],o.prototype,"valueCache",void 0),T([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),T([t.Autowired("rowRenderer")],o.prototype,"rowRenderer",void 0),T([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),T([t.PostConstruct],o.prototype,"postConstruct",null),o=T([t.Bean("ssrmTransactionManager")],o)}(t.BeanStub),k=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),G=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},B=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return k(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,t.Events.EVENT_ROW_GROUP_OPENED,this.onRowGroupOpened.bind(this))},o.prototype.onRowGroupOpened=function(e){var o=e.node;if(o.expanded){if(o.master)this.createDetailNode(o);else if(t._.missing(o.childStore)){var r=this.serverSideRowModel.getParams();o.childStore=this.createBean(this.storeFactory.createStore(r,o))}}else this.gridOptionsService.is("purgeClosedRowNodes")&&t._.exists(o.childStore)&&(o.childStore=this.destroyBean(o.childStore));var n={type:t.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(n)},o.prototype.createDetailNode=function(e){if(t._.exists(e.detailNode))return e.detailNode;var o=new t.RowNode(this.beans);o.detail=!0,o.selectable=!1,o.parent=e,t._.exists(e.id)&&(o.id="detail_"+e.id),o.data=e.data,o.level=e.level+1;var r=this.gridOptionsService.getRowHeightForNode(o).height;return o.rowHeight=r||200,e.detailNode=o,o},G([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),G([t.Autowired("ssrmStoreFactory")],o.prototype,"storeFactory",void 0),G([t.Autowired("beans")],o.prototype,"beans",void 0),G([t.PostConstruct],o.prototype,"postConstruct",null),o=G([t.Bean("ssrmExpandListener")],o)}(t.BeanStub),U=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),F=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},j=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return U(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,t.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this))},o.prototype.extractSortModel=function(){var e=this.sortController.getSortModel();return this.gridOptionsService.isTreeData()||(this.replaceAutoGroupColumnWithActualRowGroupColumns(e),this.removeMultiColumnPrefixOnColumnIds(e)),e},o.prototype.removeMultiColumnPrefixOnColumnIds=function(e){if(this.gridOptionsService.isGroupMultiAutoColumn())for(var o=t.GROUP_AUTO_COLUMN_ID+"-",r=0;r<e.length;++r)e[r].colId.indexOf(o)>-1&&(e[r].colId=e[r].colId.substr(o.length))},o.prototype.replaceAutoGroupColumnWithActualRowGroupColumns=function(e){var o=e.find((function(e){return e.colId==t.GROUP_AUTO_COLUMN_ID}));if(o){var r=e.indexOf(o);t._.removeFromArray(e,o);var n=this.columnModel.getRowGroupColumns().filter((function(t){return 0==e.filter((function(e){return e.colId===t.getColId()})).length})).map((function(e){return{colId:e.getId(),sort:o.sort}}));t._.insertArrayIntoArray(e,n,r)}},o.prototype.onSortChanged=function(){var e=this.serverSideRowModel.getParams();if(e){var t=this.extractSortModel(),o=e.sortModel,r=this.findChangedColumnsInSort(t,o),n={valueColChanged:this.listenerUtils.isSortingWithValueColumn(r),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(r),changedColumns:r};this.serverSideRowModel.refreshAfterSort(t,n)}},o.prototype.findChangedColumnsInSort=function(e,t){var o=[];[e,t].forEach((function(e){if(e){var t=e.map((function(e){return e.colId}));o=o.concat(t)}}));return o.filter((function(o){var r=t.find((function(e){return e.colId===o})),n=e.find((function(e){return e.colId===o}));return function(e,t){return(e?e.sort:null)!==(t?t.sort:null)}(r,n)||function(o,r){return(o?t.indexOf(o):-1)!==(r?e.indexOf(r):-1)}(r,n)}))},F([t.Autowired("sortController")],o.prototype,"sortController",void 0),F([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),F([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),F([t.Autowired("ssrmListenerUtils")],o.prototype,"listenerUtils",void 0),F([t.PostConstruct],o.prototype,"postConstruct",null),o=F([t.Bean("ssrmSortService")],o)}(t.BeanStub),V=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),H=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},K=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.postConstruct=function(){this.gridOptionsService.isRowModelType("serverSide")&&this.addManagedListener(this.eventService,t.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this))},o.prototype.onFilterChanged=function(){var e=this.serverSideRowModel.getParams();if(e){var t=this.filterManager.getFilterModel(),o=e?e.filterModel:{},r=this.findChangedColumns(t,o),n={valueColChanged:this.listenerUtils.isSortingWithValueColumn(r),secondaryColChanged:this.listenerUtils.isSortingWithSecondaryColumn(r),changedColumns:r};this.serverSideRowModel.refreshAfterFilter(t,n)}},o.prototype.findChangedColumns=function(e,t){var o={};Object.keys(e).forEach((function(e){return o[e]=!0})),Object.keys(t).forEach((function(e){return o[e]=!0}));var r=[];return Object.keys(o).forEach((function(o){JSON.stringify(e[o])!=JSON.stringify(t[o])&&r.push(o)})),r},H([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),H([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),H([t.Autowired("ssrmListenerUtils")],o.prototype,"listenerUtils",void 0),H([t.PostConstruct],o.prototype,"postConstruct",null),o=H([t.Bean("ssrmFilterListener")],o)}(t.BeanStub),q=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},z=function(){function e(){}return e.prototype.createStore=function(e,t){var o=this.getStoreParams(e,t);return new(o.suppressInfiniteScroll?i:R)(e,o,t)},e.prototype.getStoreParams=function(e,t){var o=this.getLevelSpecificParams(t),r=this.isInfiniteScroll(o);return{suppressInfiniteScroll:!r,cacheBlockSize:this.getBlockSize(r,o),maxBlocksInCache:this.getMaxBlocksInCache(r,e,o)}},e.prototype.getMaxBlocksInCache=function(e,o,r){if(e){var n=r&&null!=r.maxBlocksInCache?r.maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache");if(null!=n&&n>=0)if(o.dynamicRowHeight){t._.doOnce((function(){return console.warn("AG Grid: Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.")}),"storeFactory.maxBlocksInCache.dynamicRowHeight")}else{if(!this.columnModel.isAutoRowHeightActive())return n;t._.doOnce((function(){return console.warn("AG Grid: Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.")}),"storeFactory.maxBlocksInCache.autoRowHeightActive")}}},e.prototype.getBlockSize=function(e,t){if(e){var o=t&&null!=t.cacheBlockSize?t.cacheBlockSize:this.gridOptionsService.getNum("cacheBlockSize");return null!=o&&o>0?o:100}},e.prototype.getLevelSpecificParams=function(e){var t=this.gridOptionsService.getCallback("getServerSideGroupLevelParams");if(t){var o=t({level:e.level+1,parentRowNode:e.level>=0?e:void 0,rowGroupColumns:this.columnModel.getRowGroupColumns(),pivotColumns:this.columnModel.getPivotColumns(),pivotMode:this.columnModel.isPivotMode()});return null!=o.storeType&&(o.suppressInfiniteScroll="partial"!==o.storeType),o}},e.prototype.isInfiniteScroll=function(e){return!(e&&null!=e.suppressInfiniteScroll?e.suppressInfiniteScroll:this.isSuppressServerSideInfiniteScroll())},e.prototype.isSuppressServerSideInfiniteScroll=function(){return this.gridOptionsService.is("suppressServerSideInfiniteScroll")},q([t.Autowired("gridOptionsService")],e.prototype,"gridOptionsService",void 0),q([t.Autowired("columnModel")],e.prototype,"columnModel",void 0),e=q([t.Bean("ssrmStoreFactory")],e)}(),W=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},J=function(){function e(){}return e.prototype.isSortingWithValueColumn=function(e){for(var t=this.columnModel.getValueColumns().map((function(e){return e.getColId()})),o=0;o<e.length;o++)if(t.indexOf(e[o])>-1)return!0;return!1},e.prototype.isSortingWithSecondaryColumn=function(e){if(!this.columnModel.getSecondaryColumns())return!1;for(var t=this.columnModel.getSecondaryColumns().map((function(e){return e.getColId()})),o=0;o<e.length;o++)if(t.indexOf(e[o])>-1)return!0;return!1},W([t.Autowired("columnModel")],e.prototype,"columnModel",void 0),e=W([t.Bean("ssrmListenerUtils")],e)}(),Z=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),Y=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Q=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},X=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Q(arguments[t]));return e},$=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedState={selectAll:!1,toggledNodes:new Set},t.lastSelected=null,t.selectAllUsed=!1,t.selectedNodes={},t}return Z(o,e),o.prototype.init=function(){var e=this;this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(t){e.rowSelection=t.currentValue}))},o.prototype.getSelectedState=function(){return{selectAll:this.selectedState.selectAll,toggledNodes:X(this.selectedState.toggledNodes)}},o.prototype.setSelectedState=function(e){var t={selectAll:!1,toggledNodes:new Set};"object"==typeof e?"selectAll"in e&&"boolean"==typeof e.selectAll?(t.selectAll=e.selectAll,"toggledNodes"in e&&Array.isArray(e.toggledNodes)?(e.toggledNodes.forEach((function(e){"string"==typeof e?t.toggledNodes.add(e):console.warn("AG Grid: Provided ids must be of string type. Invalid id provided: "+e)})),this.selectedState=t):console.error("AG Grid: `toggledNodes` must be an array of string ids.")):console.error("AG Grid: Select all status should be of boolean type."):console.error("AG Grid: The provided selection state should be an object.")},o.prototype.deleteSelectionStateFromParent=function(e,t){var o=this;if(0===this.selectedState.toggledNodes.size)return!1;var r=!1;return t.forEach((function(e){o.selectedState.toggledNodes.delete(e)&&(r=!0)})),r},o.prototype.setNodeSelected=function(e){var t,o=this,r=e.clearSelection&&e.newValue&&!e.rangeSelect;if("multiple"!==this.rowSelection||r)return e.newValue?(this.selectedNodes=((t={})[e.node.id]=e.node,t),this.selectedState={selectAll:!1,toggledNodes:new Set([e.node.id])}):(this.selectedNodes={},this.selectedState={selectAll:!1,toggledNodes:new Set}),this.lastSelected=e.node.id,1;var n=function(t){e.newValue?o.selectedNodes[t.id]=t:delete o.selectedNodes[t.id],e.newValue===o.selectedState.selectAll?o.selectedState.toggledNodes.delete(t.id):o.selectedState.toggledNodes.add(t.id)};if(e.rangeSelect&&this.lastSelected){var i=this.rowModel.getRowNode(this.lastSelected);return this.rowModel.getNodesInRangeForSelection(e.node,null!=i?i:null).forEach(n),this.lastSelected=e.node.id,1}return n(e.node),this.lastSelected=e.node.id,1},o.prototype.processNewRow=function(e){this.selectedNodes[e.id]&&(this.selectedNodes[e.id]=e)},o.prototype.isNodeSelected=function(e){var t=this.selectedState.toggledNodes.has(e.id);return this.selectedState.selectAll?!t:t},o.prototype.getSelectedNodes=function(){return this.selectAllUsed&&console.warn("AG Grid: getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model.\n                Use `api.getServerSideSelectionState()` instead."),Object.values(this.selectedNodes)},o.prototype.getSelectedRows=function(){return this.getSelectedNodes().map((function(e){return e.data}))},o.prototype.getSelectionCount=function(){return this.selectedState.selectAll?-1:this.selectedState.toggledNodes.size},o.prototype.clearOtherNodes=function(e,o){var r=this.selectedState.selectAll?1:this.selectedState.toggledNodes.size-1;this.selectedState={selectAll:!1,toggledNodes:new Set([e.id])},this.rowModel.forEachNode((function(t){t!==e&&t.selectThisNode(!1,void 0,o)}));var n={type:t.Events.EVENT_SELECTION_CHANGED,source:o};return this.eventService.dispatchEvent(n),r},o.prototype.isEmpty=function(){var e;return!this.selectedState.selectAll&&!(null===(e=this.selectedState.toggledNodes)||void 0===e?void 0:e.size)},o.prototype.selectAllRowNodes=function(e){this.selectedState={selectAll:!0,toggledNodes:new Set},this.selectedNodes={},this.selectAllUsed=!0},o.prototype.deselectAllRowNodes=function(e){this.selectedState={selectAll:!1,toggledNodes:new Set},this.selectedNodes={}},o.prototype.getSelectAllState=function(e,t){return this.selectedState.selectAll?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null},Y([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),Y([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),ee=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),te=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},oe=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s},re=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(oe(arguments[t]));return e},ne=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedState={selectAllChildren:!1,toggledNodes:new Map},t.lastSelected=null,t}return ee(o,e),o.prototype.init=function(){var e=this;this.addManagedListener(this.eventService,t.Events.EVENT_MODEL_UPDATED,(function(){return e.removeRedundantState()})),this.addManagedListener(this.eventService,t.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.selectionService.reset()}))},o.prototype.getSelectedState=function(){var e=this,t=function(o,r,n){var i={nodeId:n};if(r<=e.columnModel.getRowGroupColumns().length&&(i.selectAllChildren=o.selectAllChildren),o.toggledNodes.size){var s=[];o.toggledNodes.forEach((function(e,o){var n=t(e,r+1,o);s.push(n)})),i.toggledNodes=s}return i};return t(this.selectedState,0)},o.prototype.setSelectedState=function(e){var t=function(e,o){var r,n;if("object"!=typeof e)throw new Error("AG Grid: Each provided state object must be an object.");if("selectAllChildren"in e&&"boolean"!=typeof e.selectAllChildren)throw new Error("AG Grid: `selectAllChildren` must be a boolean value or undefined.");if("toggledNodes"in e){if(!Array.isArray(e.toggledNodes))throw new Error("AG Grid: `toggledNodes` must be an array.");if(!e.toggledNodes.every((function(e){return"object"==typeof e&&"nodeId"in e&&"string"==typeof e.nodeId})))throw new Error("AG Grid: Every `toggledNode` requires an associated string id.")}var i=null!==(r=e.selectAllChildren)&&void 0!==r?r:!o,s=null===(n=e.toggledNodes)||void 0===n?void 0:n.map((function(e){return[e.nodeId,t(e,i)]}));if(null==s?void 0:s.some((function(e){var t=oe(e,2);t[0];var o=t[1];return i===o.selectAllChildren&&0===o.toggledNodes.size})))throw new Error("\n                    AG Grid: AG Grid: Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule.\n                    Please rebuild the selection state and reapply it.\n                ");return{selectAllChildren:i,toggledNodes:new Map(s)}};try{this.selectedState=t(e,!!e.selectAllChildren)}catch(e){console.error(e.message)}},o.prototype.deleteSelectionStateFromParent=function(e,t){for(var o=this.selectedState,r=re(e);o&&r.length;)o=o.toggledNodes.get(r.pop());if(!o)return!1;var n=!1;return t.forEach((function(e){(null==o?void 0:o.toggledNodes.delete(e))&&(n=!0)})),n&&this.removeRedundantState(),n},o.prototype.setNodeSelected=function(e){var t=this;if(e.rangeSelect){var o=this.rowModel.getNodesInRangeForSelection(e.node,this.lastSelected).map(this.getRouteToNode).sort((function(e,t){return t.length-e.length})),r=new Set;return o.forEach((function(o){r.has(o[o.length-1])||(o.forEach((function(e){return r.add(e)})),t.recursivelySelectNode(o,t.selectedState,e))})),this.removeRedundantState(),this.lastSelected=e.node,1}var n=this.getRouteToNode(e.node);return this.recursivelySelectNode(n,this.selectedState,e),this.removeRedundantState(),this.lastSelected=e.node,1},o.prototype.isNodeSelected=function(e){var t=this.getRouteToNode(e);return this.isNodePathSelected(t,this.selectedState)},o.prototype.isNodePathSelected=function(e,t){var o=oe(e),r=o[0],n=o.slice(1);if(0===n.length){var i=t.toggledNodes.has(r.id);if(r.hasChildren()){var s=t.toggledNodes.get(r.id);if(s&&s.toggledNodes.size)return}return t.selectAllChildren?!i:i}if(t.toggledNodes.has(r.id)){var a=t.toggledNodes.get(r.id);if(a)return this.isNodePathSelected(n,a)}return!!t.selectAllChildren},o.prototype.getRouteToNode=function(e){for(var t=[],o=e;o.parent;)t.push(o),o=o.parent;return t.reverse()},o.prototype.removeRedundantState=function(){var e=this;if(!this.filterManager.isAnyFilterPresent()){var t=function(o,r,n){void 0===o&&(o=e.selectedState),void 0===r&&(r=e.serverSideRowModel.getRootStore());var i=!0,s=!0;return o.toggledNodes.forEach((function(r,n){var a=e.rowModel.getRowNode(n);a||(i=!1);var d=null==a?void 0:a.childStore;d?(t(r,d,a)&&o.selectAllChildren===r.selectAllChildren&&o.toggledNodes.delete(n),r.toggledNodes.size>0&&(s=!1)):r.toggledNodes.size>0&&(s=!1)})),!(!r||!r.isLastRowIndexKnown()||r.getRowCount()!==o.toggledNodes.size)&&(!(!s||!i)&&(o.toggledNodes.clear(),o.selectAllChildren=!o.selectAllChildren,n&&(null==n?void 0:n.isSelected())!==o.selectAllChildren&&n.selectThisNode(o.selectAllChildren,void 0,"api"),!0))};t()}},o.prototype.recursivelySelectNode=function(e,t,o){var r=oe(e),n=r[0],i=r.slice(1);if(n)if(!i.length){if(t.selectAllChildren===o.newValue)return void t.toggledNodes.delete(n.id);var s={selectAllChildren:o.newValue,toggledNodes:new Map};t.toggledNodes.set(n.id,s)}else{var a=t.toggledNodes.has(n.id),d=a?t.toggledNodes.get(n.id):{selectAllChildren:t.selectAllChildren,toggledNodes:new Map};a||t.toggledNodes.set(n.id,d),this.recursivelySelectNode(i,d,o),t.selectAllChildren===d.selectAllChildren&&0===d.toggledNodes.size&&t.toggledNodes.delete(n.id)}},o.prototype.getSelectedNodes=function(){console.warn("AG Grid: `getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model.\n            Use `api.getServerSideSelectionState()` instead.");var e=[];return this.rowModel.forEachNode((function(t){t.isSelected()&&e.push(t)})),e},o.prototype.processNewRow=function(e){},o.prototype.getSelectedRows=function(){return this.getSelectedNodes().map((function(e){return e.data}))},o.prototype.getSelectionCount=function(){return-1},o.prototype.isEmpty=function(){var e;return!this.selectedState.selectAllChildren&&!(null===(e=this.selectedState.toggledNodes)||void 0===e?void 0:e.size)},o.prototype.selectAllRowNodes=function(e){this.selectedState={selectAllChildren:!0,toggledNodes:new Map}},o.prototype.deselectAllRowNodes=function(e){this.selectedState={selectAllChildren:!1,toggledNodes:new Map}},o.prototype.getSelectAllState=function(e,t){return this.selectedState.selectAllChildren?!(this.selectedState.toggledNodes.size>0)||null:this.selectedState.toggledNodes.size>0&&null},te([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),te([t.Autowired("columnModel")],o.prototype,"columnModel",void 0),te([t.Autowired("filterManager")],o.prototype,"filterManager",void 0),te([t.Autowired("rowModel")],o.prototype,"serverSideRowModel",void 0),te([t.Autowired("selectionService")],o.prototype,"selectionService",void 0),te([t.PostConstruct],o.prototype,"init",null),o}(t.BeanStub),ie=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),se=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},ae=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return ie(o,e),o.prototype.init=function(){var e=this,o=this.gridOptionsService.is("groupSelectsChildren");this.addManagedPropertyListener("groupSelectsChildren",(function(o){e.destroyBean(e.selectionStrategy);var r=o.currentValue?ne:$;e.selectionStrategy=e.createManagedBean(new r),e.shotgunResetNodeSelectionState();var n={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};e.eventService.dispatchEvent(n)}));var r=o?ne:$;this.selectionStrategy=this.createManagedBean(new r)},o.prototype.getServerSideSelectionState=function(){return this.selectionStrategy.getSelectedState()},o.prototype.setServerSideSelectionState=function(e){this.selectionStrategy.setSelectedState(e),this.shotgunResetNodeSelectionState();var o={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(o)},o.prototype.setNodeSelected=function(e){var o=this.selectionStrategy.setNodeSelected(e);this.shotgunResetNodeSelectionState(e.source);var r={type:t.Events.EVENT_SELECTION_CHANGED,source:e.source};return this.eventService.dispatchEvent(r),o},o.prototype.deleteSelectionStateFromParent=function(e,o){if(this.selectionStrategy.deleteSelectionStateFromParent(e,o)){this.shotgunResetNodeSelectionState();var r={type:t.Events.EVENT_SELECTION_CHANGED,source:"api"};this.eventService.dispatchEvent(r)}},o.prototype.shotgunResetNodeSelectionState=function(e){var t=this;this.rowModel.forEachNode((function(o){if(!o.stub){var r=t.selectionStrategy.isNodeSelected(o);r!==o.isSelected()&&o.selectThisNode(r,void 0,e)}}))},o.prototype.getSelectedNodes=function(){return this.selectionStrategy.getSelectedNodes()},o.prototype.getSelectedRows=function(){return this.selectionStrategy.getSelectedRows()},o.prototype.getSelectionCount=function(){return this.selectionStrategy.getSelectionCount()},o.prototype.syncInRowNode=function(e,t){this.selectionStrategy.processNewRow(e);var o=this.selectionStrategy.isNodeSelected(e);e.setSelectedInitialValue(o)},o.prototype.reset=function(){this.selectionStrategy.deselectAllRowNodes({source:"api"})},o.prototype.isEmpty=function(){return this.selectionStrategy.isEmpty()},o.prototype.selectAllRowNodes=function(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.selectAllRowNodes(e),this.rowModel.forEachNode((function(t){t.stub||t.selectThisNode(!0,void 0,e.source)}));var o={type:t.Events.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(o)},o.prototype.deselectAllRowNodes=function(e){(e.justCurrentPage||e.justFiltered)&&console.warn("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'"),this.selectionStrategy.deselectAllRowNodes(e),this.rowModel.forEachNode((function(t){t.stub||t.selectThisNode(!1,void 0,e.source)}));var o={type:t.Events.EVENT_SELECTION_CHANGED,source:e.source};this.eventService.dispatchEvent(o)},o.prototype.getSelectAllState=function(e,t){return this.selectionStrategy.getSelectAllState(e,t)},o.prototype.updateGroupsFromChildrenSelections=function(e,t){return!1},o.prototype.getBestCostNodeSelection=function(){console.warn("AG Grid: calling gridApi.getBestCostNodeSelection() is only possible when using rowModelType=`clientSide`.")},o.prototype.filterFromSelection=function(){},se([t.Autowired("rowModel")],o.prototype,"rowModel",void 0),se([t.PostConstruct],o.prototype,"init",null),o=se([t.Bean("selectionService")],o)}(t.BeanStub),de={version:"29.2.0",moduleName:t.ModuleNames.ServerSideRowModelModule,rowModel:"serverSide",beans:[I,B,j,x,M,D,L,K,z,J,ae],dependantModules:[o.EnterpriseCoreModule]};exports.ServerSideRowModelModule=de;