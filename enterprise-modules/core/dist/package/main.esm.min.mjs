import{ModuleNames as Se}from"@ag-grid-community/core";import{BeanStub as Te}from"@ag-grid-community/core";import{_missingOrEmpty as B}from"@ag-grid-community/core";var xe=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(e,t){let s=e[0],i=e[1],n=e[2],a=e[3];s=this.ff(s,i,n,a,t[0],7,-680876936),a=this.ff(a,s,i,n,t[1],12,-389564586),n=this.ff(n,a,s,i,t[2],17,606105819),i=this.ff(i,n,a,s,t[3],22,-1044525330),s=this.ff(s,i,n,a,t[4],7,-176418897),a=this.ff(a,s,i,n,t[5],12,1200080426),n=this.ff(n,a,s,i,t[6],17,-1473231341),i=this.ff(i,n,a,s,t[7],22,-45705983),s=this.ff(s,i,n,a,t[8],7,1770035416),a=this.ff(a,s,i,n,t[9],12,-1958414417),n=this.ff(n,a,s,i,t[10],17,-42063),i=this.ff(i,n,a,s,t[11],22,-1990404162),s=this.ff(s,i,n,a,t[12],7,1804603682),a=this.ff(a,s,i,n,t[13],12,-40341101),n=this.ff(n,a,s,i,t[14],17,-1502002290),i=this.ff(i,n,a,s,t[15],22,1236535329),s=this.gg(s,i,n,a,t[1],5,-165796510),a=this.gg(a,s,i,n,t[6],9,-1069501632),n=this.gg(n,a,s,i,t[11],14,643717713),i=this.gg(i,n,a,s,t[0],20,-373897302),s=this.gg(s,i,n,a,t[5],5,-701558691),a=this.gg(a,s,i,n,t[10],9,38016083),n=this.gg(n,a,s,i,t[15],14,-660478335),i=this.gg(i,n,a,s,t[4],20,-405537848),s=this.gg(s,i,n,a,t[9],5,568446438),a=this.gg(a,s,i,n,t[14],9,-1019803690),n=this.gg(n,a,s,i,t[3],14,-187363961),i=this.gg(i,n,a,s,t[8],20,1163531501),s=this.gg(s,i,n,a,t[13],5,-1444681467),a=this.gg(a,s,i,n,t[2],9,-51403784),n=this.gg(n,a,s,i,t[7],14,1735328473),i=this.gg(i,n,a,s,t[12],20,-1926607734),s=this.hh(s,i,n,a,t[5],4,-378558),a=this.hh(a,s,i,n,t[8],11,-2022574463),n=this.hh(n,a,s,i,t[11],16,1839030562),i=this.hh(i,n,a,s,t[14],23,-35309556),s=this.hh(s,i,n,a,t[1],4,-1530992060),a=this.hh(a,s,i,n,t[4],11,1272893353),n=this.hh(n,a,s,i,t[7],16,-155497632),i=this.hh(i,n,a,s,t[10],23,-1094730640),s=this.hh(s,i,n,a,t[13],4,681279174),a=this.hh(a,s,i,n,t[0],11,-358537222),n=this.hh(n,a,s,i,t[3],16,-722521979),i=this.hh(i,n,a,s,t[6],23,76029189),s=this.hh(s,i,n,a,t[9],4,-640364487),a=this.hh(a,s,i,n,t[12],11,-421815835),n=this.hh(n,a,s,i,t[15],16,530742520),i=this.hh(i,n,a,s,t[2],23,-995338651),s=this.ii(s,i,n,a,t[0],6,-198630844),a=this.ii(a,s,i,n,t[7],10,1126891415),n=this.ii(n,a,s,i,t[14],15,-1416354905),i=this.ii(i,n,a,s,t[5],21,-57434055),s=this.ii(s,i,n,a,t[12],6,1700485571),a=this.ii(a,s,i,n,t[3],10,-1894986606),n=this.ii(n,a,s,i,t[10],15,-1051523),i=this.ii(i,n,a,s,t[1],21,-2054922799),s=this.ii(s,i,n,a,t[8],6,1873313359),a=this.ii(a,s,i,n,t[15],10,-30611744),n=this.ii(n,a,s,i,t[6],15,-1560198380),i=this.ii(i,n,a,s,t[13],21,1309151649),s=this.ii(s,i,n,a,t[4],6,-145523070),a=this.ii(a,s,i,n,t[11],10,-1120210379),n=this.ii(n,a,s,i,t[2],15,718787259),i=this.ii(i,n,a,s,t[9],21,-343485551),e[0]=this.add32(s,e[0]),e[1]=this.add32(i,e[1]),e[2]=this.add32(n,e[2]),e[3]=this.add32(a,e[3])}cmn(e,t,s,i,n,a){return t=this.add32(this.add32(t,e),this.add32(i,a)),this.add32(t<<n|t>>>32-n,s)}ff(e,t,s,i,n,a,o){return this.cmn(t&s|~t&i,e,t,n,a,o)}gg(e,t,s,i,n,a,o){return this.cmn(t&i|s&~i,e,t,n,a,o)}hh(e,t,s,i,n,a,o){return this.cmn(t^s^i,e,t,n,a,o)}ii(e,t,s,i,n,a,o){return this.cmn(s^(t|~i),e,t,n,a,o)}md51(e){const t=e.length,s=[1732584193,-271733879,-1732584194,271733878];let i;for(i=64;i<=e.length;i+=64)this.md5cycle(s,this.md5blk(e.substring(i-64,i)));e=e.substring(i-64);const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<e.length;i++)n[i>>2]|=e.charCodeAt(i)<<(i%4<<3);if(n[i>>2]|=128<<(i%4<<3),i>55)for(this.md5cycle(s,n),i=0;i<16;i++)n[i]=0;return n[14]=t*8,this.md5cycle(s,n),s}md5blk(e){const t=[];for(let s=0;s<64;s+=4)t[s>>2]=e.charCodeAt(s)+(e.charCodeAt(s+1)<<8)+(e.charCodeAt(s+2)<<16)+(e.charCodeAt(s+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let s="",i=0;for(;i<4;i++)s+=t[e>>i*8+4&15]+t[e>>i*8&15];return s}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const s=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(s>>16)<<16|s&65535}},L={"01":"GRID","02":"CHARTS","0102":"BOTH"},W=class g{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new xe,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(g.licenseKey),s=`AG Grid ${t.currentLicenseType==="BOTH"?"and AG Charts ":""}Enterprise`,i=t.suppliedLicenseType===void 0?"":`AG ${t.suppliedLicenseType==="BOTH"?"Grid and AG Charts":t.suppliedLicenseType==="GRID"?"Grid":"Charts"} Enterprise`;if(t.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(s);else if(t.expired){const n=g.getGridReleaseDate(),a=g.formatDate(n);this.outputExpiredKey(t.expiry,a,s,i)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,s,i):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,s,i)}static extractExpiry(t){const s=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(g.decode(s),10))}static extractLicenseComponents(t){let s=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(s=s.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const i=s.length-32,n=s.substring(i),a=s.substring(0,i),[o,r,l]=g.extractBracketedInformation(s);return{md5:n,license:a,version:o,isTrial:r,type:l}}getLicenseDetails(t){const s=g.chartsLicenseManager?"BOTH":"GRID";if(B(t))return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:s};const i=g.getGridReleaseDate(),{md5:n,license:a,version:o,isTrial:r,type:l}=g.extractLicenseComponents(t);let h=n===this.md5.md5(a)&&t.indexOf("For_Trialing_ag-Grid_Only")===-1,c,d,u=null,f=!1,C;function b(){c=u<new Date,d=void 0}if(h&&(u=g.extractExpiry(a),h=!isNaN(u.getTime()),h))switch(d=i>u,o){case"legacy":case"2":{r&&b();break}case"3":B(l)?h=!1:(C=l,l!==L["01"]&&l!==L["0102"]||s==="BOTH"&&C!=="BOTH"?(h=!1,f=!0):r&&b())}return h?{licenseKey:t,valid:h,expiry:g.formatDate(u),expired:d,version:o,isTrial:r,trialExpired:c,incorrectLicenseType:f,currentLicenseType:s,suppliedLicenseType:C}:{licenseKey:t,valid:h,incorrectLicenseType:f,currentLicenseType:s,suppliedLicenseType:C}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!B(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){const s=(this.document.defaultView||window).location,{hostname:i=""}=s;return i}isForceWatermark(){const s=(this.document.defaultView||window).location,{pathname:i}=s;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){return this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)!==null}isLocalhost(){return this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)!==null}static formatDate(t){const s=["January","February","March","April","May","June","July","August","September","October","November","December"],i=t.getDate(),n=t.getMonth(),a=t.getFullYear();return i+" "+s[n]+" "+a}static getGridReleaseDate(){return new Date(parseInt(g.decode(g.RELEASE_INFORMATION),10))}static decode(t){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i="",n,a,o,r,l,h,c,d=0;const u=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)r=s.indexOf(u.charAt(d++)),l=s.indexOf(u.charAt(d++)),h=s.indexOf(u.charAt(d++)),c=s.indexOf(u.charAt(d++)),n=r<<2|l>>4,a=(l&15)<<4|h>>2,o=(h&3)<<6|c,i=i+String.fromCharCode(n),h!=64&&(i=i+String.fromCharCode(a)),c!=64&&(i=i+String.fromCharCode(o));return i=g.utf8_decode(i),i}static utf8_decode(t){t=t.replace(/rn/g,"n");let s="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);n<128?s+=String.fromCharCode(n):n>127&&n<2048?(s+=String.fromCharCode(n>>6|192),s+=String.fromCharCode(n&63|128)):(s+=String.fromCharCode(n>>12|224),s+=String.fromCharCode(n>>6&63|128),s+=String.fromCharCode(n&63|128))}return s}static setChartsLicenseManager(t){this.chartsLicenseManager=t}static setLicenseKey(t){this.licenseKey=t,this.chartsLicenseManager&&this.chartsLicenseManager.setLicenseKey(t,!0)}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];const s=t.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!s||s.length===0)return["legacy",!1,void 0];const i=s.filter(r=>r==="TRIAL").length===1,n=s.filter(r=>r.indexOf("v")===0)[0],a=n?n.replace("v",""):"legacy",o=L[s.filter(r=>L[r])[0]];return[a,i,o]}centerPadAndOutput(t){const s=this.totalMessageLength-t.length;console.error(t.padStart(s/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,s="*",i=""){console.error(t.padEnd(this.totalMessageLength-i.length,s)+i)}outputInvalidLicenseKey(t,s,i){t?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${i} only and does not cover you for ${s}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to obtain a combined license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid - please contact info@ag-grid.com to obtain a valid license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(t,s,i){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${s} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${i} expired on ${t}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(t){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${t} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(t,s,i,n){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${n} released before ${t}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${s}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="License Expired"}};W.RELEASE_INFORMATION="MTcxOTQzMTYzMDEwNw==";var A=W;import{Component as Le,RefPlaceholder as Ae}from"@ag-grid-community/core";var Ge=class extends Le{constructor(){super(`<div class="ag-watermark">
                <div data-ref="eLicenseTextRef" class="ag-watermark-text"></div>
            </div>`),this.eLicenseTextRef=Ae}wireBeans(e){this.licenseManager=e.licenseManager}postConstruct(){const e=this.shouldDisplayWatermark();this.setDisplayed(e),e&&(this.eLicenseTextRef.innerText=this.licenseManager.getWatermarkMessage(),window.setTimeout(()=>this.addCssClass("ag-opacity-zero"),0),window.setTimeout(()=>this.setDisplayed(!1),5e3))}shouldDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}},Re={selector:"AG-WATERMARK",component:Ge},K=class extends Te{constructor(){super(...arguments),this.beanName="licenseManager"}postConstruct(){this.validateLicense()}validateLicense(){this.licenseManager=new A(this.gos.getDocument()),this.licenseManager.validateLicense()}static getLicenseDetails(e){return new A(null).getLicenseDetails(e)}getWatermarkSelector(){return Re}isDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}getWatermarkMessage(){return this.licenseManager.getWatermarkMessage()}static setLicenseKey(e){A.setLicenseKey(e)}static setChartsLicenseManager(e){A.setChartsLicenseManager(e)}},Pe="32.0.0";import{Component as Me,_createIconNoSpan as $,_isNodeOrElement as Fe,_loadTemplate as G,_setAriaExpanded as Oe,_warnOnce as Be}from"@ag-grid-community/core";var U=class extends Me{constructor(){super(),this.setTemplate("<div></div>")}init(e){this.params=e,this.cssClassPrefix=this.params.cssClassPrefix??"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const e=G(`<span data-ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`),{checked:t,icon:s}=this.params;t?e.appendChild($("check",this.gos)):s&&(Fe(s)?e.appendChild(s):typeof s=="string"?e.innerHTML=s:Be("menu item icon must be DOM node or string")),this.getGui().appendChild(e)}addName(){const e=G(`<span data-ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(e)}addShortcut(){if(this.params.isCompact)return;const e=G(`<span data-ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(e)}addSubMenu(){const e=G(`<span data-ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),t=this.getGui();if(this.params.subMenu){const s=this.gos.get("enableRtl")?"smallLeft":"smallRight";Oe(t,!1),e.appendChild($(s,this.gos))}t.appendChild(e)}getClassName(e){return`${this.cssClassPrefix}-${e}`}destroy(){super.destroy()}},ke={version:Pe,moduleName:Se.EnterpriseCoreModule,beans:[K],userComponents:[{name:"agMenuItem",classImp:U}]};import{AgCheckboxSelector as Ne,AgToggleButton as He,Component as R,KeyCode as E,RefPlaceholder as w,_createIcon as j,_setAriaExpanded as Ve,_setDisplayed as I}from"@ag-grid-community/core";function _e(e){const t=e.cssIdentifier||"default",s=e.direction||"vertical";return`
        <div class="ag-group ag-${t}-group" role="presentation">
            <div data-ref="eToolbar" class="ag-group-toolbar ag-${t}-group-toolbar">
                <ag-checkbox data-ref="cbGroupEnabled"></ag-checkbox>
            </div>
            <div data-ref="eContainer" class="ag-group-container ag-group-container-${s} ag-${t}-group-container"></div>
        </div>
    `}var q=class extends R{constructor(e={}){super(_e(e),[Ne]),this.params=e,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1,this.eToolbar=w,this.cbGroupEnabled=w,this.eContainer=w;const{enabled:t,items:s,suppressEnabledCheckbox:i,expanded:n,suppressToggleExpandOnEnableChange:a,useToggle:o}=e;this.cssIdentifier=e.cssIdentifier||"default",this.enabled=t??!0,this.items=s||[],this.useToggle=o??!1,this.alignItems=e.alignItems||"center",this.expanded=n??!0,i!=null&&(this.suppressEnabledCheckbox=i),a!=null&&(this.suppressToggleExpandOnEnableChange=a)}postConstruct(){if(this.setupTitleBar(),this.items.length){const n=this.items;this.items=[],this.addItems(n)}const e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange:t,onExpandedChange:s,suppressOpenCloseIcons:i}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(i??!1),this.refreshChildDisplay(),I(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(n=>{this.setEnabled(n,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(n)}),t!=null&&this.onEnableChange(t),s!=null&&this.onExpandedChange(s)}refreshChildDisplay(){I(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),this.eTitleBar?.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(e){this.alignItems!==e&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=e;const t=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(t),this}toggleGroupExpand(e,t){if(this.eTitleBar?.isSuppressCollapse()&&!this.useToggle)e=!0,t=!0;else if(e=e??!this.expanded,this.expanded===e)return this;return this.expanded=e,this.refreshChildDisplay(),I(this.eContainer,e),t||this.dispatchLocalEvent({type:e?"expanded":"collapsed"}),this}addItems(e){e.forEach(t=>this.addItem(t))}prependItem(e){this.insertItem(e,!0)}addItem(e){this.insertItem(e,!1)}insertItem(e,t){const s=this.eContainer,i=e instanceof R?e.getGui():e;i.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),t?(s.insertAdjacentElement("afterbegin",i),this.items.unshift(i)):(s.appendChild(i),this.items.push(i))}hideItem(e,t){const s=this.items[t];I(s,!e)}getItemIndex(e){const t=e instanceof R?e.getGui():e;return this.items.indexOf(t)}setTitle(e){return this.eTitleBar?.setTitle(e),this}addTitleBarWidget(e){return this.eTitleBar?.addWidget(e),this}addCssClassToTitleBar(e){this.eTitleBar?.addCssClass(e)}dispatchEnableChangeEvent(e){const t={type:"enableChange",enabled:e};this.dispatchLocalEvent(t)}setEnabled(e,t,s){return this.enabled=e,this.refreshDisabledStyles(),s||this.toggleGroupExpand(e),t||(this.cbGroupEnabled.setValue(e),this.eToggle?.setValue(e)),this}isEnabled(){return this.enabled}onEnableChange(e){return this.addManagedListeners(this,{enableChange:t=>e(t.enabled)}),this}onExpandedChange(e){return this.addManagedListeners(this,{expanded:()=>e(!0),collapsed:()=>e(!1)}),this}hideEnabledCheckbox(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(e){return this.eTitleBar?.hideOpenCloseIcons(e),this}refreshDisabledStyles(){const e=!this.enabled;this.eContainer.classList.toggle("ag-disabled",e),this.eTitleBar?.refreshDisabledStyles(this.suppressEnabledCheckbox&&e),this.eContainer.classList.toggle("ag-disabled-group-container",e)}setupTitleBar(){const e=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",e.getGui())}createDefaultTitleBar(){const e=this.createManagedBean(new We(this.params));return this.eTitleBar=e,e.refreshOnExpand(this.expanded),this.addManagedListeners(e,{expandedChanged:t=>this.toggleGroupExpand(t.expanded)}),e}createToggleTitleBar(){const e=this.createManagedBean(new He({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:t=>{this.setEnabled(t,!0),this.dispatchEnableChangeEvent(t)}}));return e.addCssClass("ag-group-title-bar"),e.addCssClass(`ag-${this.params.cssIdentifier??"default"}-group-title-bar ag-unselectable`),this.eToggle=e,this.toggleGroupExpand(this.enabled),e}},k="ag-disabled-group-title-bar";function ze(e){const t=e.cssIdentifier??"default",s=e.suppressKeyboardNavigation?"presentation":"role";return`
        <div class="ag-group-title-bar ag-${t}-group-title-bar ag-unselectable" role="${s}">
            <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" data-ref="eGroupOpenedIcon" role="presentation"></span>
            <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" data-ref="eGroupClosedIcon" role="presentation"></span>
            <span data-ref="eTitle" class="ag-group-title ag-${t}-group-title"></span>
        </div>
    `}var We=class extends R{constructor(e={}){super(ze(e)),this.suppressOpenCloseIcons=!1,this.suppressKeyboardNavigation=!1,this.eGroupOpenedIcon=w,this.eGroupClosedIcon=w,this.eTitle=w;const{title:t,suppressOpenCloseIcons:s,suppressKeyboardNavigation:i}=e;t&&t.length>0&&(this.title=t),s!=null&&(this.suppressOpenCloseIcons=s),this.suppressKeyboardNavigation=i??!1}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(j("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild(j("columnSelectOpen",this.gos,null)),this.addManagedElementListeners(this.getGui(),{click:()=>this.dispatchExpandChanged(),keydown:e=>{switch(e.key){case E.ENTER:case E.SPACE:e.preventDefault(),this.dispatchExpandChanged();break;case E.RIGHT:case E.LEFT:e.preventDefault(),this.dispatchExpandChanged(e.key===E.RIGHT);break}}})}refreshOnExpand(e){this.refreshAriaStatus(e),this.refreshOpenCloseIcons(e)}refreshAriaStatus(e){this.suppressOpenCloseIcons||Ve(this.getGui(),e)}refreshOpenCloseIcons(e){const t=!this.suppressOpenCloseIcons;I(this.eGroupOpenedIcon,t&&e),I(this.eGroupClosedIcon,t&&!e)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(e){const t={type:"expandedChanged",expanded:e};this.dispatchLocalEvent(t)}setTitle(e){const t=this.getGui(),s=!!e&&e.length>0;e=s?e:void 0,this.eTitle.textContent=e??"",I(t,s),e!==this.title&&(this.title=e);const i=t.classList.contains(k);return this.refreshDisabledStyles(i),this}addWidget(e){return this.getGui().appendChild(e),this}hideOpenCloseIcons(e){return this.suppressOpenCloseIcons=e,e&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(e){const t=this.getGui();e?(t.classList.add(k),t.removeAttribute("tabindex")):(t.classList.remove(k),typeof this.title=="string"&&!this.suppressKeyboardNavigation?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex"))}},Ke={selector:"AG-GROUP-COMPONENT",component:q};import{AgInputTextFieldSelector as $e,AgPickerField as Ue,KeyCode as p,RefPlaceholder as Y,_bindCellRendererToHtmlElement as je,_clearElement as N,_createIconNoSpan as qe,_debounce as Ye,_escapeString as Ze,_exists as Z,_fuzzySuggestions as Je,_isEventFromPrintableCharacter as Qe,_isVisible as Xe,_setAriaActiveDescendant as et,_stopPropagationForAgGrid as tt}from"@ag-grid-community/core";import{Component as st,KeyCode as y,_clearElement as it,_setAriaPosInSet as nt,_setAriaSetSize as at}from"@ag-grid-community/core";import{RefPlaceholder as J}from"@ag-grid-community/core";import{Component as ot}from"@ag-grid-community/core";var rt=class extends ot{constructor(e){super(`
            <div class="ag-pill" role="option">
                <span class="ag-pill-text" data-ref="eText"></span>
                <span class="ag-button ag-pill-button" data-ref="eButton" role="presentation"></span>
            </div>
        `),this.config=e,this.eText=J,this.eButton=J}postConstruct(){const{config:e,eButton:t}=this,{onKeyDown:s,onButtonClick:i}=e;this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),this.addGuiEventListener("focus",()=>{this.eButton.focus()}),s&&this.addGuiEventListener("keydown",s),i&&this.addManagedElementListeners(t,{click:i})}toggleCloseButtonClass(e,t){this.eButton.classList.toggle(e,t)}setText(e){this.eText.textContent=e}getText(){return this.eText.textContent}},lt=class extends st{constructor(){super(`
            <div class="ag-pill-container" role="listbox"></div>
            `),this.pills=[]}wireBeans(e){this.focusService=e.focusService}init(e){this.params=e,this.refresh()}refresh(){this.clearPills();const{params:e,onPillKeyDown:t}=this,s=e.getValue();if(!Array.isArray(s))return;const i=s.length;for(let n=0;n<i;n++){const a=s[n],o=this.createBean(new rt({onButtonClick:()=>this.onPillButtonClick(o),onKeyDown:t.bind(this)})),r=o.getGui();nt(r,n+1),at(r,i),e.onPillMouseDown&&o.addGuiEventListener("mousedown",e.onPillMouseDown),e.announceItemFocus&&o.addGuiEventListener("focus",e.announceItemFocus),o.setText(a),o.toggleCloseButtonClass("ag-icon-cancel",!0),this.appendChild(r),this.pills.push(o)}}onNavigationKeyDown(e){const{key:t}=e;if(!this.pills.length||t!==y.LEFT&&t!==y.RIGHT)return;e.preventDefault();const s=this.gos.getActiveDomElement(),i=this.getGui(),{params:n,focusService:a}=this;if(i.contains(s)){const o=a.findNextFocusableElement(i,!1,t===y.LEFT);o?o.focus():n.eWrapper&&n.eWrapper.focus()}else{const o=a.findFocusableElements(i);o.length>0&&o[t===y.RIGHT?0:o.length-1].focus()}}clearPills(){const e=this.getGui();e.contains(this.gos.getActiveDomElement())&&this.params.eWrapper&&this.params.eWrapper.focus(),it(e),this.destroyBeans(this.pills),this.pills=[]}onPillButtonClick(e){this.deletePill(e)}onPillKeyDown(e){const t=e.key;if(t!==y.DELETE&&t!==y.BACKSPACE)return;e.preventDefault();const s=this.gos.getDocument(),i=this.pills.findIndex(a=>a.getGui().contains(s.activeElement));if(i===-1)return;const n=this.pills[i];n&&this.deletePill(n,i)}deletePill(e,t){const s=e.getText(),i=(this.params.getValue()||[]).filter(n=>n!==s);if(this.params.setValue(i),!i.length&&this.params.eWrapper)this.params.eWrapper.focus();else if(t!=null){const n=this.pills[Math.min(t,this.pills.length-1)];n&&n.getFocusableElement().focus()}}destroy(){this.clearPills(),super.destroy()}};import{KeyCode as ht,_setAriaActiveDescendant as ct,_setAriaControls as dt,_setAriaLabel as ut}from"@ag-grid-community/core";import{Component as pt,_bindCellRendererToHtmlElement as gt,_escapeString as P,_exists as S,_setAriaSelected as mt}from"@ag-grid-community/core";var ft=class extends pt{constructor(e){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=e}wireBeans(e){this.userComponentFactory=e.userComponentFactory}setState(e){let t="";const{params:s}=this;s.valueFormatter&&(t=s.valueFormatter(e)),this.populateWithRenderer(e,t)||this.populateWithoutRenderer(e,t),this.value=e}highlightString(e){const{parsedValue:t}=this;if(this.params.cellRenderer||!S(t))return;let s=S(e);if(s){const i=t?.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(i>=0){const n=i+e.length,a=P(t.slice(0,i),!0),o=P(t.slice(i,n),!0),r=P(t.slice(n));this.renderValueWithoutRenderer(`${a}<span class="ag-rich-select-row-text-highlight">${o}</span>${r}`)}else s=!1}s||this.renderValueWithoutRenderer(t)}updateSelected(e){const t=this.getGui();mt(t.parentElement,e),this.addOrRemoveCssClass("ag-rich-select-row-selected",e)}getValue(){return this.value}toggleHighlighted(e){this.addOrRemoveCssClass("ag-rich-select-row-highlighted",e)}populateWithoutRenderer(e,t){const s=this.gos.getDocument(),i=this.getGui(),n=s.createElement("span");n.style.overflow="hidden",n.style.textOverflow="ellipsis";const a=P(S(t)?t:e,!0);this.parsedValue=S(a)?a:null,i.appendChild(n),this.renderValueWithoutRenderer(a),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>n.scrollWidth>n.clientWidth})}renderValueWithoutRenderer(e){const t=this.getGui().querySelector("span");t&&(t.innerHTML=S(e)?e:"&nbsp;")}populateWithRenderer(e,t){let s,i;if(this.params.cellRenderer){const n=this.getParentComponent()?.getParentComponent();i=this.userComponentFactory.getEditorRendererDetails(this.params,{value:e,valueFormatted:t,getValue:()=>n?.getValue(),setValue:a=>{n?.setValue(a,!0)},setTooltip:(a,o)=>{this.setTooltip({newTooltipText:a,shouldDisplayTooltip:o})}})}return i&&(s=i.newAgStackInstance()),s&&gt(s,this.getGui()),s?(s.then(n=>{this.addDestroyFunc(()=>{this.destroyBean(n)})}),!0):!1}};import{KeyCode as m,RefPlaceholder as Ct,TabGuardComp as vt,_getAriaPosInSet as bt,_setAriaLabel as It,_setAriaPosInSet as wt,_setAriaRole as Q,_setAriaSetSize as yt,_stopPropagationForAgGrid as Dt,_waitUntil as Et,_warnOnce as St}from"@ag-grid-community/core";function Tt(e){return`<div class="ag-virtual-list-viewport ag-${e}-virtual-list-viewport" role="presentation">
            <div class="ag-virtual-list-container ag-${e}-virtual-list-container" data-ref="eContainer"></div>
        </div>`}var X=class extends vt{constructor(e){super(Tt(e?.cssIdentifier||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0,this.eContainer=Ct;const{cssIdentifier:t="default",ariaRole:s="listbox",listName:i}=e||{};this.cssIdentifier=t,this.ariaRole=s,this.listName=i}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.animationFrameService=e.animationFrameService,this.environment=e.environment}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanged.bind(this)})}onGridStylesChanged(e){e.listItemHeightChanged&&(this.rowHeight=this.getItemHeight(),this.refresh())}setAriaProperties(){const t=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),s=this.eContainer;Q(s,this.ariaRole),It(s,t)}addResizeObserver(){const e=()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()),t=this.resizeObserverService.observeResize(this.getGui(),e);this.addDestroyFunc(t)}focusInnerElement(e){this.focusRow(e?this.model.getRowCount()-1:0)}onFocusIn(e){const t=e.target;t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=bt(t)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){switch(e.key){case m.UP:case m.DOWN:this.navigate(e.key===m.UP)&&e.preventDefault();break;case m.PAGE_HOME:case m.PAGE_END:case m.PAGE_UP:case m.PAGE_DOWN:this.navigateToPage(e.key)!==null&&e.preventDefault();break}}onTabKeyDown(e){Dt(e),this.forceFocusOutOfContainer(e.shiftKey)}navigate(e){if(this.lastFocusedRowIndex==null)return!1;const t=this.lastFocusedRowIndex+(e?-1:1);return t<0||t>=this.model.getRowCount()?!1:(this.focusRow(t),!0)}navigateToPage(e,t="focused"){let s=!1;t==="focused"&&(t=this.getLastFocusedRow(),s=!0);const i=this.model.getRowCount()-1;let n=-1;return e===m.PAGE_HOME?n=0:e===m.PAGE_END?n=i:e===m.PAGE_DOWN?n=Math.min(t+this.pageSize,i):e===m.PAGE_UP&&(n=Math.max(t-this.pageSize,0)),n===-1?null:(s?this.focusRow(n):this.ensureIndexVisible(n),n)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(e){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(e),this.animationFrameService.requestAnimationFrame(()=>{if(this.isScrolling=!1,!this.isAlive())return;const t=this.renderedRows.get(e);t&&t.eDiv.focus()}))}getComponentAt(e){const t=this.renderedRows.get(e);return t&&t.rowComponent}forEachRenderedRow(e){this.renderedRows.forEach((t,s)=>e(t.rowComponent,s))}getItemHeight(){return this.isHeightFromTheme?this.environment.getDefaultListItemHeight():this.rowHeight}ensureIndexVisible(e,t=!0){const s=this.model.getRowCount();if(typeof e!="number"||e<0||e>=s)return St("invalid row index for ensureIndexVisible: ",e),!1;const i=e*this.rowHeight,n=i+this.rowHeight,a=this.getGui(),o=a.scrollTop,r=a.offsetHeight,l=o+r,h=t?0:this.rowHeight,c=o>i+h,d=l<n-h;if(c)return a.scrollTop=i,!0;if(d){const u=n-r;return a.scrollTop=u,!0}return!1}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.isHeightFromTheme=!1,this.rowHeight=e,this.refresh()}refresh(e){if(this.model==null||!this.isAlive())return;const t=this.model.getRowCount();this.eContainer.style.height=`${t*this.rowHeight}px`,Et(()=>this.eContainer.clientHeight>=t*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((e,t)=>this.removeRow(t))}drawVirtualRows(e){if(!this.isAlive()||!this.model)return;const t=this.getGui(),s=t.scrollTop,i=s+t.offsetHeight,n=Math.floor(s/this.rowHeight),a=Math.floor(i/this.rowHeight);this.pageSize=Math.floor((i-s)/this.rowHeight),this.ensureRowsRendered(n,a,e)}ensureRowsRendered(e,t,s){this.renderedRows.forEach((i,n)=>{(n<e||n>t)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)}),s&&this.refreshRows();for(let i=e;i<=t;i++)this.renderedRows.has(i)||i<this.model.getRowCount()&&this.insertRow(i)}insertRow(e){const t=this.model.getRow(e),s=document.createElement("div");s.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),Q(s,this.ariaRole==="tree"?"treeitem":"option"),yt(s,this.model.getRowCount()),wt(s,e+1),s.setAttribute("tabindex","-1"),s.style.height=`${this.rowHeight}px`,s.style.top=`${this.rowHeight*e}px`;const i=this.componentCreator(t,s);i.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=e),s.appendChild(i.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",s):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",s):this.eContainer.appendChild(s),this.renderedRows.set(e,{rowComponent:i,eDiv:s,value:t})}removeRow(e){const t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}refreshRows(){const e=this.model.getRowCount();this.renderedRows.forEach((t,s)=>{if(s>=e)this.removeRow(s);else{const i=this.model.getRow(s);this.model.areRowsEqual?.(t.value,i)?this.componentUpdater(i,t.rowComponent):this.removeRow(s)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(e){this.model=e}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}},ee="ag-rich-select-list",te="ag-rich-select-row",xt=class extends X{constructor(e,t,s){super({cssIdentifier:"rich-select"}),this.params=e,this.richSelectWrapper=t,this.getSearchString=s,this.lastRowHovered=-1,this.selectedItems=new Set,this.params=e,this.setComponentCreator(this.createRowComponent.bind(this)),this.setComponentUpdater(()=>{})}postConstruct(){super.postConstruct(),this.createLoadingElement();const{cellRowHeight:e,pickerAriaLabelKey:t,pickerAriaLabelValue:s}=this.params;e&&this.setRowHeight(e);const i=this.getGui(),n=this.getAriaElement();this.addManagedListeners(i,{mousemove:this.onMouseMove.bind(this),mouseout:this.onMouseOut.bind(this),mousedown:this.onMouseDown.bind(this),click:this.onClick.bind(this)}),i.classList.add(ee);const a=`${ee}-${this.getCompId()}`;n.setAttribute("id",a);const r=this.localeService.getLocaleTextFunc()(t,s);ut(n,r),dt(this.richSelectWrapper,n)}navigateToPage(e){const t=super.navigateToPage(e,this.lastRowHovered);return t!=null&&this.animationFrameService.requestAnimationFrame(()=>{if(!this.isAlive())return null;this.highlightIndex(t)}),t}drawVirtualRows(e){super.drawVirtualRows(e),this.refreshSelectedItems()}highlightFilterMatch(e){this.forEachRenderedRow(t=>{t.highlightString(e)})}onNavigationKeyDown(e,t){this.animationFrameService.requestAnimationFrame(()=>{if(!this.currentList||!this.isAlive())return;const s=this.currentList.length,i=this.lastRowHovered,n=e===ht.DOWN?1:-1,a=Math.min(Math.max(i===-1?0:i+n,0),s-1);this.highlightIndex(a),t()})}selectValue(e){if(!this.currentList){this.eLoading&&this.appendChild(this.eLoading);return}if(this.eLoading?.offsetParent&&this.eLoading.parentElement?.removeChild(this.eLoading),e==null)return;const t=this.getIndicesForValues(e);t.length>0&&(this.refresh(),this.ensureIndexVisible(t[0]),this.refresh(!0)),this.selectListItems(Array.isArray(e)?e:[e])}selectListItems(e,t=!1){t||this.selectedItems.clear();for(let s=0;s<e.length;s++){const i=e[s];this.selectedItems.has(i)||this.selectedItems.add(i)}this.refreshSelectedItems()}getCurrentList(){return this.currentList}setCurrentList(e){this.currentList=e,this.setModel({getRowCount:()=>e.length,getRow:t=>e[t],areRowsEqual:(t,s)=>t===s})}getSelectedItems(){return this.selectedItems}getLastItemHovered(){return this.currentList[this.lastRowHovered]}highlightIndex(e,t){this.currentList&&(e<0||e>=this.currentList.length?this.lastRowHovered=-1:(this.lastRowHovered=e,this.ensureIndexVisible(e,!t)&&!t&&this.refresh(!0)),this.forEachRenderedRow((s,i)=>{const n=e===i;if(s.toggleHighlighted(n),n){const a=`${te}-${s.getCompId()}`;ct(this.richSelectWrapper,a),this.richSelectWrapper.setAttribute("data-active-option",a)}}))}getIndicesForValues(e){const{currentList:t}=this;if(!t||t.length===0||e==null)return[];if(Array.isArray(e)||(e=[e]),e.length===0)return[];const s=[];for(let i=0;i<e.length;i++){const n=t.indexOf(e[i]);n>=0&&s.push(n)}return s}toggleListItemSelection(e){this.selectedItems.has(e)?this.selectedItems.delete(e):this.selectedItems.add(e),this.refreshSelectedItems(),this.dispatchValueSelected()}refreshSelectedItems(){this.forEachRenderedRow(e=>{const t=this.selectedItems.has(e.getValue());e.updateSelected(t)})}createLoadingElement(){const e=this.gos.getDocument(),t=this.localeService.getLocaleTextFunc(),s=e.createElement("div");s.classList.add("ag-loading-text"),s.innerText=t("loadingOoo","Loading..."),this.eLoading=s}createRowComponent(e,t){const s=new ft(this.params);t.setAttribute("id",`${te}-${s.getCompId()}`),s.setParentComponent(this),this.createBean(s),s.setState(e);const{highlightMatch:i,searchType:n="fuzzy"}=this.params;return i&&n!=="fuzzy"&&s.highlightString(this.getSearchString()),s}getRowForMouseEvent(e){const s=this.getGui().getBoundingClientRect(),i=this.getScrollTop(),n=e.clientY-s.top+i;return Math.floor(n/this.getRowHeight())}onMouseMove(e){const t=this.getRowForMouseEvent(e);t!==-1&&t!=this.lastRowHovered&&(this.lastRowHovered=t,this.highlightIndex(t,!0))}onMouseDown(e){e.preventDefault()}onMouseOut(e){this.getGui().contains(e.relatedTarget)||this.highlightIndex(-1)}onClick(e){const{multiSelect:t}=this.params;if(!this.currentList)return;const s=this.getRowForMouseEvent(e),i=this.currentList[s];t?this.toggleListItemSelection(i):(this.selectListItems([i]),this.dispatchValueSelected())}dispatchValueSelected(){const e={type:"richSelectListRowSelected",fromEnterKey:!1,value:this.selectedItems};this.dispatchLocalEvent(e)}destroy(){super.destroy(),this.eLoading=void 0}},Lt=class extends Ue{constructor(e){super({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:e?.template??`
            <div class="ag-picker-field" role="presentation">
                <div data-ref="eLabel"></div>
                <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">
                    <span data-ref="eDisplayField" class="ag-picker-field-display"></span>
                    <ag-input-text-field data-ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>
                    <span data-ref="eDeselect" class="ag-rich-select-deselect-button ag-picker-field-icon" role="presentation"></span>
                    <span data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></span>
                </div>
            </div>`,agComponents:[$e],modalPicker:!1,...e,maxPickerHeight:e?.maxPickerHeight??"calc(var(--ag-row-height) * 6.5)"}),this.searchString="",this.searchStringCreator=null,this.eInput=Y,this.eDeselect=Y,this.skipWrapperAnnouncement=!1;const{value:t,valueList:s,searchStringCreator:i}=e||{};t!==void 0&&(this.value=t),s!=null&&(this.values=s),i&&(this.searchStringCreator=i)}wireBeans(e){super.wireBeans(e),this.userComponentFactory=e.userComponentFactory,this.ariaAnnouncementService=e.ariaAnnouncementService}postConstruct(){super.postConstruct(),this.createListComponent(),this.eDeselect.appendChild(qe("cancel",this.gos));const{allowTyping:e,placeholder:t,suppressDeselectAll:s}=this.config;this.eDeselect.classList.add("ag-hidden"),e?(this.eInput.setAutoComplete(!1).setInputPlaceholder(t),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.setupAriaProperties();const{searchDebounceDelay:i=300}=this.config;this.clearSearchString=Ye(this.clearSearchString,i),this.renderSelectedValue(),e&&this.eInput.onValueChange(n=>this.searchTextFromString(n)),this.addManagedElementListeners(this.eWrapper,{focus:this.onWrapperFocus.bind(this)}),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)}),s||this.addManagedElementListeners(this.eDeselect,{mousedown:this.onDeselectAllMouseDown.bind(this),click:this.onDeselectAllClick.bind(this)})}setupAriaProperties(){const{eWrapper:e,gos:t,localeService:s}=this;e.tabIndex=t.get("tabIndex");const i=s.getLocaleTextFunc();this.ariaDeleteSelection=i("ariaLabelRichSelectDeleteSelection","Press DELETE to deselect item"),this.ariaDeselectAllItems=i("ariaLabelRichSelectDeselectAllItems","Press DELETE to deselect all items"),this.ariaToggleSelection=i("ariaLabelRichSelectToggleSelection","Press SPACE to toggle selection")}createListComponent(){this.listComponent=this.createBean(new xt(this.config,this.eWrapper,()=>this.searchString)),this.listComponent.setParentComponent(this),this.addManagedListeners(this.listComponent,{richSelectListRowSelected:e=>{this.onListValueSelected(e.value,e.fromEnterKey)}})}renderSelectedValue(){const{value:e,eDisplayField:t,config:s}=this,{allowTyping:i,cellRenderer:n,initialInputValue:a,multiSelect:o,suppressDeselectAll:r,suppressMultiSelectPillRenderer:l}=s,h=this.config.valueFormatter?this.config.valueFormatter(e):e;if(i){this.eInput.setValue(a??h);return}if(o&&!r){const u=e==null||Array.isArray(e)&&e.length===0;this.eDeselect.classList.toggle("ag-hidden",u)}let c;if(o&&!l){this.createOrUpdatePillContainer(t);return}n&&(c=this.userComponentFactory.getEditorRendererDetails(s,{value:e,valueFormatted:h,getValue:()=>this.getValue(),setValue:u=>{this.setValue(u,!0)},setTooltip:(u,f)=>{this.setTooltip({newTooltipText:u,shouldDisplayTooltip:f})}}));let d;if(c&&(d=c.newAgStackInstance()),d)N(t),je(d,t),d.then(u=>{this.addDestroyFunc(()=>this.destroyBean(u))});else{if(Z(this.value))t.innerText=h,t.classList.remove("ag-display-as-placeholder");else{const{placeholder:u}=s;Z(u)?(t.innerHTML=`${Ze(u)}`,t.classList.add("ag-display-as-placeholder")):N(t)}this.setTooltip({newTooltipText:h??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}createPickerComponent(){const{values:e}=this;return e&&this.setValueList({valueList:e}),this.listComponent}setSearchStringCreator(e){this.searchStringCreator=e}setValueList(e){const{valueList:t,refresh:s}=e;!this.listComponent||this.listComponent.getCurrentList()===t||(this.listComponent.setCurrentList(t),s&&(this.values?this.listComponent.refresh(!0):(this.values=t,this.isPickerDisplayed&&this.listComponent.selectValue(this.value))))}showPicker(){super.showPicker();const{listComponent:e,value:t}=this;if(!e)return;let s=null;this.value!=null&&(e.selectValue(this.value),s=e.getIndicesForValues(Array.isArray(t)?t:[t])[0]),s!=null?e.highlightIndex(s):e.refresh(),this.displayOrHidePicker()}beforeHidePicker(){super.beforeHidePicker()}createOrUpdatePillContainer(e){if(!this.pillContainer){const t=this.pillContainer=this.createBean(new lt);this.addDestroyFunc(()=>{this.destroyBean(this.pillContainer),this.pillContainer=null}),N(e),e.appendChild(t.getGui()),t.init({eWrapper:this.eWrapper,onPillMouseDown:s=>{s.stopImmediatePropagation()},announceItemFocus:()=>{this.ariaAnnouncementService.announceValue(this.ariaDeleteSelection)},getValue:()=>this.getValue(),setValue:s=>this.setValue(s,!0)})}this.doWhileBlockingAnnouncement(()=>this.pillContainer?.refresh())}doWhileBlockingAnnouncement(e){this.skipWrapperAnnouncement=!0,e(),this.skipWrapperAnnouncement=!1}onWrapperFocus(){const{eInput:e,config:t}=this,{allowTyping:s,multiSelect:i,suppressDeselectAll:n}=t;if(s){const a=e.getFocusableElement();a.focus(),a.select()}else i&&!n&&!this.skipWrapperAnnouncement&&this.ariaAnnouncementService.announceValue(this.ariaDeselectAllItems)}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}onDeselectAllMouseDown(e){e.stopImmediatePropagation()}onDeselectAllClick(){this.setValue([],!0)}buildSearchStringFromKeyboardEvent(e){let{key:t}=e;if(t===p.BACKSPACE)this.searchString=this.searchString.slice(0,-1),t="";else if(!Qe(e))return;e.preventDefault(),this.searchTextFromCharacter(t)}searchTextFromCharacter(e){this.searchString+=e,this.runSearch(),this.clearSearchString()}searchTextFromString(e){e==null&&(e=""),this.searchString=e,this.runSearch()}buildSearchStrings(e){const{valueFormatter:t=i=>i}=this.config;let s;return typeof e[0]=="number"||typeof e[0]=="string"?s=e.map(i=>t(i)):typeof e[0]=="object"&&this.searchStringCreator&&(s=this.searchStringCreator(e)),s}filterListModel(e){const{filterList:t}=this.config;t&&(this.setValueList({valueList:e,refresh:!0}),this.alignPickerToComponent())}runSearch(){if(!this.listComponent)return;const{values:e}=this,t=this.buildSearchStrings(e);if(!t){this.listComponent.highlightIndex(-1);return}const{suggestions:s,filteredValues:i}=this.getSuggestionsAndFilteredValues(this.searchString,t),{filterList:n,highlightMatch:a,searchType:o="fuzzy"}=this.config,r=i.length,l=!!(n&&this.searchString!=="");if(this.filterListModel(l?i:e),s.length){const h=l?0:t.indexOf(s[0]);this.listComponent?.highlightIndex(h)}else if(this.listComponent?.highlightIndex(-1),!l||r)this.listComponent?.ensureIndexVisible(0);else if(l){this.getAriaElement().removeAttribute("data-active-option");const h=this.listComponent?.getAriaElement();h&&et(h,null)}a&&o!=="fuzzy"&&this.listComponent?.highlightFilterMatch(this.searchString),this.displayOrHidePicker()}getSuggestionsAndFilteredValues(e,t){let s=[];const i=[];if(!e.length)return{suggestions:s,filteredValues:i};const{searchType:n="fuzzy",filterList:a}=this.config;if(n==="fuzzy"){const o=Je(e,t,!0);s=o.values;const r=o.indices;if(a&&r.length)for(let l=0;l<r.length;l++)i.push(this.values[r[l]])}else s=t.filter((o,r)=>{const l=o.toLocaleLowerCase(),h=this.searchString.toLocaleLowerCase(),c=n==="match"?l.startsWith(h):l.indexOf(h)!==-1;return a&&c&&i.push(this.values[r]),c});return{suggestions:s,filteredValues:i}}displayOrHidePicker(){if(!this.listComponent)return;const e=this.listComponent.getGui(),t=this.listComponent.getCurrentList(),s=t?t.length===0:!1;e.classList.toggle("ag-hidden",s)}clearSearchString(){this.searchString=""}setValue(e,t,s,i){if(this.value===e)return this;const n=Array.isArray(e);if(e!=null){if(!n){const a=this.listComponent?.getCurrentList();if((a?a.indexOf(e):-1)===-1)return this}s||this.listComponent?.selectValue(e)}return super.setValue(e,t),i||this.renderSelectedValue(),this}onNavigationKeyDown(e,t,s){e.preventDefault();const i=t===p.DOWN;if(!this.isPickerDisplayed&&i){this.showPicker();return}this.listComponent?.onNavigationKeyDown(t,s)}onEnterKeyDown(e){if(this.isPickerDisplayed&&(e.preventDefault(),this.listComponent?.getCurrentList())){const t=this.listComponent.getLastItemHovered();this.config.multiSelect||!t?this.dispatchPickerEventAndHidePicker(this.value,!0):this.onListValueSelected(new Set([t]),!0)}}onDeleteKeyDown(e){const{eWrapper:t,gos:s}=this;s.getActiveDomElement()===t&&(e.preventDefault(),this.setValue([],!0))}onTabKeyDown(){const{config:e,isPickerDisplayed:t,listComponent:s}=this,{multiSelect:i}=e;if(!(!t||!s))if(i){const n=this.getValueFromSet(s.getSelectedItems());n&&this.setValue(n,!1,!0,!0)}else this.setValue(s.getLastItemHovered(),!1,!0)}getValueFromSet(e){const{multiSelect:t}=this.config;let s=null;for(const i of e){if(e.size===1&&!t){s=i;break}s||(s=[]),s.push(i)}return Array.isArray(s)&&s.sort(),s}onListValueSelected(e,t){const s=this.getValueFromSet(e);this.setValue(s,!1,!0),this.config.multiSelect||this.dispatchPickerEventAndHidePicker(s,t)}dispatchPickerEventAndHidePicker(e,t){const s={type:"fieldPickerValueSelected",fromEnterKey:t,value:e};this.dispatchLocalEvent(s),this.hidePicker()}getFocusableElement(){const{allowTyping:e}=this.config;return e?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(e){const{key:t}=e,{isPickerDisplayed:s,config:i,listComponent:n,pickerComponent:a}=this,{allowTyping:o,multiSelect:r,suppressDeselectAll:l}=i;switch(t){case p.LEFT:case p.RIGHT:(!o||this.pillContainer)&&(e.preventDefault(),this.pillContainer&&(this.listComponent?.highlightIndex(-1),this.pillContainer.onNavigationKeyDown(e)));break;case p.PAGE_HOME:case p.PAGE_END:if(o){e.preventDefault();const h=this.eInput.getInputElement(),c=t===p.PAGE_HOME?0:h.value.length;h.setSelectionRange(c,c);break}case p.PAGE_UP:case p.PAGE_DOWN:e.preventDefault(),a&&n?.navigateToPage(t);break;case p.DOWN:case p.UP:this.onNavigationKeyDown(e,t,()=>{r&&(this.doWhileBlockingAnnouncement(()=>this.eWrapper.focus()),this.ariaAnnouncementService.announceValue(this.ariaToggleSelection))});break;case p.ESCAPE:s&&(Xe(this.listComponent.getGui())&&(e.preventDefault(),tt(e)),this.hidePicker());break;case p.ENTER:this.onEnterKeyDown(e);break;case p.SPACE:if(s&&r&&n){e.preventDefault();const h=n.getLastItemHovered();h&&n.toggleListItemSelection(h)}break;case p.TAB:this.onTabKeyDown();break;case p.DELETE:r&&!l&&this.onDeleteKeyDown(e);break;default:o||this.buildSearchStringFromKeyboardEvent(e)}}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}};import{Component as At,KeyCode as Gt,RefPlaceholder as H,TouchListener as Rt,_createIconNoSpan as se,_escapeString as Pt,_setAriaLabel as Mt,_setDisplayed as Ft}from"@ag-grid-community/core";var Ot=class extends At{constructor(e,t,s,i,n){super(),this.dragSourceDropTarget=e,this.ghost=t,this.horizontal=s,this.template=i,this.agComponents=n,this.eText=H,this.eDragHandle=H,this.eButton=H}wireBeans(e){this.dragAndDropService=e.dragAndDropService}postConstruct(){this.setTemplate(this.template??`
            <span role="option">
              <span data-ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>
              <span data-ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>
              <span data-ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>
            </span>`,this.agComponents);const e=this.getGui();this.addElementClasses(e),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(se("columnDrag",this.gos)),this.eButton.appendChild(se("cancel",this.gos)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const e=this.localeService.getLocaleTextFunc(),t=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(t,e),Mt(this.getGui(),t.join(". "))}addAdditionalAriaInstructions(e,t){if(this.isRemovable()){const s=t("ariaDropZoneColumnComponentDescription","Press DELETE to remove");e.push(s)}}setupTooltip(){const e=()=>{const t=this.getTooltip();this.setTooltip({newTooltipText:t})};e(),this.addManagedEventListeners({newColumnsLoaded:e})}getDragSourceId(){}getDefaultIconName(){return"notAllowed"}addDragSource(){const{dragAndDropService:e,eDragHandle:t}=this,s=this.createGetDragItem(),i=this.getDefaultIconName(),n={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:t,getDefaultIconName:()=>i,getDragItem:s,dragItemName:this.getDisplayName()};e.addDragSource(n,!0),this.addDestroyFunc(()=>e.removeDragSource(n))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){Ft(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const e={type:"columnRemove"};this.addGuiEventListener("keydown",s=>this.onKeyDown(s)),this.addManagedElementListeners(this.eButton,{click:s=>{this.dispatchLocalEvent(e),s.stopPropagation()}});const t=new Rt(this.eButton);this.addManagedListeners(t,{tap:()=>this.dispatchLocalEvent(e)}),this.addDestroyFunc(t.destroy.bind(t))}onKeyDown(e){e.key===Gt.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchLocalEvent({type:"columnRemove"}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const e=this.getDisplayValue(),t=Pt(e);this.eText.innerHTML=t}addElementClasses(e,t){t=t?`-${t}`:"";const s=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop-cell${t}`,`ag-column-drop-${s}-cell${t}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}};import{Component as Bt,KeyCode as D,ManagedFocusFeature as kt,PositionableFeature as Nt,_areEqual as Ht,_clearElement as ie,_createIconNoSpan as Vt,_existsAndNotEmpty as _t,_includes as ne,_insertArrayIntoArray as ae,_last as zt,_setAriaHidden as Wt,_setAriaLabel as Kt,_setAriaPosInSet as $t,_setAriaRole as Ut,_setAriaSetSize as jt}from"@ag-grid-community/core";var qt=class extends Bt{constructor(e){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=e,this.state="notDragging",this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),Ut(this.ePillDropList,"listbox")}wireBeans(e){this.focusService=e.focusService,this.dragAndDropService=e.dragAndDropService}isHorizontal(){return this.horizontal}toggleResizable(e){this.positionableFeature.setResizable(e?{bottom:!0}:!1),this.resizeEnabled=e}isSourceEventFromTarget(e){const{dropZoneTarget:t,dragSource:s}=e;return t.contains(s.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(e=>e()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,ie(this.getGui()),ie(this.ePillDropList)}init(e){this.params=e??{},this.createManagedBean(new kt(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.onKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new Nt(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),Kt(this.ePillDropList,this.getAriaLabel())}onTabKeyDown(e){const t=this.focusService.findFocusableElements(this.getFocusableElement(),null,!0),s=t.length;if(s===0)return;const{shiftKey:i}=e,n=this.gos.getActiveDomElement(),a=n===t[0],o=n===zt(t);s===1||a&&i||o&&!i||t[i?0:s-1].focus()}onKeyDown(e){const{key:t}=e,s=!this.horizontal;let i=t===D.DOWN,n=t===D.UP;if(!s){const o=this.gos.get("enableRtl");i=!o&&t===D.RIGHT||o&&t===D.LEFT,n=!o&&t===D.LEFT||o&&t===D.RIGHT}if(!i&&!n)return;const a=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,n);a&&(e.preventDefault(),a.focus())}addElementClasses(e,t){t=t?`-${t}`:"";const s=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop${t}`,`ag-column-drop-${s}${t}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(e){const t=this.getNewInsertIndex(e);if(t<0)return!1;const s=this.minimumAllowedNewInsertIndex(),i=Math.max(s,t),n=i!==this.insertIndex;return n&&(this.insertIndex=i),n}getNewInsertIndex(e){const t=e.event,s=this.horizontal?t.clientX:t.clientY,i=this.childPillComponents.map(a=>a.getGui().getBoundingClientRect()),n=i.findIndex(a=>this.horizontal?a.right>s&&a.left<s:a.top<s&&a.bottom>s);if(n===-1){const a=this.gos.get("enableRtl");return i.every(l=>s>(this.horizontal?l.right:l.bottom))?a&&this.horizontal?0:this.childPillComponents.length:i.every(l=>s<(this.horizontal?l.left:l.top))?a&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=n?n+1:n}checkDragStartedBySelf(e){this.state==="notDragging"&&(this.state="rearrangeItems",this.potentialDndItems=this.getItems(e.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(e),this.refreshGui())}onDragging(e){this.checkDragStartedBySelf(e),this.checkInsertIndex(e)&&this.refreshGui()}handleDragEnterEnd(e){}onDragEnter(e){const t=this.getItems(e.dragSource.getDragItem());this.state="newItemsIn";const s=t.filter(n=>this.isItemDroppable(n,e)),i=s.every(n=>this.childPillComponents.map(a=>a.getItem()).indexOf(n)!==-1);if(s.length!==0){if(this.potentialDndItems=s,i){this.state="notDragging";return}this.handleDragEnterEnd(e),this.checkInsertIndex(e),this.refreshGui()}}isPotentialDndItems(){return _t(this.potentialDndItems)}handleDragLeaveEnd(e){}onDragLeave(e){if(this.state==="rearrangeItems"){const t=this.getItems(e.dragSource.getDragItem());this.removeItems(t)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}onDragStop(){this.isPotentialDndItems()&&(this.state==="newItemsIn"?this.addItems(this.potentialDndItems):this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}removeItems(e){const t=this.getExistingItems().filter(s=>!ne(e,s));this.updateItems(t)}addItems(e){if(!e)return;const t=this.getExistingItems().slice(),s=e.filter(i=>t.indexOf(i)<0);ae(t,s,this.insertIndex),this.updateItems(t)}addItem(e){this.insertIndex=this.getExistingItems().length,this.addItems([e]),this.refreshGui()}rearrangeItems(e){const t=this.getNonGhostItems().slice();return ae(t,e,this.insertIndex),Ht(t,this.getExistingItems())?!1:(this.updateItems(t),!0)}refreshGui(){const e=this.ePillDropList.scrollTop,t=this.resizeEnabled,s=this.getFocusedItem();let i=this.focusService.findNextFocusableElement();i||(i=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=e),t&&this.toggleResizable(t),this.focusService.isKeyboardMode()&&this.restoreFocus(s,i)}getFocusedItem(){const e=this.getGui(),t=this.gos.getActiveDomElement();return e.contains(t)?Array.from(e.querySelectorAll(".ag-column-drop-cell")).indexOf(t):-1}restoreFocus(e,t){const s=this.getGui(),i=Array.from(s.querySelectorAll(".ag-column-drop-cell"));if(e===-1)return;i.length===0&&t.focus();const n=Math.min(i.length-1,e),a=i[n];a&&a.focus()}focusList(e){const t=e?this.childPillComponents.length-1:0;this.restoreFocus(t,this.getFocusableElement())}getNonGhostItems(){const e=this.getExistingItems();return this.isPotentialDndItems()?e.filter(t=>!ne(this.potentialDndItems,t)):e}addItemsToGui(){const t=this.getNonGhostItems().map(s=>this.createItemComponent(s,!1));if(this.isPotentialDndItems()){const s=this.potentialDndItems.map(i=>this.createItemComponent(i,!0));this.insertIndex>=t.length?t.push(...s):t.splice(this.insertIndex,0,...s)}this.appendChild(this.ePillDropList),t.forEach((s,i)=>{i>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(s.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((e,t)=>{const s=e.getGui();$t(s,t+1),jt(s,this.childPillComponents.length)})}createItemComponent(e,t){const s=this.createPillComponent(e,this.dropTarget,t,this.horizontal);return s.addEventListener("columnRemove",this.removeItems.bind(this,[e])),this.createBean(s),this.guiDestroyFunctions.push(()=>this.destroyBean(s)),t||this.childPillComponents.push(s),s}addIconAndTitleToGui(){const{title:e,icon:t}=this.params;if(!e||!t)return;const s=document.createElement("div");if(Wt(s,!0),this.addElementClasses(s,"title-bar"),this.addElementClasses(t,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),s.appendChild(t),!this.horizontal){const i=document.createElement("span");this.addElementClasses(i,"title"),i.innerHTML=e,s.appendChild(i)}this.appendChild(s)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage:e}=this.params;if(!e||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const t=document.createElement("span");t.innerHTML=e,this.addElementClasses(t,"empty-message"),this.ePillDropList.appendChild(t)}addArrow(e){if(this.horizontal){const t=this.gos.get("enableRtl"),s=Vt(t?"smallLeft":"smallRight",this.gos);this.addElementClasses(s,"cell-separator"),e.appendChild(s)}}};import{Component as Yt,TabGuardFeature as Zt,_createIconNoSpan as oe,_setDisplayed as re}from"@ag-grid-community/core";import{Component as le,PositionableFeature as Jt,RefPlaceholder as M,_createIconNoSpan as Qt,_getInnerHeight as Xt,_getInnerWidth as es,_isVisible as ts,_setDisplayed as ss}from"@ag-grid-community/core";function is(e){const t=e.cssIdentifier||"default";return`<div class="ag-panel ag-${t}-panel" tabindex="-1">
        <div data-ref="eTitleBar" class="ag-panel-title-bar ag-${t}-panel-title-bar ag-unselectable">
            <span data-ref="eTitle" class="ag-panel-title-bar-title ag-${t}-panel-title-bar-title"></span>
            <div data-ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${t}-panel-title-bar-buttons"></div>
        </div>
        <div data-ref="eContentWrapper" class="ag-panel-content-wrapper ag-${t}-panel-content-wrapper"></div>
    </div>`}var he=class De extends le{constructor(t){super(is(t)),this.config=t,this.closable=!0,this.eContentWrapper=M,this.eTitleBar=M,this.eTitleBarButtons=M,this.eTitle=M}postConstruct(){const{component:t,closable:s,hideTitleBar:i,title:n,minWidth:a=250,width:o,minHeight:r=250,height:l,centered:h,popup:c,x:d,y:u}=this.config;this.positionableFeature=new Jt(this.getGui(),{minWidth:a,width:o,minHeight:r,height:l,centered:h,x:d,y:u,popup:c,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const f=this.getGui();t&&this.setBodyComponent(t),i?ss(this.eTitleBar,!1):(n&&this.setTitle(n),this.setClosable(s??this.closable)),this.addManagedElementListeners(this.eTitleBar,{mousedown:C=>{if(f.contains(C.relatedTarget)||f.contains(this.gos.getActiveDomElement())||this.eTitleBarButtons.contains(C.target)){C.preventDefault();return}const b=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");b&&b.focus()}}),!(c&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const t=this.getGui();t.focus(),this.close=()=>{t.parentElement.removeChild(t),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(t){this.positionableFeature.setHeight(t)}getWidth(){return this.positionableFeature.getWidth()}setWidth(t){this.positionableFeature.setWidth(t)}setClosable(t){if(t!==this.closable&&(this.closable=t),t){const s=this.closeButtonComp=new le(De.CLOSE_BTN_TEMPLATE);this.createBean(s);const i=s.getGui(),n=Qt("close",this.gos);n.classList.add("ag-panel-title-bar-button-icon"),i.appendChild(n),this.addTitleBarButton(s),s.addManagedElementListeners(i,{click:this.onBtClose.bind(this)})}else if(this.closeButtonComp){const s=this.closeButtonComp.getGui();s.parentElement.removeChild(s),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())}addTitleBarButton(t,s){const i=this.eTitleBarButtons,n=i.children,a=n.length;s==null&&(s=a),s=Math.max(0,Math.min(s,a)),t.addCssClass("ag-panel-title-bar-button");const o=t.getGui();s===0?i.insertAdjacentElement("afterbegin",o):s===a?i.insertAdjacentElement("beforeend",o):n[s-1].insertAdjacentElement("afterend",o),t.setParentComponent(this)}getBodyHeight(){return Xt(this.eContentWrapper)}getBodyWidth(){return es(this.eContentWrapper)}setTitle(t){this.eTitle.innerText=t}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const t=this.getGui();t&&ts(t)&&this.close(),super.destroy()}};he.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>';var ce=he,ns=class extends ce{constructor(e){super({...e,popup:!0}),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService}postConstruct(){const e=this.getGui(),{movable:t,resizable:s,maximizable:i,modal:n}=this.config;if(this.addCssClass("ag-dialog"),super.postConstruct(),this.tabGuardFeature=this.createManagedBean(new Zt(this)),this.tabGuardFeature.initialiseTabGuard({isFocusableContainer:!0,onFocusIn:()=>{const a=this.gos.getDocument(),{activeElement:o}=a;this.popupService.bringPopupToFront(e)&&o!==a.body&&o?.focus?.()},onTabKeyDown:a=>{if(n)return;const o=a.shiftKey,r=this.focusService.findNextFocusableElement(e,!1,o);(!r||this.tabGuardFeature.getTabGuardCtrl().isTabGuard(r))&&this.focusService.focusNextGridCoreContainer(o)&&a.preventDefault()}}),t&&this.setMovable(t),i&&this.setMaximizable(i),s&&this.setResizable(s),!this.config.modal){const{focusService:a}=this;a.addFocusableContainer(this),this.addDestroyFunc(()=>a.removeFocusableContainer(this))}}setAllowFocus(e){this.tabGuardFeature.getTabGuardCtrl().setAllowFocus(e)}renderComponent(){const e=this.getGui(),{alwaysOnTop:t,modal:s,title:i,afterGuiAttached:n}=this.config,a=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:s,eChild:e,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop:t,ariaLabel:i||a("ariaLabelDialog","Dialog"),afterGuiAttached:n});o&&(this.close=o.hideFunc)}onClosed(e){this.destroy(),this.config.closedCallback?.(e)}toggleMaximize(){const e=this.positionableFeature.getPosition();if(this.isMaximized){const{x:t,y:s,width:i,height:n}=this.lastPosition;this.setWidth(i),this.setHeight(n),this.positionableFeature.offsetElement(t,s)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){re(this.maximizeIcon,!this.isMaximized),re(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const s=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),s.addManagedElementListeners(s.getGui(),{click:this.toggleMaximize.bind(this)}),this.addTitleBarButton(s,0),this.maximizeListeners.push(...this.addManagedElementListeners(t,{dblclick:this.toggleMaximize.bind(this)})),[this.resizeListenerDestroy]=this.addManagedListeners(this.positionableFeature,{resize:()=>{this.isMaximized=!1,this.refreshMaximizeIcon()}})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new Yt('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=oe("maximize",this.gos),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=oe("minimize",this.gos),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}};import{BeanStub as as,KeyCode as de,TooltipFeature as os,_loadTemplate as rs,_setAriaDisabled as ls,_setAriaExpanded as hs,_setAriaLevel as cs,_setAriaRole as ds}from"@ag-grid-community/core";import{AgPromise as V,KeyCode as v,TabGuardComp as us,_last as ps,_loadTemplate as gs,_stopPropagationForAgGrid as ms,_warnOnce as fs}from"@ag-grid-community/core";var ue=class extends us{constructor(e=0,t){super('<div class="ag-menu-list" role="tree"></div>'),this.level=e,this.menuItems=[],this.params=t??{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){const t=this.getParentComponent(),s=t&&t.getGui();s&&s.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case v.UP:case v.RIGHT:case v.DOWN:case v.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case v.ESCAPE:this.closeIfIsChild()&&ms(e);break}}handleFocusIn(e){const t=e.relatedTarget;!this.tabGuardFeature.getTabGuardCtrl().isTabGuard(t)&&(this.getGui().contains(t)||this.activeMenuItem?.getSubMenuGui()?.contains(t))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){const t=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(t)||this.activeMenuItem.getSubMenuGui()?.contains(t)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){e!=null&&V.all(e.map(t=>t==="separator"?V.resolve({eGui:this.createSeparator()}):typeof t=="string"?(fs(`unrecognised menu item ${t}`),V.resolve({eGui:null})):this.addItem(t))).then(t=>{t.forEach(s=>{s?.eGui&&(this.appendChild(s.eGui),s.comp&&this.menuItems.push(s.comp))})})}addItem(e){const t=this.createManagedBean(new _);return t.init({menuItemDef:e,isAnotherSubMenuOpen:()=>this.menuItems.some(s=>s.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(t.setParentComponent(this),this.addManagedListeners(t,{closeMenu:s=>{this.dispatchLocalEvent(s)},menuItemActivated:s=>{this.activeMenuItem&&this.activeMenuItem!==s.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=s.menuItem}}),{comp:t,eGui:t.getGui()}))}activateFirstItem(){const e=this.menuItems.filter(t=>!t.isDisabled())[0];e&&e.activate()}createSeparator(){return gs(`
            <div class="ag-menu-separator" aria-hidden="true">
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
            </div>`)}handleNavKey(e){switch(e){case v.UP:case v.DOWN:{const s=this.findNextItem(e===v.UP);s&&s!==this.activeMenuItem&&s.activate();return}}const t=this.gos.get("enableRtl")?v.RIGHT:v.LEFT;e===t?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();return t&&t instanceof _?(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const t=this.menuItems.filter(n=>!n.isDisabled());if(!t.length)return;if(!this.activeMenuItem)return e?ps(t):t[0];e&&t.reverse();let s,i=!1;for(let n=0;n<t.length;n++){const a=t[n];if(!i){a===this.activeMenuItem&&(i=!0);continue}s=a;break}return i&&!s?t[0]:s||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}};import{KeyCode as Cs,TabGuardComp as vs}from"@ag-grid-community/core";var pe=class extends vs{constructor(e){super(),this.setTemplateFromElement(e.getGui(),void 0,void 0,!0)}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===Cs.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}},_=class extends as{constructor(){super(...arguments),this.ACTIVATION_DELAY=80,this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}wireBeans(e){this.popupService=e.popupService,this.userComponentFactory=e.userComponentFactory}init(e){const{menuItemDef:t,isAnotherSubMenuOpen:s,level:i,childComponent:n,contextParams:a}=e;return this.params=e.menuItemDef,this.level=i,this.isAnotherSubMenuOpen=s,this.childComponent=n,this.contextParams=a,this.cssClassPrefix=this.params.menuItemParams?.cssClassPrefix??"ag-menu-option",this.userComponentFactory.getMenuItemCompDetails(this.params,{...t,level:i,isAnotherSubMenuOpen:s,openSubMenu:r=>this.openSubMenu(r),closeSubMenu:()=>this.closeSubMenu(),closeMenu:r=>this.closeMenu(r),updateTooltip:(r,l)=>this.refreshTooltip(r,l),onItemActivated:()=>this.onItemActivated()}).newAgStackInstance().then(r=>{this.menuItemComp=r;const l=r.configureDefaults?.();l&&this.configureDefaults(l===!0?void 0:l)})}addListeners(e,t){t?.suppressClick||this.addManagedElementListeners(e,{click:s=>this.onItemSelected(s)}),t?.suppressKeyboardSelect||this.addManagedElementListeners(e,{keydown:s=>{(s.key===de.ENTER||s.key===de.SPACE)&&(s.preventDefault(),this.onItemSelected(s))}}),t?.suppressMouseDown||this.addManagedElementListeners(e,{mousedown:s=>{s.stopPropagation(),s.preventDefault()}}),t?.suppressMouseOver||this.addManagedElementListeners(e,{mouseenter:()=>this.onMouseEnter(),mouseleave:()=>this.onMouseLeave()})}isDisabled(){return!!this.params.disabled}openSubMenu(e=!1){if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const t=rs('<div class="ag-menu" role="presentation"></div>');this.eSubMenuGui=t;let s,i=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const r=this.createBean(new pe(this.childComponent));r.setParentComponent(this);const l=r.getGui(),h="mouseenter",c=()=>this.cancelDeactivate();l.addEventListener(h,c),s=()=>l.removeEventListener(h,c),t.appendChild(l),this.childComponent.afterGuiAttached&&(i=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const r=this.createBean(new ue(this.level+1,this.contextParams));r.setParentComponent(this),r.addMenuItems(this.params.subMenu),t.appendChild(r.getGui()),this.addManagedListeners(r,{closeMenu:l=>this.dispatchLocalEvent(l)}),r.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),s=()=>this.destroyBean(r),e&&(i=()=>{r.activateFirstItem(),this.subMenuIsOpening=!1})}const n=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup:t}),a=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:!0,eChild:t,positionCallback:n,anchorToElement:this.eGui,ariaLabel:a("ariaLabelSubMenu","SubMenu"),afterGuiAttached:i});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{o&&o.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),s(),this.menuItemComp.setExpanded?.(!1),this.eSubMenuGui=void 0},this.menuItemComp.setExpanded?.(!0)}setAriaExpanded(e){this.suppressAria||hs(this.eGui,e)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(e){this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),this.menuItemComp.setActive?.(!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),e&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),this.menuItemComp.setActive?.(!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(e){this.parentComponent=e}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(e){this.menuItemComp.select?.(),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gos.addGridCommonParams({...this.contextParams}))):this.openSubMenu(e&&e.type==="keydown"),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(e)}closeMenu(e){const t={type:"closeMenu"};e&&(e instanceof MouseEvent?t.mouseEvent=e:t.keyboardEvent=e),this.dispatchLocalEvent(t)}onItemActivated(){const e={type:"menuItemActivated",menuItem:this};this.dispatchLocalEvent(e)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),this.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),this.ACTIVATION_DELAY):this.deactivate()}configureDefaults(e){if(!this.menuItemComp){setTimeout(()=>this.configureDefaults(e));return}let t=this.menuItemComp.getGui();const s=this.menuItemComp.getRootElement?.();s&&(e?.suppressRootStyles||t.classList.add("ag-menu-option-custom"),t=s),this.eGui=t,this.suppressRootStyles=!!e?.suppressRootStyles,this.suppressRootStyles||(t.classList.add(this.cssClassPrefix),this.params.cssClasses?.forEach(i=>t.classList.add(i)),this.params.disabled&&t.classList.add(`${this.cssClassPrefix}-disabled`)),e?.suppressTooltip||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!e?.suppressAria,this.suppressAria||(ds(t,"treeitem"),cs(t,this.level+1),this.params.disabled&&ls(t,!0)),e?.suppressTabIndex||t.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(t,e),this.suppressFocus=!!e?.suppressFocus}refreshTooltip(e,t){this.tooltip=e,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),!(!e||!this.menuItemComp)&&(this.tooltipFeature=this.createBean(new os({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip:t})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}};import{AutoScrollService as bs,BeanStub as Is,_radioCssClass as ge}from"@ag-grid-community/core";var z="ag-list-item-hovered",ws=class extends Is{constructor(e,t,s){super(),this.comp=e,this.virtualList=t,this.params=s,this.currentDragValue=null,this.lastHoveredListItem=null}wireBeans(e){this.dragAndDropService=e.dragAndDropService}postConstruct(){this.addManagedListeners(this.params.eventSource,{[this.params.listItemDragStartEvent]:this.listItemDragStart.bind(this),[this.params.listItemDragEndEvent]:this.listItemDragEnd.bind(this)}),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(e){this.currentDragValue=this.params.getCurrentDragValue(e),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const e={isInterestedIn:t=>t===this.params.dragSourceType,getIconName:()=>this.moveBlocked?"pinned":"move",getContainer:()=>this.comp.getGui(),onDragging:t=>this.onDragging(t),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(e)}createAutoScrollService(){const e=this.virtualList.getGui();this.autoScrollService=new bs({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const t=this.getListDragItem(e),s=this.virtualList.getComponentAt(t.rowIndex);if(!s)return;const i=s.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===t.rowIndex&&this.lastHoveredListItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=t,ge(i,z),ge(i,`ag-item-highlight-${t.position}`))}getListDragItem(e){const t=this.virtualList.getGui(),s=parseFloat(window.getComputedStyle(t).paddingTop),i=this.virtualList.getRowHeight(),n=this.virtualList.getScrollTop(),a=Math.max(0,(e.y-s+n)/i),o=this.params.getNumRows(this.comp)-1,r=Math.min(o,a)|0;return{rowIndex:r,position:Math.round(a)>a||a>o?"bottom":"top",component:this.virtualList.getComponentAt(r)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${z}`).forEach(t=>{[z,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(s=>{t.classList.remove(s)})}),this.lastHoveredListItem=null}};import{KeyCode as T,RefPlaceholder as me,TabGuardComp as ys,_clearElement as Ds,_createIconNoSpan as Es,_setAriaLabel as fe,_setAriaRole as F}from"@ag-grid-community/core";function Ss(e){return`<div class="ag-tabs ${e}">
        <div data-ref="eHeader"></div>
        <div data-ref="eBody" role="presentation" class="ag-tabs-body ${e?`${e}-body`:""}"></div>
    </div>`}var Ts=class extends ys{constructor(e){super(Ss(e.cssClass)),this.eHeader=me,this.eBody=me,this.items=[],this.tabbedItemScrollMap=new Map,this.params=e}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(e=>this.addItem(e)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>this.activeItem?.tabbedItem?.afterDetachedCallback?.())}setupHeader(){const{enableCloseButton:e,cssClass:t}=this.params,s=(i,n)=>{i.classList.add(`ag-tabs-${n}`),t&&i.classList.add(`${t}-${n}`)};e?(this.setupCloseButton(s),this.eTabHeader=this.gos.getDocument().createElement("div"),s(this.eHeader,"header-wrapper"),F(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,F(this.eTabHeader,"tablist"),s(this.eTabHeader,"header")}setupCloseButton(e){const t=this.gos.getDocument(),s=t.createElement("button");e(s,"close-button");const i=Es("close",this.gos,void 0,!0);fe(s,this.params.closeButtonAriaLabel),s.appendChild(i),this.addManagedElementListeners(s,{click:()=>this.params.onCloseClicked?.()});const n=t.createElement("div");e(n,"close-button-wrapper"),F(n,"presentation"),n.appendChild(s),this.eHeader.appendChild(n),this.eCloseButton=s}handleKeyDown(e){switch(e.key){case T.RIGHT:case T.LEFT:{if(!this.eTabHeader.contains(this.gos.getActiveDomElement()))return;const t=e.key===T.RIGHT,s=this.gos.get("enableRtl"),i=this.items.indexOf(this.activeItem),n=t!==s?Math.min(i+1,this.items.length-1):Math.max(i-1,0);if(i===n)return;e.preventDefault();const a=this.items[n];this.showItemWrapper(a),a.eHeaderButton.focus();break}case T.UP:case T.DOWN:e.stopPropagation();break}}onTabKeyDown(e){if(e.defaultPrevented)return;const{focusService:t,eHeader:s,eBody:i,activeItem:n,params:a}=this,{suppressTrapFocus:o,enableCloseButton:r}=a,l=this.gos.getActiveDomElement(),h=e.target,c=e.shiftKey;if(s.contains(l)){e.preventDefault(),r&&c&&!this.eCloseButton?.contains(l)?this.eCloseButton?.focus():o&&c?this.focusService.findFocusableElementBeforeTabGuard(this.gos.getDocument().body,h)?.focus():this.focusBody(e.shiftKey);return}let d=null;if(t.isTargetUnderManagedComponent(i,h)&&(c&&(d=this.focusService.findFocusableElementBeforeTabGuard(i,h)),!d&&!o&&(d=n.eHeaderButton)),!d&&i.contains(l)&&(d=t.findNextFocusableElement(i,!1,c),!d)){o&&!c?this.forceFocusOutOfContainer(c):r&&!c?(e.preventDefault(),this.eCloseButton?.focus()):(e.preventDefault(),this.focusHeader());return}d&&(e.preventDefault(),d.focus())}focusInnerElement(e){e?this.focusBody(!0):this.focusHeader()}focusHeader(e){this.activeItem.eHeaderButton.focus({preventScroll:e})}focusBody(e){this.focusService.focusInto(this.eBody,e)}setAfterAttachedParams(e){this.afterAttachedParams=e}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(e){const t=document.createElement("span");F(t,"tab"),t.setAttribute("tabindex","-1"),t.appendChild(e.title),t.classList.add("ag-tab"),this.eTabHeader.appendChild(t),fe(t,e.titleLabel);const s={tabbedItem:e,eHeaderButton:t};this.items.push(s),t.addEventListener("click",this.showItemWrapper.bind(this,s))}showItem(e){const t=this.items.find(s=>s.tabbedItem===e);t&&this.showItemWrapper(t)}showItemWrapper(e){const{tabbedItem:t,eHeaderButton:s}=e;if(this.params.onItemClicked?.({item:t}),this.activeItem===e){this.params.onActiveItemClicked?.();return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),Ds(this.eBody),t.bodyPromise.then(i=>{this.eBody.appendChild(i);const n=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,n),t.afterAttachedCallback&&t.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const a=t.getScrollableContainer&&t.getScrollableContainer()||i;[this.lastScrollListener]=this.addManagedElementListeners(a,{scroll:()=>{this.tabbedItemScrollMap.set(t.name,a.scrollTop)}});const o=this.tabbedItemScrollMap.get(t.name);o!==void 0&&setTimeout(()=>{a.scrollTop=o},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),this.activeItem.tabbedItem.afterDetachedCallback?.()),s.classList.add("ag-tab-selected"),this.activeItem=e}};import{Component as xs,RefPlaceholder as x,_setAriaRole as Ls,_setDisplayed as Ce}from"@ag-grid-community/core";import{BeanStub as As,CheckboxSelectionComponent as Gs,KeyCode as Rs,RowDragComp as Ps,_cloneObject as Ms,_createIconNoSpan as ve,_isElementInEventPath as be,_isStopPropagationForAgGrid as Ie,_missing as Fs,_removeAriaExpanded as Os,_setAriaExpanded as Bs,_stopPropagationForAgGrid as ks,_warnOnce as we}from"@ag-grid-community/core";var ye=class extends As{wireBeans(e){this.expressionService=e.expressionService,this.valueService=e.valueService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.userComponentFactory=e.userComponentFactory,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService}init(e,t,s,i,n,a,o){this.params=o,this.eGui=t,this.eCheckbox=s,this.eExpanded=i,this.eContracted=n,this.comp=e,this.compClass=a;const{node:r,colDef:l}=o,h=this.isTopLevelFooter();if(!h){if(this.isEmbeddedRowMismatch())return;if(r.footer&&this.gos.get("groupHideOpenParents")){const d=l&&l.showRowGroup,u=r.rowGroupColumn&&r.rowGroupColumn.getColId();if(d!==u)return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!h){const c=o.node.footer&&o.node.rowGroupIndex===this.funcColsService.getRowGroupColumns().findIndex(O=>O.getColId()===o.colDef?.showRowGroup),u=this.gos.get("groupDisplayType")!="multipleColumns"||this.gos.get("treeData")||this.gos.get("showOpenedGroup")&&!o.node.footer&&(!o.node.group||o.node.rowGroupIndex!=null&&o.node.rowGroupIndex>this.funcColsService.getRowGroupColumns().findIndex(O=>O.getColId()===o.colDef?.showRowGroup)),f=!r.group&&(this.params.colDef?.field||this.params.colDef?.valueGetter),C=this.isExpandable(),b=this.columnModel.isPivotMode()&&r.leafGroup&&r.rowGroupColumn?.getColId()===o.column?.getColDef().showRowGroup;if(!this.showingValueForOpenedParent&&!C&&!f&&!u&&!c&&!b)return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){const e=this.params.colDef?.cellAriaRole,t=this.params.column?.getColDef().cellAriaRole;return e||t||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:e,eGridCell:t}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable()){Os(t);return}const s=()=>{Bs(t,!!e.expanded)};[this.expandListener]=this.addManagedListeners(e,{expandedChanged:s})||null,s()}isTopLevelFooter(){if(!this.gos.getGrandTotalRow()||this.params.value!=null||this.params.node.level!=-1)return!1;const t=this.params.colDef;if(t==null||t.showRowGroup===!0)return!0;const i=this.funcColsService.getRowGroupColumns();return!i||i.length===0?!0:i[0].getId()===t.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const e=this.params.pinned==="left",t=this.params.pinned==="right",s=!e&&!t;return this.gos.get("enableRtl")?this.visibleColsService.isPinningLeft()?!t:!s:this.visibleColsService.isPinningLeft()?!e:!s}findDisplayedGroupNode(){const e=this.params.column,t=this.params.node;if(this.showingValueForOpenedParent){let s=t.parent;for(;s!=null;){if(s.rowGroupColumn&&e.isRowGroupDisplayed(s.rowGroupColumn.getId())){this.displayedGroupNode=s;break}s=s.parent}}Fs(this.displayedGroupNode)&&(this.displayedGroupNode=t)}setupShowingValueForOpenedParent(){const e=this.params.node,t=this.params.column;if(!this.gos.get("groupHideOpenParents")){this.showingValueForOpenedParent=!1;return}if(!e.groupData){this.showingValueForOpenedParent=!1;return}if(e.rowGroupColumn!=null){const n=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(n)){this.showingValueForOpenedParent=!1;return}}const i=e.groupData[t.getId()]!=null;this.showingValueForOpenedParent=i}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){const e=this.adjustParamsWithDetailsFromRelatedColumn(),t=this.getInnerCompDetails(e),{valueFormatted:s,value:i}=e;let n=s;if(n==null){const a=this.displayedGroupNode.rowGroupColumn&&this.params.column?.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId());this.displayedGroupNode.key===""&&this.displayedGroupNode.group&&a?n=this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):n=i??null}this.comp.setInnerRenderer(t,n)}adjustParamsWithDetailsFromRelatedColumn(){const e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(t!=null&&!t.isRowGroupDisplayed(e.getId()))return this.params;const i=this.params,{value:n,node:a}=this.params,o=this.valueService.formatValue(e,a,n);return{...i,valueFormatted:o}}addFooterValue(){let e=this.params.totalValueGetter;if(!e){const i=this.params.footerValueGetter;i&&(e=i,we("As of v31.3, footerValueGetter is deprecated. Use `totalValueGetter` instead."))}let t="";if(e){const i=Ms(this.params);i.value=this.params.value,typeof e=="function"?t=e(i):typeof e=="string"?t=this.expressionService.evaluate(e,i):we("footerValueGetter should be either a function or a string (expression)")}else t=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(this.params.value!=null?this.params.value:"");const s=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(s,t)}getInnerCompDetails(e){if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gos.get("groupRowRendererParams"),e);const t=this.userComponentFactory.getInnerRendererDetails(e,e),s=o=>o&&o.componentClass==this.compClass;if(t&&!s(t))return t;const i=this.displayedGroupNode.rowGroupColumn,n=i?i.getColDef():void 0;if(!n)return;const a=this.userComponentFactory.getCellRendererDetails(n,e);if(a&&!s(a))return a;if(s(a)&&n.cellRendererParams&&n.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(n.cellRendererParams,e)}addChildCount(){this.params.suppressCount||(this.addManagedListeners(this.displayedGroupNode,{allChildrenCountChanged:this.updateChildCount.bind(this)}),this.updateChildCount())}updateChildCount(){const e=this.displayedGroupNode.allChildrenCount,i=this.isShowRowGroupForThisRow()&&e!=null&&e>=0?`(${e})`:"";this.comp.setChildCount(i)}isShowRowGroupForThisRow(){if(this.gos.get("treeData"))return!0;const e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;const t=this.params.column;return t==null||t.isRowGroupDisplayed(e.getId())}addExpandAndContract(){const e=this.params,t=ve("groupExpanded",this.gos,null),s=ve("groupContracted",this.gos,null);t&&this.eExpanded.appendChild(t),s&&this.eContracted.appendChild(s);const i=e.eGridCell;!(this.params.column?.isCellEditable(e.node)&&this.gos.get("enableGroupEdit"))&&this.isExpandable()&&!e.suppressDoubleClickExpand&&this.addManagedListeners(i,{dblclick:this.onCellDblClicked.bind(this)}),this.addManagedListeners(this.eExpanded,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(this.eContracted,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(i,{keydown:this.onKeyDown.bind(this)}),this.addManagedListeners(e.node,{expandedChanged:this.showExpandAndContractIcons.bind(this)}),this.showExpandAndContractIcons();const a=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListeners(this.displayedGroupNode,{allChildrenCountChanged:a,masterChanged:a,groupChanged:a,hasChildrenChanged:a})}onExpandClicked(e){Ie(e)||(ks(e),this.onExpandOrContract(e))}onExpandOrContract(e){const t=this.displayedGroupNode,s=!t.expanded;!s&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(s,e)}scrollToStickyNode(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;const i=this.params.column;return i!=null&&typeof i.getColDef().showRowGroup=="string"?this.isShowRowGroupForThisRow():!0}showExpandAndContractIcons(){const{params:e,displayedGroupNode:t,columnModel:s}=this,{node:i}=e,n=this.isExpandable();if(n){const h=this.showingValueForOpenedParent?!0:i.expanded;this.comp.setExpandedDisplayed(h),this.comp.setContractedDisplayed(!h)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const a=s.isPivotMode(),o=a&&t.leafGroup,r=n&&!o,l=i.footer&&i.level===-1;this.comp.addOrRemoveCssClass("ag-cell-expandable",r),this.comp.addOrRemoveCssClass("ag-row-group",r),a?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",!!o):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!r)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const e=this.params.node;this.params.suppressPadding||(this.addManagedListeners(e,{uiLevelChanged:this.setIndent.bind(this)}),this.setIndent())}setIndent(){if(this.gos.get("groupHideOpenParents"))return;const e=this.params,t=e.node,s=!!e.colDef,i=this.gos.get("treeData"),a=!s||i||e.colDef.showRowGroup===!0?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+a,this.comp.addOrRemoveCssClass(this.indentClass,!0),this.eGui.style.setProperty("--ag-indentation-level",String(a))}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const e=new Ps(()=>this.params.value,this.params.node);this.createManagedBean(e),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}isUserWantsSelected(){const e=this.params.checkbox;return typeof e=="function"||e===!0}addCheckboxIfNeeded(){const e=this.displayedGroupNode,t=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(t){const s=new Gs;this.createBean(s),s.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(s.getGui()),this.addDestroyFunc(()=>this.destroyBean(s))}this.comp.setCheckboxVisible(t)}onKeyDown(e){!(e.key===Rs.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(Ie(e))return;be(this.eExpanded,e)||be(this.eContracted,e)||this.onExpandOrContract(e)}},Ns=`<span class="ag-cell-wrapper">
        <span class="ag-group-expanded" data-ref="eExpanded"></span>
        <span class="ag-group-contracted" data-ref="eContracted"></span>
        <span class="ag-group-checkbox ag-invisible" data-ref="eCheckbox"></span>
        <span class="ag-group-value" data-ref="eValue"></span>
        <span class="ag-group-child-count" data-ref="eChildCount"></span>
    </span>`,Hs=class extends xs{constructor(){super(Ns),this.eExpanded=x,this.eContracted=x,this.eCheckbox=x,this.eValue=x,this.eChildCount=x}init(e){const t={setInnerRenderer:(a,o)=>this.setRenderDetails(a,o),setChildCount:a=>this.eChildCount.textContent=a,addOrRemoveCssClass:(a,o)=>this.addOrRemoveCssClass(a,o),setContractedDisplayed:a=>Ce(this.eContracted,a),setExpandedDisplayed:a=>Ce(this.eExpanded,a),setCheckboxVisible:a=>this.eCheckbox.classList.toggle("ag-invisible",!a)},s=this.createManagedBean(new ye),i=!e.colDef,n=this.getGui();s.init(t,n,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),i&&Ls(n,s.getCellAriaRole())}setRenderDetails(e,t){if(e){const s=e.newAgStackInstance();if(s==null)return;s.then(i=>{if(!i)return;const n=()=>this.destroyBean(i);this.isAlive()?(this.eValue.appendChild(i.getGui()),this.addDestroyFunc(n)):n()})}else this.eValue.innerText=t}destroy(){this.destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}};export{ns as AgDialog,q as AgGroupComponent,Ke as AgGroupComponentSelector,_ as AgMenuItemComponent,U as AgMenuItemRenderer,ue as AgMenuList,pe as AgMenuPanel,ce as AgPanel,Lt as AgRichSelect,ke as EnterpriseCoreModule,Hs as GroupCellRenderer,ye as GroupCellRendererCtrl,K as LicenseManager,Ot as PillDragComp,qt as PillDropZonePanel,Ts as TabbedLayout,X as VirtualList,ws as VirtualListDragFeature};
