/**
          * @ag-grid-enterprise/range-selection - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.1.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/range-selection - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.1.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
import{Events as e,AutoScrollService as t,Constants as n,_ as o,Autowired as i,PostConstruct as r,Bean as l,BeanStub as s,SelectionHandleType as a,Component as c,CellRangeType as u,ModuleNames as d}from"@ag-grid-community/core";import{EnterpriseCoreModule as g}from"@ag-grid-enterprise/core";var h,p=(h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f=function(e,t,n,o){var i,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},v=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)l.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return l},w=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e},R=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},m=function(s){function a(){var e=null!==s&&s.apply(this,arguments)||this;return e.cellRanges=[],e.bodyScrollListener=e.onBodyScroll.bind(e),e.dragging=!1,e}return p(a,s),a.prototype.init=function(){var o=this;this.addManagedListener(this.eventService,e.EVENT_NEW_COLUMNS_LOADED,(function(){return o.removeAllCellRanges()})),this.addManagedListener(this.eventService,e.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){return o.removeAllCellRanges()})),this.addManagedListener(this.eventService,e.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return o.removeAllCellRanges()})),this.addManagedListener(this.eventService,e.EVENT_COLUMN_PIVOT_CHANGED,(function(){return o.removeAllCellRanges()})),this.addManagedListener(this.eventService,e.EVENT_COLUMN_GROUP_OPENED,this.refreshLastRangeStart.bind(this)),this.addManagedListener(this.eventService,e.EVENT_COLUMN_MOVED,this.refreshLastRangeStart.bind(this)),this.addManagedListener(this.eventService,e.EVENT_COLUMN_PINNED,this.refreshLastRangeStart.bind(this)),this.addManagedListener(this.eventService,e.EVENT_COLUMN_VISIBLE,this.onColumnVisibleChange.bind(this)),this.ctrlsService.whenReady((function(){var e=o.ctrlsService.getGridBodyCtrl();o.autoScrollService=new t({scrollContainer:e.getBodyViewportElement(),scrollAxis:"xy",getVerticalPosition:function(){return e.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(t){return e.getScrollFeature().setVerticalScrollPosition(t)},getHorizontalPosition:function(){return e.getScrollFeature().getHScrollPosition().left},setHorizontalPosition:function(t){return e.getScrollFeature().setHorizontalScrollPosition(t)},shouldSkipVerticalScroll:function(){return o.gridOptionsWrapper.getDomLayout()!==n.DOM_LAYOUT_NORMAL},shouldSkipHorizontalScroll:function(){return e.getScrollFeature().isHorizontalScrollShowing()}})}))},a.prototype.onColumnVisibleChange=function(){var e=this;this.refreshLastRangeStart(),this.cellRanges.forEach((function(t){var n=t.columns;t.columns=t.columns.filter((function(e){return e.isVisible()})),!o.areEqual(n,t.columns)&&e.dispatchChangedEvent(!1,!0,t.id)}))},a.prototype.refreshLastRangeStart=function(){var e=o.last(this.cellRanges);e&&this.refreshRangeStart(e)},a.prototype.isContiguousRange=function(e){var t=e.columns;if(!t.length)return!1;var n=this.columnModel.getAllDisplayedColumns(),i=t.map((function(e){return n.indexOf(e)})).sort((function(e,t){return e-t}));return o.last(i)-i[0]+1===t.length},a.prototype.getRangeStartRow=function(e){return e.startRow&&e.endRow?this.rowPositionUtils.before(e.startRow,e.endRow)?e.startRow:e.endRow:{rowIndex:0,rowPinned:this.pinnedRowModel.getPinnedTopRowCount()>0?n.PINNED_TOP:null}},a.prototype.getRangeEndRow=function(e){if(e.startRow&&e.endRow)return this.rowPositionUtils.before(e.startRow,e.endRow)?e.endRow:e.startRow;var t=this.pinnedRowModel.getPinnedBottomRowCount();return t>0?{rowIndex:t-1,rowPinned:n.PINNED_BOTTOM}:{rowIndex:this.rowModel.getRowCount()-1,rowPinned:null}},a.prototype.setRangeToCell=function(e,t){if(void 0===t&&(t=!1),this.gridOptionsWrapper.isEnableRangeSelection()){var n=this.calculateColumnsBetween(e.column,e.column);if(n){(this.gridOptionsWrapper.isSuppressMultiRangeSelection()||!t||o.missing(this.cellRanges))&&this.removeAllCellRanges(!0);for(var i,r={rowIndex:e.rowIndex,rowPinned:e.rowPinned},l=0;l<this.cellRanges.length;l++){var s=this.cellRanges[l];if(s.columns&&1===s.columns.length&&s.columns[0]===e.column&&this.rowPositionUtils.sameRow(r,s.startRow)&&this.rowPositionUtils.sameRow(r,s.endRow)){i=s;break}}i?o.last(this.cellRanges)!==i&&(o.removeFromArray(this.cellRanges,i),this.cellRanges.push(i)):(i={startRow:r,endRow:r,columns:n,startColumn:e.column},this.cellRanges.push(i)),this.newestRangeStartCell=e,this.onDragStop(),this.dispatchChangedEvent(!0,!0,i.id)}}},a.prototype.extendLatestRangeToCell=function(e){if(!this.isEmpty()&&this.newestRangeStartCell){var t=o.last(this.cellRanges);this.updateRangeEnd(t,e)}},a.prototype.updateRangeEnd=function(e,t,n){void 0===n&&(n=!1);var o=t.column,i=this.calculateColumnsBetween(e.startColumn,o);i&&!this.isLastCellOfRange(e,t)&&(e.columns=i,e.endRow={rowIndex:t.rowIndex,rowPinned:t.rowPinned},n||this.dispatchChangedEvent(!0,!0,e.id))},a.prototype.refreshRangeStart=function(e){var t=e.startColumn,n=e.columns,i=function(t,n){var o=e.columns.filter((function(e){return e!==t}));t?(e.startColumn=t,e.columns=n?w([t],o):w(o,[t])):e.columns=o},r=this.getRangeEdgeColumns(e),l=r.left,s=r.right;t===n[0]&&t!==l?i(l,!0):t===o.last(n)&&t===s&&i(s,!1)},a.prototype.getRangeEdgeColumns=function(e){var t=this.columnModel.getAllDisplayedColumns(),n=e.columns.map((function(e){return t.indexOf(e)})).filter((function(e){return e>-1})).sort((function(e,t){return e-t}));return{left:t[n[0]],right:t[o.last(n)]}},a.prototype.extendLatestRangeInDirection=function(e){if(!this.isEmpty()&&this.newestRangeStartCell){var t=o.last(this.cellRanges),n=this.newestRangeStartCell,i=t.columns[0],r=o.last(t.columns),l=t.endRow.rowIndex,s=t.endRow.rowPinned,a={column:n.column===i?r:i,rowIndex:l,rowPinned:s},c=this.cellNavigationService.getNextCellToFocus(e,a);if(c)return this.setCellRange({rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:c.rowIndex,rowEndPinned:c.rowPinned,columnStart:n.column,columnEnd:c.column}),c}},a.prototype.setCellRange=function(e){this.gridOptionsWrapper.isEnableRangeSelection()&&(this.removeAllCellRanges(!0),this.addCellRange(e))},a.prototype.setCellRanges=function(e){var t=this;o.shallowCompare(this.cellRanges,e)||(this.removeAllCellRanges(!0),e.forEach((function(e){e.columns&&e.startRow&&(t.newestRangeStartCell={rowIndex:e.startRow.rowIndex,rowPinned:e.startRow.rowPinned,column:e.columns[0]}),t.cellRanges.push(e)})),this.dispatchChangedEvent(!1,!0))},a.prototype.createCellRangeFromCellRangeParams=function(e){var t,n=this;if(e.columns)t=e.columns.map((function(e){return n.columnModel.getColumnWithValidation(e)})).filter((function(e){return e}));else{var o=this.columnModel.getColumnWithValidation(e.columnStart),i=this.columnModel.getColumnWithValidation(e.columnEnd);if(!o||!i)return;t=this.calculateColumnsBetween(o,i)}if(t)return{startRow:null!=e.rowStartIndex?{rowIndex:e.rowStartIndex,rowPinned:e.rowStartPinned||null}:void 0,endRow:null!=e.rowEndIndex?{rowIndex:e.rowEndIndex,rowPinned:e.rowEndPinned||null}:void 0,columns:t,startColumn:t[0]}},a.prototype.addCellRange=function(e){if(this.gridOptionsWrapper.isEnableRangeSelection()){var t=this.createCellRangeFromCellRangeParams(e);t&&(this.cellRanges.push(t),this.dispatchChangedEvent(!1,!0,t.id))}},a.prototype.getCellRanges=function(){return this.cellRanges},a.prototype.isEmpty=function(){return 0===this.cellRanges.length},a.prototype.isMoreThanOneCell=function(){var e=this.cellRanges.length;if(1!==e)return 0!==e;var t=this.cellRanges[0],n=this.getRangeStartRow(t),o=this.getRangeEndRow(t);return n.rowPinned!==o.rowPinned||n.rowIndex!==o.rowIndex||1!==t.columns.length},a.prototype.areAllRangesAbleToMerge=function(){var e,t,n,o=this,i=new Map;if(this.cellRanges.length<=1)return!0;this.cellRanges.forEach((function(e){for(var t=o.getRangeStartRow(e),n=o.getRangeEndRow(e),r=t,l=function(){var t=(r.rowPinned||"normal")+"_"+r.rowIndex,l=i.get(t),s=e.columns.map((function(e){return e.getId()}));if(l){var a=s.filter((function(e){return-1===l.indexOf(e)}));l.push.apply(l,w(a))}else i.set(t,s);if(o.rowPositionUtils.sameRow(r,n))return"break";r=o.cellNavigationService.getRowBelow(r)};r;){if("break"===l())break}}));try{for(var r=R(i.values()),l=r.next();!l.done;l=r.next()){var s=l.value.sort().join();if(void 0!==n){if(n!==s)return!1}else n=s}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return!0},a.prototype.removeAllCellRanges=function(e){this.isEmpty()||(this.onDragStop(),this.cellRanges.length=0,e||this.dispatchChangedEvent(!1,!0))},a.prototype.onBodyScroll=function(){this.onDragging(this.lastMouseEvent)},a.prototype.isCellInAnyRange=function(e){return this.getCellRangeCount(e)>0},a.prototype.isCellInSpecificRange=function(e,t){var n=null!==t.columns&&o.includes(t.columns,e.column),i=this.isRowInRange(e.rowIndex,e.rowPinned,t);return n&&i},a.prototype.isLastCellOfRange=function(e,t){var n=e.startRow,i=e.endRow,r=this.rowPositionUtils.before(n,i)?i:n,l=t.rowIndex===r.rowIndex&&t.rowPinned===r.rowPinned,s=e.columns[0],a=o.last(e.columns),c=e.startColumn===s?a:s;return t.column===c&&l},a.prototype.isBottomRightCell=function(e,t){var n=this.columnModel.getAllDisplayedColumns(),i=e.columns.map((function(e){return n.indexOf(e)})).sort((function(e,t){return e-t})),r=e.startRow,l=e.endRow,s=this.rowPositionUtils.before(r,l)?l:r,a=n.indexOf(t.column)===o.last(i),c=t.rowIndex===s.rowIndex&&o.makeNull(t.rowPinned)===o.makeNull(s.rowPinned);return a&&c},a.prototype.getCellRangeCount=function(e){var t=this;return this.isEmpty()?0:this.cellRanges.filter((function(n){return t.isCellInSpecificRange(e,n)})).length},a.prototype.isRowInRange=function(e,t,n){var o=this.getRangeStartRow(n),i=this.getRangeEndRow(n),r={rowIndex:e,rowPinned:t||null},l=r.rowIndex===o.rowIndex&&r.rowPinned==o.rowPinned,s=r.rowIndex===i.rowIndex&&r.rowPinned==i.rowPinned;if(l||s)return!0;var a=!this.rowPositionUtils.before(r,o),c=this.rowPositionUtils.before(r,i);return a&&c},a.prototype.getDraggingRange=function(){return this.draggingRange},a.prototype.onDragStart=function(e){if(this.gridOptionsWrapper.isEnableRangeSelection()){var t=e.ctrlKey,n=e.metaKey,i=e.shiftKey,r=t||n,l=!!!this.gridOptionsWrapper.isSuppressMultiRangeSelection()&&r,s=i&&o.existsAndNotEmpty(this.cellRanges);if(l||s&&!o.exists(o.last(this.cellRanges).type)||this.removeAllCellRanges(!0),this.cellHoverListener=this.addManagedListener(this.ctrlsService.getGridCtrl().getGui(),"mousemove",this.updateValuesOnMove.bind(this)),this.updateValuesOnMove(e),this.lastCellHovered){if(this.dragging=!0,this.draggingCell=this.lastCellHovered,this.lastMouseEvent=e,s||(this.newestRangeStartCell=this.lastCellHovered),this.cellRanges.length>0)this.draggingRange=o.last(this.cellRanges);else{var a={rowIndex:this.lastCellHovered.rowIndex,rowPinned:this.lastCellHovered.rowPinned};this.draggingRange={startRow:a,endRow:a,columns:[this.lastCellHovered.column],startColumn:this.newestRangeStartCell.column},this.cellRanges.push(this.draggingRange)}this.ctrlsService.getGridBodyCtrl().addScrollEventListener(this.bodyScrollListener),this.dispatchChangedEvent(!0,!1,this.draggingRange.id)}}},a.prototype.updateValuesOnMove=function(e){var t=this.mouseEventService.getCellPositionForEvent(e);this.cellHasChanged=!1,!t||this.lastCellHovered&&this.cellPositionUtils.equals(t,this.lastCellHovered)||(this.lastCellHovered&&(this.cellHasChanged=!0),this.lastCellHovered=t)},a.prototype.onDragging=function(e){var t=this;if(this.dragging&&e){var n=this.lastCellHovered,o=function(e){return n&&n.rowPinned===e&&t.newestRangeStartCell.rowPinned===e},i=o("top")||o("bottom");if(this.autoScrollService.check(e,i),this.cellHasChanged){var r=this.calculateColumnsBetween(this.newestRangeStartCell.column,n.column);r&&(this.draggingCell=n,this.draggingRange.endRow={rowIndex:n.rowIndex,rowPinned:n.rowPinned},this.draggingRange.columns=r,this.dispatchChangedEvent(!1,!1,this.draggingRange.id))}}},a.prototype.onDragStop=function(){if(this.cellHoverListener&&(this.cellHoverListener(),this.cellHoverListener=void 0),this.dragging){var e=this.draggingRange.id;this.autoScrollService.ensureCleared(),this.ctrlsService.getGridBodyCtrl().removeScrollEventListener(this.bodyScrollListener),this.lastMouseEvent=null,this.dragging=!1,this.draggingRange=void 0,this.draggingCell=void 0,this.lastCellHovered=void 0,this.dispatchChangedEvent(!1,!0,e)}},a.prototype.dispatchChangedEvent=function(t,n,o){var i=Object.freeze({type:e.EVENT_RANGE_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi,started:t,finished:n,id:o});this.eventService.dispatchEvent(i)},a.prototype.calculateColumnsBetween=function(e,t){var n=this.columnModel.getAllDisplayedColumns(),o=e===t,i=n.indexOf(e);if(i<0)console.warn("AG Grid: column "+e.getId()+" is not visible");else{var r=o?i:n.indexOf(t);if(!(r<0)){if(o)return[e];for(var l=Math.min(i,r),s=l===i?r:i,a=[],c=l;c<=s;c++)a.push(n[c]);return a}console.warn("AG Grid: column "+t.getId()+" is not visible")}},f([i("rowModel")],a.prototype,"rowModel",void 0),f([i("columnModel")],a.prototype,"columnModel",void 0),f([i("mouseEventService")],a.prototype,"mouseEventService",void 0),f([i("columnApi")],a.prototype,"columnApi",void 0),f([i("gridApi")],a.prototype,"gridApi",void 0),f([i("cellNavigationService")],a.prototype,"cellNavigationService",void 0),f([i("pinnedRowModel")],a.prototype,"pinnedRowModel",void 0),f([i("rowPositionUtils")],a.prototype,"rowPositionUtils",void 0),f([i("cellPositionUtils")],a.prototype,"cellPositionUtils",void 0),f([i("ctrlsService")],a.prototype,"ctrlsService",void 0),f([r],a.prototype,"init",null),a=f([l("rangeService")],a)}(s),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(e,t,n,o){var i,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changedCalculatedValues=!1,t.dragging=!1,t.shouldDestroyOnEndDragging=!1,t}return y(t,e),t.prototype.init=function(){var e=this;this.dragService.addDragSource({dragStartPixels:0,eElement:this.getGui(),onDragStart:this.onDragStart.bind(this),onDragging:function(t){e.dragging=!0,e.rangeService.autoScrollService.check(t),e.changedCalculatedValues&&(e.onDrag(t),e.changedCalculatedValues=!1)},onDragStop:function(t){e.dragging=!1,e.onDragEnd(t),e.clearValues(),e.rangeService.autoScrollService.ensureCleared(),document.body.classList.remove(e.getDraggingCssClass()),e.shouldDestroyOnEndDragging&&e.destroy()}}),this.addManagedListener(this.getGui(),"mousedown",this.preventRangeExtension.bind(this))},t.prototype.isDragging=function(){return this.dragging},t.prototype.getCellCtrl=function(){return this.cellCtrl},t.prototype.setCellCtrl=function(e){this.cellCtrl=e},t.prototype.getCellRange=function(){return this.cellRange},t.prototype.setCellRange=function(e){this.cellRange=e},t.prototype.getRangeStartRow=function(){return this.rangeStartRow},t.prototype.setRangeStartRow=function(e){this.rangeStartRow=e},t.prototype.getRangeEndRow=function(){return this.rangeEndRow},t.prototype.setRangeEndRow=function(e){this.rangeEndRow=e},t.prototype.getLastCellHovered=function(){return this.lastCellHovered},t.prototype.preventRangeExtension=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.onDragStart=function(e){this.cellHoverListener=this.addManagedListener(this.ctrlsService.getGridCtrl().getGui(),"mousemove",this.updateValuesOnMove.bind(this)),document.body.classList.add(this.getDraggingCssClass())},t.prototype.getDraggingCssClass=function(){return"ag-dragging-"+(this.type===a.FILL?"fill":"range")+"-handle"},t.prototype.updateValuesOnMove=function(e){var t=this.mouseEventService.getCellPositionForEvent(e);!t||this.lastCellHovered&&this.cellPositionUtils.equals(t,this.lastCellHovered)||(this.lastCellHovered=t,this.changedCalculatedValues=!0)},t.prototype.getType=function(){return this.type},t.prototype.refresh=function(e){var t=this.getCellCtrl(),n=this.getGui(),i=o.last(this.rangeService.getCellRanges()),r=i.startRow,l=i.endRow;r&&l&&(this.rowPositionUtils.before(l,r)?(this.setRangeStartRow(l),this.setRangeEndRow(r)):(this.setRangeStartRow(r),this.setRangeEndRow(l)));if(t!==e||!o.isVisible(n)){this.setCellCtrl(e);var s=e.getComp().getParentOfValue();s&&s.appendChild(n)}this.setCellRange(i)},t.prototype.clearValues=function(){this.lastCellHovered=void 0,this.removeListeners()},t.prototype.removeListeners=function(){this.cellHoverListener&&(this.cellHoverListener(),this.cellHoverListener=void 0)},t.prototype.destroy=function(){if(!this.shouldDestroyOnEndDragging&&this.isDragging())return o.setDisplayed(this.getGui(),!1),void(this.shouldDestroyOnEndDragging=!0);this.shouldDestroyOnEndDragging=!1,e.prototype.destroy.call(this),this.removeListeners();var t=this.getGui();t.parentElement&&t.parentElement.removeChild(t)},C([i("rowRenderer")],t.prototype,"rowRenderer",void 0),C([i("dragService")],t.prototype,"dragService",void 0),C([i("rangeService")],t.prototype,"rangeService",void 0),C([i("mouseEventService")],t.prototype,"mouseEventService",void 0),C([i("columnModel")],t.prototype,"columnModel",void 0),C([i("cellNavigationService")],t.prototype,"cellNavigationService",void 0),C([i("navigationService")],t.prototype,"navigationService",void 0),C([i("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),C([i("cellPositionUtils")],t.prototype,"cellPositionUtils",void 0),C([i("ctrlsService")],t.prototype,"ctrlsService",void 0),C([r],t.prototype,"init",null),t}(c),P=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=function(){return(E=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},O=function(e,t,n,o){var i,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},x=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)l.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return l},b=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(x(arguments[t]));return e},I=function(t){function n(){var e=t.call(this,n.TEMPLATE)||this;return e.markedCells=[],e.cellValues=[],e.isUp=!1,e.isLeft=!1,e.isReduce=!1,e.type=a.FILL,e}return P(n,t),n.prototype.updateValuesOnMove=function(e){t.prototype.updateValuesOnMove.call(this,e),this.initialXY||(this.initialXY=this.mouseEventService.getNormalisedPosition(e));var n,o=this.initialXY,i=o.x,r=o.y,l=this.mouseEventService.getNormalisedPosition(e),s=l.x,a=l.y,c=Math.abs(i-s),u=Math.abs(r-a),d=this.gridOptionsWrapper.getFillHandleDirection();(n="xy"===d?c>u?"x":"y":d)!==this.dragAxis&&(this.dragAxis=n,this.changedCalculatedValues=!0)},n.prototype.onDrag=function(e){if(!this.initialPosition){var t=this.getCellCtrl();if(!t)return;this.initialPosition=t.getCellPosition()}var n=this.getLastCellHovered();n&&this.markPathFrom(this.initialPosition,n)},n.prototype.onDragEnd=function(e){if(this.initialXY=null,this.markedCells.length){var t,n="x"===this.dragAxis,o=this.getCellRange(),i=o.columns.length,r=this.getRangeStartRow(),l=this.getRangeEndRow();if(this.isUp||this.isLeft){var s=n?r:this.lastCellMarked;t=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,columnStart:n?this.lastCellMarked.column:o.columns[0],rowEndIndex:l.rowIndex,rowEndPinned:l.rowPinned,columnEnd:o.columns[i-1]})}else t=this.rangeService.createCellRangeFromCellRangeParams({rowStartIndex:r.rowIndex,rowStartPinned:r.rowPinned,columnStart:o.columns[0],rowEndIndex:n?l.rowIndex:this.lastCellMarked.rowIndex,rowEndPinned:n?l.rowPinned:this.lastCellMarked.rowPinned,columnEnd:n?this.lastCellMarked.column:o.columns[i-1]});t&&(this.raiseFillStartEvent(),this.handleValueChanged(o,t,e),this.rangeService.setCellRanges([t]),this.raiseFillEndEvent(o,t))}},n.prototype.raiseFillStartEvent=function(){var t={type:e.EVENT_FILL_START,columnApi:this.gridOptionsWrapper.getColumnApi(),api:this.gridOptionsWrapper.getApi()};this.eventService.dispatchEvent(t)},n.prototype.raiseFillEndEvent=function(t,n){var o={type:e.EVENT_FILL_END,columnApi:this.gridOptionsWrapper.getColumnApi(),api:this.gridOptionsWrapper.getApi(),initialRange:t,finalRange:n};this.eventService.dispatchEvent(o)},n.prototype.handleValueChanged=function(e,t,n){var i=this,r=this.rangeService.getRangeEndRow(e),l=this.rangeService.getRangeStartRow(e),s=this.rangeService.getRangeEndRow(t),a=this.rangeService.getRangeStartRow(t),c="y"===this.dragAxis;if(!this.isReduce||this.gridOptionsWrapper.isSuppressClearOnFillReduction()){var u=!0,d=[],g=[],h=0,p=function(){d.length=0,g.length=0,h=0},f=function(t,n){var g=i.isUp?r:l,h=!1;c&&(u=!0,p());for(var f=function(){var f=i.rowPositionUtils.getRowNode(g);if(!f)return"break";c&&t?v(d,t,f,(function(){return!i.rowPositionUtils.sameRow(g,i.isUp?l:r)})):n&&(u=!0,p(),n.forEach((function(t){return v(d,t,f,(function(){return t!==(i.isLeft?e.columns[0]:o.last(e.columns))}))}))),h=i.rowPositionUtils.sameRow(g,i.isUp?a:s),g=i.isUp?i.cellNavigationService.getRowAbove(g):i.cellNavigationService.getRowBelow(g)};!h&&g;){if("break"===f())break}},v=function(e,t,o,r){var l,s=!1;if(u)l=i.valueService.getValue(t,o),g.push(l),u=r();else{var a=i.processValues(n,e,g,t,o,h++),c=a.value,d=a.fromUserFunction;if(l=c,t.isCellEditable(o)){var p=i.valueService.getValue(t,o);d&&p===l?s=!0:o.setDataValue(t,l)}}s||e.push(l)};if(c)e.columns.forEach((function(e){f(e)}));else{w=this.isLeft?b(t.columns).reverse():t.columns;f(void 0,w)}}else{var w=c?e.columns:e.columns.filter((function(e){return t.columns.indexOf(e)<0})),R=c?this.cellNavigationService.getRowBelow(s):a;R&&this.clearCellsInRange(R,r,w)}},n.prototype.clearCellsInRange=function(e,t,n){for(var o=e,i=!1,r=function(){var e=l.rowPositionUtils.getRowNode(o);if(!e)return"break";n.forEach((function(t){t.isCellEditable(e)&&e.setDataValue(t,null)})),i=l.rowPositionUtils.sameRow(o,t),o=l.cellNavigationService.getRowBelow(o)},l=this;!i&&o;){if("break"===r())break}},n.prototype.processValues=function(e,t,n,i,r,l){var s,a=this.gridOptionsWrapper.getFillOperation();if(s="y"===this.dragAxis?this.isUp?"up":"down":this.isLeft?"left":"right",a){var c=a({event:e,values:t,initialValues:n,currentIndex:l,currentCellValue:this.valueService.getValue(i,r),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),direction:s,column:i,rowNode:r});if(!1!==c)return{value:c,fromUserFunction:!0}}var u=!t.some((function(e){var t=parseFloat(e);return isNaN(t)||t.toString()!==e.toString()}));if(e.altKey||!u){if(u&&1===n.length){var d=this.isUp||this.isLeft?-1:1;return{value:parseFloat(o.last(t))+1*d,fromUserFunction:!1}}return{value:t[l%t.length],fromUserFunction:!1}}return{value:o.last(o.findLineByLeastSquares(t.map(Number))),fromUserFunction:!1}},n.prototype.clearValues=function(){this.clearMarkedPath(),this.clearCellValues(),this.lastCellMarked=void 0,t.prototype.clearValues.call(this)},n.prototype.clearMarkedPath=function(){this.markedCells.forEach((function(e){var t=e.getComp();t.addOrRemoveCssClass("ag-selection-fill-top",!1),t.addOrRemoveCssClass("ag-selection-fill-right",!1),t.addOrRemoveCssClass("ag-selection-fill-bottom",!1),t.addOrRemoveCssClass("ag-selection-fill-left",!1)})),this.markedCells.length=0,this.isUp=!1,this.isLeft=!1,this.isReduce=!1},n.prototype.clearCellValues=function(){this.cellValues.length=0},n.prototype.markPathFrom=function(e,t){if(this.clearMarkedPath(),this.clearCellValues(),"y"===this.dragAxis){if(this.rowPositionUtils.sameRow(t,e))return;var n=this.rowPositionUtils.before(t,e),o=this.getRangeStartRow(),i=this.getRangeEndRow();n&&(t.rowPinned==o.rowPinned&&t.rowIndex>=o.rowIndex||o.rowPinned!=i.rowPinned&&t.rowPinned==i.rowPinned&&t.rowIndex<=i.rowIndex)?(this.reduceVertical(e,t),this.isReduce=!0):(this.extendVertical(e,t,n),this.isReduce=!1)}else{var r=e.column,l=t.column;if(r===l)return;var s=this.columnModel.getAllDisplayedColumns(),a=s.indexOf(r),c=s.indexOf(l);c<=a&&c>=s.indexOf(this.getCellRange().columns[0])?(this.reduceHorizontal(e,t),this.isReduce=!0):(this.extendHorizontal(e,t,c<a),this.isReduce=!1)}this.lastCellMarked=t},n.prototype.extendVertical=function(e,t,n){var o=this.navigationService,i=this.rangeService,r=e;do{for(var l=this.getCellRange(),s=l.columns.length,a=0;a<s;a++){var c=l.columns[a],u={rowIndex:r.rowIndex,rowPinned:r.rowPinned},d=E(E({},u),{column:c}),g=i.isCellInSpecificRange(d,l),h=this.rowPositionUtils.sameRow(r,e);if(n&&(this.isUp=!0),!h){var p=o.getCellByPosition(d);if(p){this.markedCells.push(p);var f=p.getComp();g||(f.addOrRemoveCssClass("ag-selection-fill-left",0===a),f.addOrRemoveCssClass("ag-selection-fill-right",a===s-1)),f.addOrRemoveCssClass(n?"ag-selection-fill-top":"ag-selection-fill-bottom",this.rowPositionUtils.sameRow(r,t))}}}if(this.rowPositionUtils.sameRow(r,t))break}while(r=n?this.cellNavigationService.getRowAbove(r):this.cellNavigationService.getRowBelow(r))},n.prototype.reduceVertical=function(e,t){var n=e;do{for(var o=this.getCellRange(),i=o.columns.length,r=this.rowPositionUtils.sameRow(n,t),l=0;l<i;l++){var s={rowIndex:n.rowIndex,rowPinned:n.rowPinned},a=E(E({},s),{column:o.columns[l]}),c=this.navigationService.getCellByPosition(a);if(c)this.markedCells.push(c),c.getComp().addOrRemoveCssClass("ag-selection-fill-bottom",this.rowPositionUtils.sameRow(n,t))}if(r)break}while(n=this.cellNavigationService.getRowAbove(n))},n.prototype.extendHorizontal=function(e,t,n){var i=this,r=this.columnModel.getAllDisplayedColumns(),l=r.indexOf(n?t.column:e.column),s=r.indexOf(n?this.getCellRange().columns[0]:t.column),a=n?0:1,c=r.slice(l+a,s+a),u=this.getRangeStartRow(),d=this.getRangeEndRow();c.forEach((function(e){var t=u,r=!1;do{r=i.rowPositionUtils.sameRow(t,d);var l=i.navigationService.getCellByPosition({rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:e});if(l){i.markedCells.push(l);var s=l.getComp();s.addOrRemoveCssClass("ag-selection-fill-top",i.rowPositionUtils.sameRow(t,u)),s.addOrRemoveCssClass("ag-selection-fill-bottom",i.rowPositionUtils.sameRow(t,d)),n?(i.isLeft=!0,s.addOrRemoveCssClass("ag-selection-fill-left",e===c[0])):s.addOrRemoveCssClass("ag-selection-fill-right",e===o.last(c))}t=i.cellNavigationService.getRowBelow(t)}while(!r)}))},n.prototype.reduceHorizontal=function(e,t){var n=this,o=this.columnModel.getAllDisplayedColumns(),i=o.indexOf(t.column),r=o.indexOf(e.column),l=o.slice(i,r),s=this.getRangeStartRow(),a=this.getRangeEndRow();l.forEach((function(e){var t=s,o=!1;do{o=n.rowPositionUtils.sameRow(t,a);var i=n.navigationService.getCellByPosition({rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:e});if(i)n.markedCells.push(i),i.getComp().addOrRemoveCssClass("ag-selection-fill-right",e===l[0]);t=n.cellNavigationService.getRowBelow(t)}while(!o)}))},n.prototype.refresh=function(e){var n=this.rangeService.getCellRanges()[0];n.startRow&&n.endRow?t.prototype.refresh.call(this,e):this.destroy()},n.TEMPLATE='<div class="ag-fill-handle"></div>',O([i("valueService")],n.prototype,"valueService",void 0),n}(S),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),L=function(){return(L=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},_=function(e){function t(){var n=e.call(this,t.TEMPLATE)||this;return n.type=a.RANGE,n.rangeFixed=!1,n}return M(t,e),t.prototype.onDrag=function(e){var t=this.getLastCellHovered();if(t){var n=this.rangeService.getCellRanges(),i=o.last(n);if(this.rangeFixed||(this.fixRangeStartEnd(i),this.rangeFixed=!0),this.endPosition={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column},2===n.length&&n[0].type===u.DIMENSION&&i.type===u.VALUE)!this.rowPositionUtils.sameRow(this.endPosition,this.rangeService.getRangeEndRow(i))&&this.rangeService.updateRangeEnd(n[0],L(L({},this.endPosition),{column:n[0].columns[0]}),!0);this.rangeService.extendLatestRangeToCell(this.endPosition)}},t.prototype.onDragEnd=function(e){var t=o.last(this.rangeService.getCellRanges());this.fixRangeStartEnd(t),this.rangeFixed=!1},t.prototype.fixRangeStartEnd=function(e){var t=this.rangeService.getRangeStartRow(e),n=this.rangeService.getRangeEndRow(e),o=e.columns[0];e.startRow=t,e.endRow=n,e.startColumn=o},t.TEMPLATE='<div class="ag-range-handle"></div>',t}(S),A=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),N=function(e,t,n,o){var i,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.createSelectionHandle=function(e){return this.createBean(e===a.RANGE?new _:new I)},t=N([l("selectionHandleFactory")],t)}(s),V={moduleName:d.RangeSelectionModule,beans:[m,D],agStackComponents:[{componentName:"AgFillHandle",componentClass:I},{componentName:"AgRangeHandle",componentClass:_}],dependantModules:[g]};export{V as RangeSelectionModule};