/**
          * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
import{AgPromise as t,_ as e,AgMenuItemComponent as n,AgGroupComponent as i,ProvidedFilter as r,Autowired as o,PostConstruct as l,TabGuardComp as s,Component as a,ModuleNames as u}from"@ag-grid-community/core";import{EnterpriseCoreModule as c}from"@ag-grid-enterprise/core";var f,p=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(){return(h=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},d=function(t,e,n,i){var r,o=arguments.length,l=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);return o>3&&l&&Object.defineProperty(e,n,l),l},y=function(s){function a(){var t=s.call(this,'<div class="ag-multi-filter ag-menu-list-compact"></div>')||this;return t.filterDefs=[],t.filters=[],t.guiDestroyFuncs=[],t.activeFilterIndices=[],t.lastActivatedMenuItem=null,t.afterFiltersReadyFuncs=[],t}return p(a,s),a.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onFocusIn:function(e){return t.onFocusIn(e)}})},a.getFilterDefs=function(t){var e=t.filters;return e&&e.length>0?e:[{filter:"agTextColumnFilter"},{filter:"agSetColumnFilter"}]},a.prototype.init=function(e){var n=this;this.params=e,this.filterDefs=a.getFilterDefs(e);var i=e.column,r=e.filterChangedCallback;this.column=i,this.filterChangedCallback=r;var o=[];return this.filterDefs.forEach((function(t,e){var i=n.createFilter(t,e);null!=i&&o.push(i)})),t.all(o).then((function(t){n.filters=t,n.refreshGui("columnMenu"),n.afterFiltersReadyFuncs.forEach((function(t){return t()})),n.afterFiltersReadyFuncs.length=0}))},a.prototype.refreshGui=function(t){var n=this;t!==this.lastOpenedInContainer&&(this.removeAllChildrenExceptTabGuards(),this.destroyChildren(),this.filters.forEach((function(i,r){r>0&&n.appendChild(e.loadTemplate('<div class="ag-filter-separator"></div>'));var o,l=n.filterDefs[r],s=n.getFilterTitle(i,l);if("subMenu"===l.display&&"toolPanel"!==t)o=n.insertFilterMenu(i,s).getGui();else if("subMenu"===l.display||"accordion"===l.display){o=n.insertFilterGroup(i,s).getGui()}else o=i.getGui();n.appendChild(o)})),this.lastOpenedInContainer=t)},a.prototype.getFilterTitle=function(t,e){if(null!=e.title)return e.title;var n=t;return"function"==typeof n.getFilterTitle?n.getFilterTitle():"Filter"},a.prototype.destroyChildren=function(){this.guiDestroyFuncs.forEach((function(t){return t()})),this.guiDestroyFuncs.length=0},a.prototype.insertFilterMenu=function(t,e){var i=this,r=this.createBean(new n({name:e,subMenu:t,cssClasses:["ag-multi-filter-menu-item"],isCompact:!0,isAnotherSubMenuOpen:function(){return!1}}));return r.setParentComponent(this),this.guiDestroyFuncs.push((function(){return i.destroyBean(r)})),this.addManagedListener(r,n.EVENT_MENU_ITEM_ACTIVATED,(function(t){i.lastActivatedMenuItem&&i.lastActivatedMenuItem!==t.menuItem&&i.lastActivatedMenuItem.deactivate(),i.lastActivatedMenuItem=t.menuItem})),r.addGuiEventListener("focusin",(function(){return r.activate()})),r.addGuiEventListener("focusout",(function(){r.isSubMenuOpen()||r.deactivate()})),r},a.prototype.insertFilterGroup=function(t,e){var n=this,r=this.createBean(new i({title:e,cssIdentifier:"multi-filter"}));if(this.guiDestroyFuncs.push((function(){return n.destroyBean(r)})),r.addItem(t.getGui()),r.toggleGroupExpand(!1),t.afterGuiAttached){var o={container:this.lastOpenedInContainer,suppressFocus:!0};r.addManagedListener(r,i.EVENT_EXPANDED,(function(){return t.afterGuiAttached(o)}))}return r},a.prototype.isFilterActive=function(){return this.filters.some((function(t){return t.isFilterActive()}))},a.prototype.getLastActiveFilterIndex=function(){return this.activeFilterIndices.length>0?this.activeFilterIndices[this.activeFilterIndices.length-1]:null},a.prototype.doesFilterPass=function(t,e){var n=!0;return this.filters.forEach((function(i){n&&i!==e&&i.isFilterActive()&&(n=i.doesFilterPass(t))})),n},a.prototype.getFilterType=function(){return"multi"},a.prototype.getModelFromUi=function(){return{filterType:this.getFilterType(),filterModels:this.filters.map((function(t){var e=t;return"function"==typeof e.getModelFromUi?e.getModelFromUi():null}))}},a.prototype.getModel=function(){return this.isFilterActive()?{filterType:this.getFilterType(),filterModels:this.filters.map((function(t){return t.isFilterActive()?t.getModel():null}))}:null},a.prototype.setModel=function(e){var n=this,i=function(e,n){return new t((function(t){var i=e.setModel(n);i?i.then((function(){return t()})):t()}))},r=[];return null==e?r=this.filters.map((function(t,e){var r=i(t,null);return n.updateActiveList(e),r})):this.filters.forEach((function(t,o){var l=e.filterModels.length>o?e.filterModels[o]:null,s=i(t,l);r.push(s),n.updateActiveList(o)})),t.all(r).then((function(){}))},a.prototype.applyModel=function(){var t=!1;return this.filters.forEach((function(e){e instanceof r&&(t=e.applyModel()||t)})),t},a.prototype.getChildFilterInstance=function(t){return this.filters[t]},a.prototype.afterGuiAttached=function(t){t&&this.refreshGui(t.container);var e=this.params.filters,n=e&&e.some((function(t){return t.display&&"inline"!==t.display}));this.executeFunctionIfExists("afterGuiAttached",h(h({},t||{}),{suppressFocus:n}));var i=this.gridOptionsWrapper.getDocument(),r=i.activeElement;n&&(r===i.body||this.getGui().contains(r))&&this.forceFocusOutOfContainer(!0)},a.prototype.onAnyFilterChanged=function(){this.executeFunctionIfExists("onAnyFilterChanged")},a.prototype.onNewRowsLoaded=function(){this.executeFunctionIfExists("onNewRowsLoaded")},a.prototype.destroy=function(){var t=this;this.filters.forEach((function(e){e.setModel(null),t.destroyBean(e)})),this.filters.length=0,this.destroyChildren(),s.prototype.destroy.call(this)},a.prototype.executeFunctionIfExists=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e.forEachReverse(this.filters,(function(e){var i=e[t];"function"==typeof i&&i.apply(e,n)}))},a.prototype.createFilter=function(t,e){var n,i=this,r=this.params,o=r.filterModifiedCallback,l=r.doesRowPassOtherFilter,s=h(h({},this.filterManager.createFilterParams(this.column,this.column.getColDef())),{filterModifiedCallback:o,filterChangedCallback:function(t){i.executeWhenAllFiltersReady((function(){return i.filterChanged(e,t)}))},doesRowPassOtherFilter:function(t){return l(t)&&i.doesFilterPass({node:t,data:t.data},n)}}),a=this.userComponentFactory.getFilterDetails(t,s,"agTextColumnFilter");if(!a)return null;var u=a.newAgStackInstance();return u&&u.then((function(t){return n=t})),u},a.prototype.executeWhenAllFiltersReady=function(t){this.filters&&this.filters.length>0?t():this.afterFiltersReadyFuncs.push(t)},a.prototype.updateActiveList=function(t){var n=this.filters[t];e.removeFromArray(this.activeFilterIndices,t),n.isFilterActive()&&this.activeFilterIndices.push(t)},a.prototype.filterChanged=function(t,e){this.updateActiveList(t),this.filterChangedCallback(e);var n=this.filters[t];this.filters.forEach((function(t){t!==n&&"function"==typeof t.onAnyFilterChanged&&t.onAnyFilterChanged()}))},a.prototype.onFocusIn=function(t){return null==this.lastActivatedMenuItem||this.lastActivatedMenuItem.getGui().contains(t.target)||(this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=null),!0},d([o("filterManager")],a.prototype,"filterManager",void 0),d([o("userComponentFactory")],a.prototype,"userComponentFactory",void 0),d([l],a.prototype,"postConstruct",null),a}(s),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),F=function(){return(F=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},v=function(t,e,n,i){var r,o=arguments.length,l=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(l=(o<3?r(l):o>3?r(e,n,l):r(e,n))||l);return o>3&&l&&Object.defineProperty(e,n,l),l},m=function(n){function i(){var t=n.call(this,'<div class="ag-multi-floating-filter ag-floating-filter-input"></div>')||this;return t.floatingFilters=[],t}return g(i,n),i.prototype.init=function(n){var i=this;this.params=n;var r=n.filterParams,o=[];return y.getFilterDefs(r).forEach((function(t,e){var r=F(F({},n),{parentFilterInstance:function(t){i.parentMultiFilterInstance((function(n){var i=n.getChildFilterInstance(e);null!=i&&t(i)}))}}),l=i.createFloatingFilter(t,r);null!=l&&o.push(l)})),t.all(o).then((function(t){t.forEach((function(t,n){i.floatingFilters.push(t);var r=t.getGui();i.appendChild(r),n>0&&e.setDisplayed(r,!1)}))}))},i.prototype.onParentModelChanged=function(t,n){var i=this;n&&n.afterFloatingFilter||this.parentMultiFilterInstance((function(r){if(null==t)i.floatingFilters.forEach((function(t,i){t.onParentModelChanged(null,n),e.setDisplayed(t.getGui(),0===i)}));else{var o=r.getLastActiveFilterIndex();i.floatingFilters.forEach((function(i,r){var l=t.filterModels.length>r?t.filterModels[r]:null;i.onParentModelChanged(l,n);var s=null==o?0===r:r===o;e.setDisplayed(i.getGui(),s)}))}}))},i.prototype.destroy=function(){this.destroyBeans(this.floatingFilters),this.floatingFilters.length=0,n.prototype.destroy.call(this)},i.prototype.createFloatingFilter=function(t,e){var n=this.userComponentFactory.getDefaultFloatingFilterType(t)||"agTextColumnFloatingFilter",i=this.userComponentFactory.getFloatingFilterCompDetails(t,e,n);return i?i.newAgStackInstance():null},i.prototype.parentMultiFilterInstance=function(t){this.params.parentFilterInstance((function(e){if(!(e instanceof y))throw new Error("AG Grid - MultiFloatingFilterComp expects MultiFilter as it's parent");t(e)}))},v([o("userComponentFactory")],i.prototype,"userComponentFactory",void 0),i}(a),C={moduleName:u.MultiFilterModule,beans:[],userComponents:[{componentName:"agMultiColumnFilter",componentClass:y},{componentName:"agMultiColumnFloatingFilter",componentClass:m}],dependantModules:[c]};export{y as MultiFilter,C as MultiFilterModule};