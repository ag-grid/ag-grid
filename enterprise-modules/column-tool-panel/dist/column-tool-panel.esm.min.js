/**
          * @ag-grid-enterprise/column-tool-panel - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/column-tool-panel - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
import{KeyCode as e,Events as t,_ as o,Autowired as n,RefSelector as i,PostConstruct as r,Component as s,EventService as a,Column as l,ProvidedColumnGroup as p,AgMenuList as u,AgMenuItemComponent as c,AgCheckbox as d,CssClassApplier as h,DragSourceType as m,TouchListener as f,AutoScrollService as g,BeanStub as v,DragAndDropService as y,VirtualList as C,PreDestroy as E,PreConstruct as P,PositionableFeature as D,TabGuardComp as b,ModuleRegistry as A,ModuleNames as L,Bean as S}from"@ag-grid-community/core";import{EnterpriseCoreModule as M}from"@ag-grid-enterprise/core";import{RowGroupDropZonePanel as T,ValuesDropZonePanel as O,PivotDropZonePanel as _,RowGroupingModule as G}from"@ag-grid-enterprise/row-grouping";import{SideBarModule as N}from"@ag-grid-enterprise/side-bar";var I,x,w=(I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),F=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};!function(e){e[e.EXPANDED=0]="EXPANDED",e[e.COLLAPSED=1]="COLLAPSED",e[e.INDETERMINATE=2]="INDETERMINATE"}(x||(x={}));var V=function(s){function a(){return s.call(this,a.TEMPLATE)||this}return w(a,s),a.prototype.postConstruct=function(){var o=this;this.createExpandIcons(),this.addManagedListener(this.eExpand,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eExpand,"keydown",(function(t){t.key===e.SPACE&&o.onExpandClicked()})),this.addManagedListener(this.eSelect.getInputElement(),"click",this.onSelectClicked.bind(this)),this.eFilterTextField.onValueChange((function(){return o.onFilterTextChanged()})),this.addManagedListener(this.eFilterTextField.getInputElement(),"keypress",this.onMiniFilterKeyPress.bind(this)),this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,this.showOrHideOptions.bind(this));var n=this.gridOptionsWrapper.getLocaleTextFunc();this.eSelect.setInputAriaLabel(n("ariaColumnSelectAll","Toggle Select All Columns")),this.eFilterTextField.setInputAriaLabel(n("ariaFilterColumnsInput","Filter Columns Input"))},a.prototype.init=function(e){this.params=e,this.columnModel.isReady()&&this.showOrHideOptions()},a.prototype.createExpandIcons=function(){this.eExpand.appendChild(this.eExpandChecked=o.createIconNoSpan("columnSelectOpen",this.gridOptionsWrapper)),this.eExpand.appendChild(this.eExpandUnchecked=o.createIconNoSpan("columnSelectClosed",this.gridOptionsWrapper)),this.eExpand.appendChild(this.eExpandIndeterminate=o.createIconNoSpan("columnSelectIndeterminate",this.gridOptionsWrapper)),this.setExpandState(x.EXPANDED)},a.prototype.showOrHideOptions=function(){var e=!this.params.suppressColumnFilter,t=!this.params.suppressColumnSelectAll,n=!this.params.suppressColumnExpandAll,i=this.columnModel.isPrimaryColumnGroupsPresent(),r=this.gridOptionsWrapper.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(r("searchOoo","Search...")),o.setDisplayed(this.eFilterTextField.getGui(),e),o.setDisplayed(this.eSelect.getGui(),t),o.setDisplayed(this.eExpand,n&&i)},a.prototype.onFilterTextChanged=function(){var e=this;this.onFilterTextChangedDebounced||(this.onFilterTextChangedDebounced=o.debounce((function(){var t=e.eFilterTextField.getValue();e.dispatchEvent({type:"filterChanged",filterText:t})}),a.DEBOUNCE_DELAY)),this.onFilterTextChangedDebounced()},a.prototype.onMiniFilterKeyPress=function(t){var o=this;t.key===e.ENTER&&setTimeout((function(){return o.onSelectClicked()}),a.DEBOUNCE_DELAY)},a.prototype.onSelectClicked=function(){this.dispatchEvent({type:this.selectState?"unselectAll":"selectAll"})},a.prototype.onExpandClicked=function(){this.dispatchEvent({type:this.expandState===x.EXPANDED?"collapseAll":"expandAll"})},a.prototype.setExpandState=function(e){this.expandState=e,o.setDisplayed(this.eExpandChecked,this.expandState===x.EXPANDED),o.setDisplayed(this.eExpandUnchecked,this.expandState===x.COLLAPSED),o.setDisplayed(this.eExpandIndeterminate,this.expandState===x.INDETERMINATE)},a.prototype.setSelectionState=function(e){this.selectState=e,this.eSelect.setValue(this.selectState)},a.DEBOUNCE_DELAY=300,a.TEMPLATE='<div class="ag-column-select-header" role="presentation" tabindex="-1">\n            <div ref="eExpand" class="ag-column-select-header-icon" tabindex="0"></div>\n            <ag-checkbox ref="eSelect" class="ag-column-select-header-checkbox"></ag-checkbox>\n            <ag-input-text-field class="ag-column-select-header-filter-wrapper" ref="eFilterTextField"></ag-input-text-field>\n        </div>',F([n("columnModel")],a.prototype,"columnModel",void 0),F([i("eExpand")],a.prototype,"eExpand",void 0),F([i("eSelect")],a.prototype,"eSelect",void 0),F([i("eFilterTextField")],a.prototype,"eFilterTextField",void 0),F([r],a.prototype,"postConstruct",null),a}(s),R=function(){function e(e,t,o,n,i){void 0===n&&(n=!1),this.eventService=new a,this.displayName=e,this.dept=o,this.group=n,n?(this.columnGroup=t,this.expanded=i,this.children=[]):this.column=t}return e.prototype.isGroup=function(){return this.group},e.prototype.getDisplayName=function(){return this.displayName},e.prototype.getColumnGroup=function(){return this.columnGroup},e.prototype.getColumn=function(){return this.column},e.prototype.getDept=function(){return this.dept},e.prototype.isExpanded=function(){return!!this.expanded},e.prototype.getChildren=function(){return this.children},e.prototype.isPassesFilter=function(){return this.passesFilter},e.prototype.setExpanded=function(t){t!==this.expanded&&(this.expanded=t,this.eventService.dispatchEvent({type:e.EVENT_EXPANDED_CHANGED}))},e.prototype.setPassesFilter=function(e){this.passesFilter=e},e.prototype.addEventListener=function(e,t){this.eventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},e.EVENT_EXPANDED_CHANGED="expandedChanged",e}(),H=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),k=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},U=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return s},W=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(U(arguments[t]));return e},j=function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},B=function(e){function t(t,o,n){var i=e.call(this,'<div class="ag-menu"></div>')||this;return i.column=t,i.mouseEvent=o,i.parentEl=n,i.displayName=null,i}return H(t,e),t.prototype.postConstruct=function(){this.initializeProperties(this.column),this.buildMenuItemMap(),this.column instanceof l?this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnToolPanel"):this.displayName=this.columnModel.getDisplayNameForProvidedColumnGroup(null,this.column,"columnToolPanel"),this.isActive()&&(this.mouseEvent.preventDefault(),this.displayContextMenu())},t.prototype.initializeProperties=function(e){this.columns=e instanceof p?e.getLeafColumns():[e],this.allowGrouping=this.columns.some((function(e){return e.isPrimary()&&e.isAllowRowGroup()})),this.allowValues=this.columns.some((function(e){return e.isPrimary()&&e.isAllowValue()})),this.allowPivoting=this.columnModel.isPivotMode()&&this.columns.some((function(e){return e.isPrimary()&&e.isAllowPivot()}))},t.prototype.buildMenuItemMap=function(){var e=this,t=this.gridOptionsWrapper.getLocaleTextFunc();this.menuItemMap=new Map,this.menuItemMap.set("rowGroup",{allowedFunction:function(e){return e.isPrimary()&&e.isAllowRowGroup()},activeFunction:function(e){return e.isRowGroupActive()},activateLabel:function(){return t("groupBy","Group by")+" "+e.displayName},deactivateLabel:function(){return t("ungroupBy","Un-Group by")+" "+e.displayName},activateFunction:function(){var t=e.columnModel.getRowGroupColumns();e.columnModel.setRowGroupColumns(e.addColumnsToList(t),"toolPanelUi")},deActivateFunction:function(){var t=e.columnModel.getRowGroupColumns();e.columnModel.setRowGroupColumns(e.removeColumnsFromList(t),"toolPanelUi")},addIcon:"menuAddRowGroup",removeIcon:"menuRemoveRowGroup"}),this.menuItemMap.set("value",{allowedFunction:function(e){return e.isPrimary()&&e.isAllowValue()},activeFunction:function(e){return e.isValueActive()},activateLabel:function(){return t("addToValues","Add "+e.displayName+" to values",[e.displayName])},deactivateLabel:function(){return t("removeFromValues","Remove "+e.displayName+" from values",[e.displayName])},activateFunction:function(){var t=e.columnModel.getValueColumns();e.columnModel.setValueColumns(e.addColumnsToList(t),"toolPanelUi")},deActivateFunction:function(){var t=e.columnModel.getValueColumns();e.columnModel.setValueColumns(e.removeColumnsFromList(t),"toolPanelUi")},addIcon:"valuePanel",removeIcon:"valuePanel"}),this.menuItemMap.set("pivot",{allowedFunction:function(t){return e.columnModel.isPivotMode()&&t.isPrimary()&&t.isAllowPivot()},activeFunction:function(e){return e.isPivotActive()},activateLabel:function(){return t("addToLabels","Add "+e.displayName+" to labels",[e.displayName])},deactivateLabel:function(){return t("removeFromLabels","Remove "+e.displayName+" from labels",[e.displayName])},activateFunction:function(){var t=e.columnModel.getPivotColumns();e.columnModel.setPivotColumns(e.addColumnsToList(t),"toolPanelUi")},deActivateFunction:function(){var t=e.columnModel.getPivotColumns();e.columnModel.setPivotColumns(e.removeColumnsFromList(t),"toolPanelUi")},addIcon:"pivotPanel",removeIcon:"pivotPanel"})},t.prototype.addColumnsToList=function(e){return W(e).concat(this.columns.filter((function(t){return-1===e.indexOf(t)})))},t.prototype.removeColumnsFromList=function(e){var t=this;return e.filter((function(e){return-1===t.columns.indexOf(e)}))},t.prototype.displayContextMenu=function(){var e=this,t=this.getGui(),o=this.createBean(new u),n=this.getMappedMenuItems(),i=function(){};t.appendChild(o.getGui()),o.addMenuItems(n),o.addManagedListener(o,c.EVENT_MENU_ITEM_SELECTED,(function(){e.parentEl.focus(),i()}));var r=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,afterGuiAttached:function(){return e.focusService.focusInto(o.getGui())},ariaLabel:"Foo",closedCallback:function(t){t instanceof KeyboardEvent&&e.parentEl.focus(),e.destroyBean(o)}});r&&(i=r.hideFunc),this.popupService.positionPopupUnderMouseEvent({type:"columnContextMenu",mouseEvent:this.mouseEvent,ePopup:t})},t.prototype.isActive=function(){return this.allowGrouping||this.allowValues||this.allowPivoting},t.prototype.getMappedMenuItems=function(){var e,t,n=[],i=function(e){var t=r.columns.some((function(t){return e.allowedFunction(t)&&!e.activeFunction(t)})),i=r.columns.some((function(t){return e.allowedFunction(t)&&e.activeFunction(t)}));t&&n.push({name:e.activateLabel(r.displayName),icon:o.createIconNoSpan(e.addIcon,r.gridOptionsWrapper,null),action:function(){return e.activateFunction()}}),i&&n.push({name:e.deactivateLabel(r.displayName),icon:o.createIconNoSpan(e.removeIcon,r.gridOptionsWrapper,null),action:function(){return e.deActivateFunction()}})},r=this;try{for(var s=j(this.menuItemMap.values()),a=s.next();!a.done;a=s.next()){i(a.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return n},k([n("columnModel")],t.prototype,"columnModel",void 0),k([n("popupService")],t.prototype,"popupService",void 0),k([n("focusService")],t.prototype,"focusService",void 0),k([r],t.prototype,"postConstruct",null),t}(s),Z=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),X=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},z=function(s){function a(e,t,o,n){var i=s.call(this)||this;return i.modelItem=e,i.allowDragging=t,i.eventType=o,i.focusWrapper=n,i.processingColumnStateChange=!1,i.modelItem=e,i.columnGroup=e.getColumnGroup(),i.columnDept=e.getDept(),i.allowDragging=t,i}return Z(a,s),a.prototype.init=function(){var e=this;this.setTemplate(a.TEMPLATE),this.eDragHandle=o.createIconNoSpan("columnDrag",this.gridOptionsWrapper),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-group-drag-handle");var n=this.cbSelect.getGui(),i=this.cbSelect.getInputElement();n.insertAdjacentElement("afterend",this.eDragHandle),i.setAttribute("tabindex","-1"),this.displayName=this.columnModel.getDisplayNameForProvidedColumnGroup(null,this.columnGroup,this.eventType),o.missing(this.displayName)&&(this.displayName=">>"),this.eLabel.innerHTML=this.displayName?this.displayName:"",this.setupExpandContract(),this.addCssClass("ag-column-select-indent-"+this.columnDept),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.addManagedListener(this.cbSelect,d.EVENT_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.modelItem,R.EVENT_EXPANDED_CHANGED,this.onExpandChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.setOpenClosedIcons(),this.setupDragging(),this.onColumnStateChanged(),this.addVisibilityListenersToAllChildren(),this.refreshAriaExpanded(),this.refreshAriaLabel(),this.setupTooltip(),h.getToolPanelClassesFromColDef(this.columnGroup.getColGroupDef(),this.gridOptionsWrapper,null,this.columnGroup).forEach((function(t){return e.addOrRemoveCssClass(t,!0)}))},a.prototype.getColumns=function(){return this.columnGroup.getLeafColumns()},a.prototype.setupTooltip=function(){var e=this,o=this.columnGroup.getColGroupDef();if(o){var n=function(){var t=o.headerTooltip;e.setTooltip(t)};n(),this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,n)}},a.prototype.getTooltipParams=function(){var e=s.prototype.getTooltipParams.call(this);return e.location="columnToolPanelColumnGroup",e},a.prototype.handleKeyDown=function(t){switch(t.key){case e.LEFT:t.preventDefault(),this.modelItem.setExpanded(!1);break;case e.RIGHT:t.preventDefault(),this.modelItem.setExpanded(!0);break;case e.SPACE:t.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected())}},a.prototype.onContextMenu=function(e){var t=this,o=this.columnGroup;if(!this.gridOptionsWrapper.isFunctionsReadOnly()){var n=this.createBean(new B(o,e,this.focusWrapper));this.addDestroyFunc((function(){n.isAlive()&&t.destroyBean(n)}))}},a.prototype.addVisibilityListenersToAllChildren=function(){var e=this;this.columnGroup.getLeafColumns().forEach((function(t){e.addManagedListener(t,l.EVENT_VISIBLE_CHANGED,e.onColumnStateChanged.bind(e)),e.addManagedListener(t,l.EVENT_VALUE_CHANGED,e.onColumnStateChanged.bind(e)),e.addManagedListener(t,l.EVENT_PIVOT_CHANGED,e.onColumnStateChanged.bind(e)),e.addManagedListener(t,l.EVENT_ROW_GROUP_CHANGED,e.onColumnStateChanged.bind(e))}))},a.prototype.setupDragging=function(){var e=this;if(this.allowDragging){var n={type:m.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDragItem:function(){return e.createDragItem()},onDragStarted:function(){var o={type:t.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:e.columnGroup};e.eventService.dispatchEvent(o)},onDragStopped:function(){var o={type:t.EVENT_COLUMN_PANEL_ITEM_DRAG_END};e.eventService.dispatchEvent(o)}};this.dragAndDropService.addDragSource(n,!0),this.addDestroyFunc((function(){return e.dragAndDropService.removeDragSource(n)}))}else o.setDisplayed(this.eDragHandle,!1)},a.prototype.createDragItem=function(){var e={};return this.columnGroup.getLeafColumns().forEach((function(t){e[t.getId()]=t.isVisible()})),{columns:this.columnGroup.getLeafColumns(),visibleState:e}},a.prototype.setupExpandContract=function(){this.eGroupClosedIcon.appendChild(o.createIcon("columnSelectClosed",this.gridOptionsWrapper,null)),this.eGroupOpenedIcon.appendChild(o.createIcon("columnSelectOpen",this.gridOptionsWrapper,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this));var e=new f(this.eColumnGroupIcons,!0);this.addManagedListener(e,f.EVENT_TAP,this.onExpandOrContractClicked.bind(this)),this.addDestroyFunc(e.destroy.bind(e))},a.prototype.onLabelClicked=function(){var e=!this.cbSelect.getValue();this.onChangeCommon(e)},a.prototype.onCheckboxChanged=function(e){this.onChangeCommon(e.selected)},a.prototype.getVisibleLeafColumns=function(){var e=[],t=function(o){o.forEach((function(o){o.isPassesFilter()&&(o.isGroup()?t(o.getChildren()):e.push(o.getColumn()))}))};return t(this.modelItem.getChildren()),e},a.prototype.onChangeCommon=function(e){this.refreshAriaLabel(),this.processingColumnStateChange||this.modelItemUtils.selectAllChildren(this.modelItem.getChildren(),e,this.eventType)},a.prototype.refreshAriaLabel=function(){var e=this.gridOptionsWrapper.getLocaleTextFunc(),t=e("ariaColumnGroup","Column Group"),n=this.cbSelect.getValue()?e("ariaVisible","visible"):e("ariaHidden","hidden"),i=e("ariaToggleVisibility","Press SPACE to toggle visibility");o.setAriaLabel(this.focusWrapper,this.displayName+" "+t),this.cbSelect.setInputAriaLabel(i+" ("+n+")"),o.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)},a.prototype.onColumnStateChanged=function(){var e=this.workOutSelectedValue(),t=this.workOutReadOnlyValue();this.processingColumnStateChange=!0,this.cbSelect.setValue(e),this.cbSelect.setReadOnly(t),this.addOrRemoveCssClass("ag-column-select-column-group-readonly",t),this.processingColumnStateChange=!1},a.prototype.workOutSelectedValue=function(){var e=this,t=this.columnModel.isPivotMode(),o=this.getVisibleLeafColumns(),n=0,i=0;if(o.forEach((function(o){!t&&o.getColDef().lockVisible||(e.isColumnChecked(o,t)?n++:i++)})),!(n>0&&i>0))return n>0},a.prototype.workOutReadOnlyValue=function(){var e=this.columnModel.isPivotMode(),t=0;return this.columnGroup.getLeafColumns().forEach((function(o){e?o.isAnyFunctionAllowed()&&t++:o.getColDef().lockVisible||t++})),0===t},a.prototype.isColumnChecked=function(e,t){if(t){var o=e.isPivotActive(),n=e.isRowGroupActive(),i=e.isValueActive();return o||n||i}return e.isVisible()},a.prototype.onExpandOrContractClicked=function(){var e=this.modelItem.isExpanded();this.modelItem.setExpanded(!e)},a.prototype.onExpandChanged=function(){this.setOpenClosedIcons(),this.refreshAriaExpanded()},a.prototype.setOpenClosedIcons=function(){var e=this.modelItem.isExpanded();o.setDisplayed(this.eGroupClosedIcon,!e),o.setDisplayed(this.eGroupOpenedIcon,e)},a.prototype.refreshAriaExpanded=function(){o.setAriaExpanded(this.focusWrapper,this.modelItem.isExpanded())},a.prototype.getDisplayName=function(){return this.displayName},a.prototype.onSelectAllChanged=function(e){var t=this.cbSelect.getValue();!this.cbSelect.isReadOnly()&&(e&&!t||!e&&t)&&this.cbSelect.toggle()},a.prototype.isSelected=function(){return this.cbSelect.getValue()},a.prototype.isSelectable=function(){return!this.cbSelect.isReadOnly()},a.prototype.setSelected=function(e){this.cbSelect.setValue(e,!0)},a.TEMPLATE='<div class="ag-column-select-column-group" aria-hidden="true">\n            <span class="ag-column-group-icons" ref="eColumnGroupIcons" >\n                <span class="ag-column-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-column-group-opened-icon" ref="eGroupOpenedIcon"></span>\n            </span>\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',X([n("columnModel")],a.prototype,"columnModel",void 0),X([n("dragAndDropService")],a.prototype,"dragAndDropService",void 0),X([n("modelItemUtils")],a.prototype,"modelItemUtils",void 0),X([i("cbSelect")],a.prototype,"cbSelect",void 0),X([i("eLabel")],a.prototype,"eLabel",void 0),X([i("eGroupOpenedIcon")],a.prototype,"eGroupOpenedIcon",void 0),X([i("eGroupClosedIcon")],a.prototype,"eGroupClosedIcon",void 0),X([i("eColumnGroupIcons")],a.prototype,"eColumnGroupIcons",void 0),X([r],a.prototype,"init",null),a}(s),K=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),q=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},Q="ag-list-item-hovered",Y=function(e){function i(t,o){var n=e.call(this)||this;return n.comp=t,n.virtualList=o,n.currentDragColumn=null,n.lastHoveredColumnItem=null,n}return K(i,e),i.prototype.postConstruct=function(){this.addManagedListener(this.eventService,t.EVENT_COLUMN_PANEL_ITEM_DRAG_START,this.columnPanelItemDragStart.bind(this)),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PANEL_ITEM_DRAG_END,this.columnPanelItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()},i.prototype.columnPanelItemDragStart=function(e){var t=e.column;this.currentDragColumn=t,this.getCurrentColumns().find((function(e){var t=e.getColDef();return!!t.suppressMovable||!!t.lockPosition}))&&(this.moveBlocked=!0)},i.prototype.columnPanelItemDragEnd=function(){var e=this;window.setTimeout((function(){e.currentDragColumn=null,e.moveBlocked=!1}),10)},i.prototype.createDropTarget=function(){var e=this,t={isInterestedIn:function(e){return e===m.ToolPanel},getIconName:function(){return y[e.moveBlocked?"ICON_NOT_ALLOWED":"ICON_MOVE"]},getContainer:function(){return e.comp.getGui()},onDragging:function(t){return e.onDragging(t)},onDragStop:function(){return e.onDragStop()},onDragLeave:function(){return e.onDragLeave()}};this.dragAndDropService.addDropTarget(t)},i.prototype.createAutoScrollService=function(){var e=this.virtualList.getGui();this.autoScrollService=new g({scrollContainer:e,scrollAxis:"y",getVerticalPosition:function(){return e.scrollTop},setVerticalPosition:function(t){return e.scrollTop=t}})},i.prototype.onDragging=function(e){if(this.currentDragColumn&&!this.moveBlocked){var t=this.getDragColumnItem(e),n=this.virtualList.getComponentAt(t.rowIndex);if(n){var i=n.getGui().parentElement;this.lastHoveredColumnItem&&this.lastHoveredColumnItem.rowIndex===t.rowIndex&&this.lastHoveredColumnItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredColumnItem=t,o.radioCssClass(i,""+Q),o.radioCssClass(i,"ag-item-highlight-"+t.position))}}},i.prototype.getDragColumnItem=function(e){var t=this.virtualList.getGui(),o=parseFloat(window.getComputedStyle(t).paddingTop),n=this.virtualList.getRowHeight(),i=this.virtualList.getScrollTop(),r=Math.max(0,(e.y-o+i)/n),s=this.comp.getDisplayedColsList().length-1,a=0|Math.min(s,r);return{rowIndex:a,position:Math.round(r)>r||r>s?"bottom":"top",component:this.virtualList.getComponentAt(a)}},i.prototype.onDragStop=function(){if(!this.moveBlocked){var e=this.getTargetIndex(),t=this.getCurrentColumns();null!=e&&this.columnModel.moveColumns(t,e),this.clearHoveredItems(),this.autoScrollService.ensureCleared()}},i.prototype.getMoveDiff=function(e){var t=this.columnModel.getAllGridColumns(),o=this.getCurrentColumns(),n=o[0],i=o.length;return t.indexOf(n)<e?i:0},i.prototype.getCurrentColumns=function(){return this.currentDragColumn instanceof p?this.currentDragColumn.getLeafColumns():[this.currentDragColumn]},i.prototype.getTargetIndex=function(){if(!this.lastHoveredColumnItem)return null;var e,t=this.lastHoveredColumnItem.component,o="top"===this.lastHoveredColumnItem.position;t instanceof z?(e=t.getColumns()[0],o=!0):e=t.getColumn();var n=this.columnModel.getAllGridColumns().indexOf(e),i=o?n:n+1;return i-this.getMoveDiff(i)},i.prototype.onDragLeave=function(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()},i.prototype.clearHoveredItems=function(){this.virtualList.getGui().querySelectorAll("."+Q).forEach((function(e){[Q,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach((function(t){e.classList.remove(t)}))})),this.lastHoveredColumnItem=null},q([n("columnModel")],i.prototype,"columnModel",void 0),q([n("dragAndDropService")],i.prototype,"dragAndDropService",void 0),q([r],i.prototype,"postConstruct",null),i}(v),J=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),$=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},ee=function(s){function a(e,t,o,n,i){var r=s.call(this)||this;return r.column=e,r.columnDept=t,r.allowDragging=o,r.groupsExist=n,r.focusWrapper=i,r.processingColumnStateChange=!1,r}return J(a,s),a.prototype.init=function(){var e=this;this.setTemplate(a.TEMPLATE),this.eDragHandle=o.createIconNoSpan("columnDrag",this.gridOptionsWrapper),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-drag-handle");var n=this.cbSelect.getGui(),i=this.cbSelect.getInputElement();n.insertAdjacentElement("afterend",this.eDragHandle),i.setAttribute("tabindex","-1"),this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnToolPanel");var r=o.escapeString(this.displayName);this.eLabel.innerHTML=r;var s=this.columnDept;this.groupsExist&&this.addCssClass("ag-column-select-add-group-indent"),this.addCssClass("ag-column-select-indent-"+s),this.setupDragging(),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,l.EVENT_VALUE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,l.EVENT_PIVOT_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,l.EVENT_ROW_GROUP_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,l.EVENT_VISIBLE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.addManagedListener(this.gridOptionsWrapper,"functionsReadOnly",this.onColumnStateChanged.bind(this)),this.addManagedListener(this.cbSelect,d.EVENT_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.onColumnStateChanged(),this.refreshAriaLabel(),this.setupTooltip(),h.getToolPanelClassesFromColDef(this.column.getColDef(),this.gridOptionsWrapper,this.column,null).forEach((function(t){return e.addOrRemoveCssClass(t,!0)}))},a.prototype.getColumn=function(){return this.column},a.prototype.setupTooltip=function(){var e=this,o=function(){var t=e.column.getColDef().headerTooltip;e.setTooltip(t)};o(),this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,o)},a.prototype.getTooltipParams=function(){var e=s.prototype.getTooltipParams.call(this);return e.location="columnToolPanelColumn",e.colDef=this.column.getColDef(),e},a.prototype.onContextMenu=function(e){var t=this,o=this.column;if(!this.gridOptionsWrapper.isFunctionsReadOnly()){var n=this.createBean(new B(o,e,this.focusWrapper));this.addDestroyFunc((function(){n.isAlive()&&t.destroyBean(n)}))}},a.prototype.handleKeyDown=function(t){t.key===e.SPACE&&(t.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected()))},a.prototype.onLabelClicked=function(){if(!this.gridOptionsWrapper.isFunctionsReadOnly()){var e=!this.cbSelect.getValue();this.onChangeCommon(e)}},a.prototype.onCheckboxChanged=function(e){this.onChangeCommon(e.selected)},a.prototype.onChangeCommon=function(e){this.cbSelect.isReadOnly()||(this.refreshAriaLabel(),this.processingColumnStateChange||this.modelItemUtils.setColumn(this.column,e,"toolPanelUi"))},a.prototype.refreshAriaLabel=function(){var e=this.gridOptionsWrapper.getLocaleTextFunc(),t=e("ariaColumn","Column"),n=this.cbSelect.getValue()?e("ariaVisible","visible"):e("ariaHidden","hidden"),i=e("ariaToggleVisibility","Press SPACE to toggle visibility");o.setAriaLabel(this.focusWrapper,this.displayName+" "+t),this.cbSelect.setInputAriaLabel(i+" ("+n+")"),o.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)},a.prototype.setupDragging=function(){var e=this;if(this.allowDragging){var n={type:m.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,getDragItem:function(){return e.createDragItem()},onDragStarted:function(){var o={type:t.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:e.column};e.eventService.dispatchEvent(o)},onDragStopped:function(){var o={type:t.EVENT_COLUMN_PANEL_ITEM_DRAG_END};e.eventService.dispatchEvent(o)}};this.dragAndDropService.addDragSource(n,!0),this.addDestroyFunc((function(){return e.dragAndDropService.removeDragSource(n)}))}else o.setDisplayed(this.eDragHandle,!1)},a.prototype.createDragItem=function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}},a.prototype.onColumnStateChanged=function(){this.processingColumnStateChange=!0;var e=this.columnModel.isPivotMode();if(e){var t=this.column.isAnyFunctionActive();this.cbSelect.setValue(t)}else this.cbSelect.setValue(this.column.isVisible());var o=!0,n=!0;if(e){var i=this.gridOptionsWrapper.isFunctionsReadOnly(),r=!this.column.isAnyFunctionAllowed();n=o=!i&&!r}else{var s=this.column.getColDef(),a=s.enableRowGroup,l=s.enableValue,p=s.lockPosition,u=s.suppressMovable;o=!s.lockVisible,n=!!a||!!l||!(!!p||!!u)}this.cbSelect.setReadOnly(!o),this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!n),this.addOrRemoveCssClass("ag-column-select-column-readonly",!n&&!o);var c=e&&this.gridOptionsWrapper.isFunctionsPassive();this.cbSelect.setPassive(c),this.processingColumnStateChange=!1},a.prototype.getDisplayName=function(){return this.displayName},a.prototype.onSelectAllChanged=function(e){e!==this.cbSelect.getValue()&&(this.cbSelect.isReadOnly()||this.cbSelect.toggle())},a.prototype.isSelected=function(){return this.cbSelect.getValue()},a.prototype.isSelectable=function(){return!this.cbSelect.isReadOnly()},a.prototype.isExpandable=function(){return!1},a.prototype.setExpanded=function(e){console.warn("AG Grid: can not expand a column item that does not represent a column group header")},a.TEMPLATE='<div class="ag-column-select-column" aria-hidden="true">\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',$([n("columnModel")],a.prototype,"columnModel",void 0),$([n("dragAndDropService")],a.prototype,"dragAndDropService",void 0),$([n("modelItemUtils")],a.prototype,"modelItemUtils",void 0),$([i("eLabel")],a.prototype,"eLabel",void 0),$([i("cbSelect")],a.prototype,"cbSelect",void 0),$([r],a.prototype,"init",null),a}(s),te=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),oe=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},ne=function(){function e(e){this.items=e}return e.prototype.getRowCount=function(){return this.items.length},e.prototype.getRow=function(e){return this.items[e]},e}(),ie=function(e){function i(){var t=e.call(this,i.TEMPLATE)||this;return t.destroyColumnItemFuncs=[],t}return te(i,e),i.prototype.destroyColumnTree=function(){this.allColsTree=[],this.destroyColumnItemFuncs.forEach((function(e){return e()})),this.destroyColumnItemFuncs=[]},i.prototype.init=function(e,n,i){var r=this;this.params=e,this.allowDragging=n,this.eventType=i,this.params.suppressSyncLayoutWithGrid||this.addManagedListener(this.eventService,t.EVENT_COLUMN_MOVED,this.onColumnsChanged.bind(this)),this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,this.onColumnsChanged.bind(this)),[t.EVENT_COLUMN_PIVOT_CHANGED,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,t.EVENT_COLUMN_ROW_GROUP_CHANGED,t.EVENT_COLUMN_VALUE_CHANGED,t.EVENT_COLUMN_VISIBLE,t.EVENT_NEW_COLUMNS_LOADED].forEach((function(e){r.addManagedListener(r.eventService,e,r.fireSelectionChangedEvent.bind(r))})),this.expandGroupsByDefault=!this.params.contractColumnSelection;var s=this.gridOptionsWrapper.getLocaleTextFunc()("ariaColumnList","Column List");this.virtualList=this.createManagedBean(new C("column-select","tree",s)),this.appendChild(this.virtualList.getGui()),this.virtualList.setComponentCreator((function(e,t){return o.setAriaLevel(t,e.getDept()+1),r.createComponentFromItem(e,t)})),this.columnModel.isReady()&&this.onColumnsChanged(),e.suppressColumnMove||this.gridOptionsWrapper.isSuppressMovableColumns()||this.createManagedBean(new Y(this,this.virtualList))},i.prototype.createComponentFromItem=function(e,t){if(e.isGroup()){var o=new z(e,this.allowDragging,this.eventType,t);return this.getContext().createBean(o),o}var n=new ee(e.getColumn(),e.getDept(),this.allowDragging,this.groupsExist,t);return this.getContext().createBean(n),n},i.prototype.onColumnsChanged=function(){var e=this.getExpandedStates(),t=this.columnModel.isPivotMode();!this.params.suppressSyncLayoutWithGrid&&!t?this.buildTreeFromWhatGridIsDisplaying():this.buildTreeFromProvidedColumnDefs(),this.setExpandedStates(e),this.markFilteredColumns(),this.flattenAndFilterModel()},i.prototype.getDisplayedColsList=function(){return this.displayedColsList},i.prototype.getExpandedStates=function(){if(!this.allColsTree)return{};var e={};return this.forEachItem((function(t){if(t.isGroup()){var o=t.getColumnGroup();o&&(e[o.getId()]=t.isExpanded())}})),e},i.prototype.setExpandedStates=function(e){this.allColsTree&&this.forEachItem((function(t){if(t.isGroup()){var o=t.getColumnGroup();if(o){var n=e[o.getId()];null!=n&&t.setExpanded(n)}}}))},i.prototype.buildTreeFromWhatGridIsDisplaying=function(){this.colDefService.syncLayoutWithGrid(this.setColumnLayout.bind(this))},i.prototype.setColumnLayout=function(e){var t=this.colDefService.createColumnTree(e);this.buildListModel(t),this.groupsExist=e.some((function(e){return e&&void 0!==e.children})),this.markFilteredColumns(),this.flattenAndFilterModel()},i.prototype.buildTreeFromProvidedColumnDefs=function(){this.buildListModel(this.columnModel.getPrimaryColumnTree()),this.groupsExist=this.columnModel.isPrimaryColumnGroupsPresent()},i.prototype.buildListModel=function(e){var t=this,o=this.onColumnExpanded.bind(this),n=function(e,t,o){e.forEach((function(e){e instanceof p?i(e,t,o):r(e,t,o)}))},i=function(e,i,r){var s=e.getColGroupDef();if(!(s&&s.suppressColumnsToolPanel))if(e.isPadding())n(e.getChildren(),i,r);else{var a=t.columnModel.getDisplayNameForProvidedColumnGroup(null,e,t.eventType),l=new R(a,e,i,!0,t.expandGroupsByDefault);r.push(l),function(e){e.addEventListener(R.EVENT_EXPANDED_CHANGED,o);var n=e.removeEventListener.bind(e,R.EVENT_EXPANDED_CHANGED,o);t.destroyColumnItemFuncs.push(n)}(l),n(e.getChildren(),i+1,l.getChildren())}},r=function(e,o,n){if(!(e.getColDef()&&e.getColDef().suppressColumnsToolPanel)){var i=t.columnModel.getDisplayNameForColumn(e,"columnToolPanel");n.push(new R(i,e,o))}};this.destroyColumnTree(),n(e,0,this.allColsTree)},i.prototype.onColumnExpanded=function(){this.flattenAndFilterModel()},i.prototype.flattenAndFilterModel=function(){var e=this;this.displayedColsList=[];var t=function(o){o.isPassesFilter()&&(e.displayedColsList.push(o),o.isGroup()&&o.isExpanded()&&o.getChildren().forEach(t))};this.allColsTree.forEach(t),this.virtualList.setModel(new ne(this.displayedColsList));var o=this.virtualList.getLastFocusedRow();this.virtualList.refresh(),null!=o&&this.focusRowIfAlive(o),this.notifyListeners()},i.prototype.focusRowIfAlive=function(e){var t=this;window.setTimeout((function(){t.isAlive()&&t.virtualList.focusRow(e)}),0)},i.prototype.forEachItem=function(e){var t=function(o){o.forEach((function(o){e(o),o.isGroup()&&t(o.getChildren())}))};t(this.allColsTree)},i.prototype.doSetExpandedAll=function(e){this.forEachItem((function(t){t.isGroup()&&t.setExpanded(e)}))},i.prototype.setGroupsExpanded=function(e,t){if(t){var n=[];this.forEachItem((function(o){if(o.isGroup()){var i=o.getColumnGroup().getId();t.indexOf(i)>=0&&(o.setExpanded(e),n.push(i))}}));var i=t.filter((function(e){return!o.includes(n,e)}));i.length>0&&console.warn("AG Grid: unable to find group(s) for supplied groupIds:",i)}else this.doSetExpandedAll(e)},i.prototype.getExpandState=function(){var e=0,t=0;return this.forEachItem((function(o){o.isGroup()&&(o.isExpanded()?e++:t++)})),e>0&&t>0?x.INDETERMINATE:t>0?x.COLLAPSED:x.EXPANDED},i.prototype.doSetSelectedAll=function(e){this.modelItemUtils.selectAllChildren(this.allColsTree,e,this.eventType)},i.prototype.getSelectionState=function(){var e=0,t=0,o=this.columnModel.isPivotMode();if(this.forEachItem((function(n){if(!n.isGroup()&&n.isPassesFilter()){var i,r=n.getColumn(),s=r.getColDef();if(o){if(!r.isAllowPivot()&&!r.isAllowRowGroup()&&!r.isAllowValue())return;i=r.isValueActive()||r.isPivotActive()||r.isRowGroupActive()}else{if(s.lockVisible)return;i=r.isVisible()}i?e++:t++}})),!(e>0&&t>0))return!(0===e||t>0)},i.prototype.setFilterText=function(e){this.filterText=o.exists(e)?e.toLowerCase():null,this.markFilteredColumns(),this.flattenAndFilterModel()},i.prototype.markFilteredColumns=function(){var e=this,t=function(t){if(!o.exists(e.filterText))return!0;var n=t.getDisplayName();return null==n||-1!==n.toLowerCase().indexOf(e.filterText)},n=function(e,o){var i=!1;if(e.isGroup()){var r=t(e);e.getChildren().forEach((function(e){var t=n(e,r||o);t&&(i=t)}))}var s=!(!o&&!i)||t(e);return e.setPassesFilter(s),s};this.allColsTree.forEach((function(e){return n(e,!1)}))},i.prototype.notifyListeners=function(){this.fireGroupExpandedEvent(),this.fireSelectionChangedEvent()},i.prototype.fireGroupExpandedEvent=function(){var e=this.getExpandState();this.dispatchEvent({type:"groupExpanded",state:e})},i.prototype.fireSelectionChangedEvent=function(){var e=this.getSelectionState();this.dispatchEvent({type:"selectionChanged",state:e})},i.TEMPLATE='<div class="ag-column-select-list" role="presentation"></div>',oe([n("columnModel")],i.prototype,"columnModel",void 0),oe([n("toolPanelColDefService")],i.prototype,"colDefService",void 0),oe([n("modelItemUtils")],i.prototype,"modelItemUtils",void 0),oe([E],i.prototype,"destroyColumnTree",null),i}(s),re=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),se=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},ae=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return re(o,e),o.prototype.createTemplate=function(){return'<div class="ag-pivot-mode-panel">\n                <ag-toggle-button ref="cbPivotMode" class="ag-pivot-mode-select"></ag-toggle-button>\n            </div>'},o.prototype.init=function(){this.setTemplate(this.createTemplate()),this.cbPivotMode.setValue(this.columnModel.isPivotMode());var e=this.gridOptionsWrapper.getLocaleTextFunc();this.cbPivotMode.setLabel(e("pivotMode","Pivot Mode")),this.addManagedListener(this.cbPivotMode,d.EVENT_CHANGED,this.onBtPivotMode.bind(this)),this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this))},o.prototype.onBtPivotMode=function(){var e=!!this.cbPivotMode.getValue();if(e!==this.columnModel.isPivotMode()){this.columnModel.setPivotMode(e,"toolPanelUi");var t=this.gridOptionsWrapper.getApi();t&&t.refreshHeader()}},o.prototype.onPivotModeChanged=function(){var e=this.columnModel.isPivotMode();this.cbPivotMode.setValue(e)},se([n("columnModel")],o.prototype,"columnModel",void 0),se([i("cbPivotMode")],o.prototype,"cbPivotMode",void 0),se([P],o.prototype,"init",null),o}(s),le=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pe=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},ue=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return le(t,e),t.prototype.postConstruct=function(){this.initialiseTabGuard({})},t.prototype.init=function(e,t,o){this.allowDragging=e,this.params=t,this.eventType=o,this.primaryColsHeaderPanel.init(this.params);var n=this.params.suppressColumnFilter,i=this.params.suppressColumnSelectAll;this.params.suppressColumnExpandAll&&n&&i&&this.primaryColsHeaderPanel.setDisplayed(!1),this.addManagedListener(this.primaryColsListPanel,"groupExpanded",this.onGroupExpanded.bind(this)),this.addManagedListener(this.primaryColsListPanel,"selectionChanged",this.onSelectionChange.bind(this)),this.primaryColsListPanel.init(this.params,this.allowDragging,this.eventType),this.addManagedListener(this.primaryColsHeaderPanel,"expandAll",this.onExpandAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"collapseAll",this.onCollapseAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"selectAll",this.onSelectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"unselectAll",this.onUnselectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"filterChanged",this.onFilterChanged.bind(this)),this.positionableFeature=new D(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature)},t.prototype.toggleResizable=function(e){this.positionableFeature.setResizable(!!e&&{bottom:!0})},t.prototype.onExpandAll=function(){this.primaryColsListPanel.doSetExpandedAll(!0)},t.prototype.onCollapseAll=function(){this.primaryColsListPanel.doSetExpandedAll(!1)},t.prototype.expandGroups=function(e){this.primaryColsListPanel.setGroupsExpanded(!0,e)},t.prototype.collapseGroups=function(e){this.primaryColsListPanel.setGroupsExpanded(!1,e)},t.prototype.setColumnLayout=function(e){this.primaryColsListPanel.setColumnLayout(e)},t.prototype.onFilterChanged=function(e){this.primaryColsListPanel.setFilterText(e.filterText)},t.prototype.syncLayoutWithGrid=function(){this.primaryColsListPanel.onColumnsChanged()},t.prototype.onSelectAll=function(){this.primaryColsListPanel.doSetSelectedAll(!0)},t.prototype.onUnselectAll=function(){this.primaryColsListPanel.doSetSelectedAll(!1)},t.prototype.onGroupExpanded=function(e){this.primaryColsHeaderPanel.setExpandState(e.state)},t.prototype.onSelectionChange=function(e){this.primaryColsHeaderPanel.setSelectionState(e.state)},t.TEMPLATE='<div class="ag-column-select">\n            <ag-primary-cols-header ref="primaryColsHeaderPanel"></ag-primary-cols-header>\n            <ag-primary-cols-list ref="primaryColsListPanel"></ag-primary-cols-list>\n        </div>',pe([i("primaryColsHeaderPanel")],t.prototype,"primaryColsHeaderPanel",void 0),pe([i("primaryColsListPanel")],t.prototype,"primaryColsListPanel",void 0),pe([r],t.prototype,"postConstruct",null),t}(b),ce=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),de=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},he=function(e){function i(){var t=e.call(this,i.TEMPLATE)||this;return t.initialised=!1,t.childDestroyFuncs=[],t}return ce(i,e),i.prototype.setVisible=function(t){e.prototype.setDisplayed.call(this,t),t&&!this.initialised&&this.init(this.params)},i.prototype.init=function(e){var n=this,i={suppressColumnMove:!1,suppressColumnSelectAll:!1,suppressColumnFilter:!1,suppressColumnExpandAll:!1,contractColumnSelection:!1,suppressPivotMode:!1,suppressRowGroups:!1,suppressValues:!1,suppressPivots:!1,suppressSyncLayoutWithGrid:!1,api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext()};if(o.mergeDeep(i,e),this.params=i,this.isRowGroupingModuleLoaded()&&!this.params.suppressPivotMode&&(this.pivotModePanel=this.createBean(new ae),this.childDestroyFuncs.push((function(){return n.destroyBean(n.pivotModePanel)})),this.appendChild(this.pivotModePanel)),this.primaryColsPanel=this.createBean(new ue),this.childDestroyFuncs.push((function(){return n.destroyBean(n.primaryColsPanel)})),this.primaryColsPanel.init(!0,this.params,"toolPanelUi"),this.primaryColsPanel.addCssClass("ag-column-panel-column-select"),this.appendChild(this.primaryColsPanel),this.isRowGroupingModuleLoaded()){this.params.suppressRowGroups||(this.rowGroupDropZonePanel=this.createBean(new T(!1)),this.childDestroyFuncs.push((function(){return n.destroyBean(n.rowGroupDropZonePanel)})),this.appendChild(this.rowGroupDropZonePanel)),this.params.suppressValues||(this.valuesDropZonePanel=this.createBean(new O(!1)),this.childDestroyFuncs.push((function(){return n.destroyBean(n.valuesDropZonePanel)})),this.appendChild(this.valuesDropZonePanel)),this.params.suppressPivots||(this.pivotDropZonePanel=this.createBean(new _(!1)),this.childDestroyFuncs.push((function(){return n.destroyBean(n.pivotDropZonePanel)})),this.appendChild(this.pivotDropZonePanel)),this.setLastVisible();var r=this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){n.resetChildrenHeight(),n.setLastVisible()}));this.childDestroyFuncs.push((function(){return r()}))}this.initialised=!0},i.prototype.setPivotModeSectionVisible=function(e){var t=this;this.isRowGroupingModuleLoaded()&&(this.pivotModePanel?this.pivotModePanel.setDisplayed(e):e&&(this.pivotModePanel=this.createBean(new ae),this.getGui().insertBefore(this.pivotModePanel.getGui(),this.getGui().firstChild),this.childDestroyFuncs.push((function(){return t.destroyBean(t.pivotModePanel)}))),this.setLastVisible())},i.prototype.setRowGroupsSectionVisible=function(e){this.isRowGroupingModuleLoaded()&&(this.rowGroupDropZonePanel?this.rowGroupDropZonePanel.setDisplayed(e):e&&(this.rowGroupDropZonePanel=this.createManagedBean(new T(!1)),this.appendChild(this.rowGroupDropZonePanel)),this.setLastVisible())},i.prototype.setValuesSectionVisible=function(e){this.isRowGroupingModuleLoaded()&&(this.valuesDropZonePanel?this.valuesDropZonePanel.setDisplayed(e):e&&(this.valuesDropZonePanel=this.createManagedBean(new O(!1)),this.appendChild(this.valuesDropZonePanel)),this.setLastVisible())},i.prototype.setPivotSectionVisible=function(e){this.isRowGroupingModuleLoaded()&&(this.pivotDropZonePanel?this.pivotDropZonePanel.setDisplayed(e):e&&(this.pivotDropZonePanel=this.createManagedBean(new _(!1)),this.appendChild(this.pivotDropZonePanel),this.pivotDropZonePanel.setDisplayed(e)),this.setLastVisible())},i.prototype.setResizers=function(){[this.primaryColsPanel,this.rowGroupDropZonePanel,this.valuesDropZonePanel,this.pivotDropZonePanel].forEach((function(e){if(e){var t=e.getGui();e.toggleResizable(!t.classList.contains("ag-last-column-drop")&&!t.classList.contains("ag-hidden"))}}))},i.prototype.setLastVisible=function(){var e=this.getGui();Array.prototype.slice.call(e.querySelectorAll(".ag-column-drop")).forEach((function(e){return e.classList.remove("ag-last-column-drop")}));var t=e.querySelectorAll(".ag-column-drop:not(.ag-hidden)"),n=o.last(t);n&&n.classList.add("ag-last-column-drop"),this.setResizers()},i.prototype.resetChildrenHeight=function(){for(var e=this.getGui().children,t=0;t<e.length;t++){var o=e[t];o.style.removeProperty("height"),o.style.removeProperty("flex")}},i.prototype.isRowGroupingModuleLoaded=function(){return A.assertRegistered(L.RowGroupingModule,"Row Grouping")},i.prototype.expandColumnGroups=function(e){this.primaryColsPanel.expandGroups(e)},i.prototype.collapseColumnGroups=function(e){this.primaryColsPanel.collapseGroups(e)},i.prototype.setColumnLayout=function(e){this.primaryColsPanel.setColumnLayout(e)},i.prototype.syncLayoutWithGrid=function(){this.primaryColsPanel.syncLayoutWithGrid()},i.prototype.destroyChildren=function(){this.childDestroyFuncs.forEach((function(e){return e()})),this.childDestroyFuncs.length=0,o.clearElement(this.getGui())},i.prototype.refresh=function(){this.destroyChildren(),this.init(this.params)},i.prototype.destroy=function(){this.destroyChildren(),e.prototype.destroy.call(this)},i.TEMPLATE='<div class="ag-column-panel"></div>',de([n("gridApi")],i.prototype,"gridApi",void 0),de([n("columnApi")],i.prototype,"columnApi",void 0),i}(s),me=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},fe=function(){function e(){}return e.prototype.selectAllChildren=function(e,t,o){var n=this.extractAllLeafColumns(e);this.setAllColumns(n,t,o)},e.prototype.setColumn=function(e,t,o){this.setAllColumns([e],t,o)},e.prototype.setAllColumns=function(e,t,o){this.columnModel.isPivotMode()?this.setAllPivot(e,t,o):this.setAllVisible(e,t,o)},e.prototype.extractAllLeafColumns=function(e){var t=[],o=function(e){e.forEach((function(e){e.isPassesFilter()&&(e.isGroup()?o(e.getChildren()):t.push(e.getColumn()))}))};return o(e),t},e.prototype.setAllVisible=function(e,t,o){var n=[];e.forEach((function(e){e.getColDef().lockVisible||e.isVisible()!=t&&n.push({colId:e.getId(),hide:!t})})),n.length>0&&this.columnModel.applyColumnState({state:n},o)},e.prototype.setAllPivot=function(e,t,o){this.gridOptionsWrapper.isFunctionsPassive()?this.setAllPivotPassive(e,t):this.setAllPivotActive(e,t,o)},e.prototype.setAllPivotPassive=function(e,n){var i=this.columnModel.getPivotColumns().slice(),r=this.columnModel.getValueColumns().slice(),s=this.columnModel.getRowGroupColumns().slice(),a=!1,l=!1,p=!1,u=n?function(e){e.isAnyFunctionActive()||(e.isAllowValue()?(r.push(e),l=!0):e.isAllowRowGroup()?(s.push(e),a=!0):e.isAllowPivot()&&(i.push(e),p=!0))}:function(e){e.isAnyFunctionActive()&&(i.indexOf(e)>=0&&(o.removeFromArray(i,e),a=!0),r.indexOf(e)>=0&&(o.removeFromArray(r,e),l=!0),s.indexOf(e)>=0&&(o.removeFromArray(s,e),p=!0))};if(e.forEach(u),a){var c={type:t.EVENT_COLUMN_PIVOT_CHANGE_REQUEST,columns:i,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(c)}if(p){var d={type:t.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST,columns:s,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(d)}if(l){var h={type:t.EVENT_COLUMN_VALUE_CHANGE_REQUEST,columns:s,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(h)}},e.prototype.setAllPivotActive=function(e,t,o){var n=this,i=[],r=t?function(e){if(!e.isAnyFunctionActive())if(e.isAllowValue()){var t="string"==typeof e.getAggFunc()?e.getAggFunc():n.aggFuncService.getDefaultAggFunc(e);i.push({colId:e.getId(),aggFunc:t})}else e.isAllowRowGroup()?i.push({colId:e.getId(),rowGroup:!0}):e.isAllowPivot()&&i.push({colId:e.getId(),pivot:!0})}:function(e){(e.isPivotActive()||e.isRowGroupActive()||e.isValueActive())&&i.push({colId:e.getId(),pivot:!1,rowGroup:!1,aggFunc:null})};e.forEach(r),i.length>0&&this.columnModel.applyColumnState({state:i},o)},me([n("aggFuncService")],e.prototype,"aggFuncService",void 0),me([n("columnModel")],e.prototype,"columnModel",void 0),me([n("gridOptionsWrapper")],e.prototype,"gridOptionsWrapper",void 0),me([n("columnApi")],e.prototype,"columnApi",void 0),me([n("gridApi")],e.prototype,"gridApi",void 0),me([n("eventService")],e.prototype,"eventService",void 0),e=me([S("modelItemUtils")],e)}(),ge={moduleName:L.ColumnToolPanelModule,beans:[fe],agStackComponents:[{componentName:"AgPrimaryColsHeader",componentClass:V},{componentName:"AgPrimaryColsList",componentClass:ie},{componentName:"AgPrimaryCols",componentClass:ue}],userComponents:[{componentName:"agColumnsToolPanel",componentClass:he}],dependantModules:[M,G,N]};export{ge as ColumnsToolPanelModule,ue as PrimaryColsPanel};