/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.0
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
import{_ as e,EventService as t,TextFilter as i,Constants as r,AgPromise as l,Autowired as o,RefSelector as n,PostConstruct as a,Component as s,PositionableFeature as u,KeyCode as c,Events as h,VirtualList as p,ProvidedFilter as d,ModuleNames as f}from"@ag-grid-community/core";import{EnterpriseCoreModule as v}from"@ag-grid-enterprise/core";var y,m=function(){function t(e,t,i){this.rowModel=e,this.filterParams=t,this.caseFormat=i}return t.prototype.extractUniqueValues=function(t){var i=this,r={},l=this.filterParams.colDef.keyCreator,o=function(e){var t=null!=e?i.caseFormat(e):"__<ag-grid-pseudo-null>__";t&&null==r[t]&&(r[t]=e)};return this.rowModel.forEachLeafNode((function(r){if(r.data&&t(r)){var n=i.filterParams,a=n.api,s=n.colDef,u=n.column,c=n.columnApi,h=n.context,p=i.filterParams.valueGetter({api:a,colDef:s,column:u,columnApi:c,context:h,data:r.data,getValue:function(e){return r.data[e]},node:r});if(l){var d={value:p,colDef:i.filterParams.colDef,column:i.filterParams.column,node:r,data:r.data,api:i.filterParams.api,columnApi:i.filterParams.columnApi,context:i.filterParams.context};p=l(d)}null!=(p=e.makeNull(p))&&Array.isArray(p)?p.forEach((function(t){var i=e.toStringOrNull(e.makeNull(t));o(i)})):o(e.toStringOrNull(p))}})),e.values(r)},t}();!function(e){e[e.PROVIDED_LIST=0]="PROVIDED_LIST",e[e.PROVIDED_CALLBACK=1]="PROVIDED_CALLBACK",e[e.TAKEN_FROM_GRID_VALUES=2]="TAKEN_FROM_GRID_VALUES"}(y||(y={}));var F,g=function(){function o(l,o,n,a,s){var u=this;this.filterParams=l,this.setIsLoading=o,this.valueFormatterService=n,this.translate=a,this.caseFormat=s,this.localEventService=new t,this.miniFilterText=null,this.providedValues=null,this.allValues=[],this.availableValues=new Set,this.displayedValues=[],this.selectedValues=new Set,this.initialised=!1;var c=l.column,h=l.colDef,p=l.textFormatter,d=l.doesRowPassOtherFilter,f=l.suppressSorting,v=l.comparator,F=l.rowModel,g=l.values;l.caseSensitive;this.column=c,this.formatter=p||i.DEFAULT_FORMATTER,this.doesRowPassOtherFilters=d,this.suppressSorting=f||!1,this.comparator=v||h.comparator||e.defaultComparator,F.getType()===r.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideValuesExtractor=new m(F,this.filterParams,this.caseFormat)),null==g?this.valuesType=y.TAKEN_FROM_GRID_VALUES:(this.valuesType=Array.isArray(g)?y.PROVIDED_LIST:y.PROVIDED_CALLBACK,this.providedValues=g),this.updateAllValues().then((function(e){return u.resetSelectionState(e||[])}))}return o.prototype.addEventListener=function(e,t,i){this.localEventService.addEventListener(e,t,i)},o.prototype.removeEventListener=function(e,t,i){this.localEventService.removeEventListener(e,t,i)},o.prototype.refreshValues=function(){var e=this.getModel();return this.updateAllValues(),this.setModel(e)},o.prototype.overrideValues=function(e){var t=this;return new l((function(i){t.allValuesPromise.then((function(){t.valuesType=y.PROVIDED_LIST,t.providedValues=e,t.refreshValues().then((function(){return i()}))}))}))},o.prototype.refreshAfterAnyFilterChanged=function(){var e=this;return this.showAvailableOnly()?this.allValuesPromise.then((function(t){return e.updateAvailableValues(t||[])})):l.resolve()},o.prototype.isInitialised=function(){return this.initialised},o.prototype.updateAllValues=function(){var t=this;return this.allValuesPromise=new l((function(i){switch(t.valuesType){case y.TAKEN_FROM_GRID_VALUES:case y.PROVIDED_LIST:var r=t.valuesType===y.TAKEN_FROM_GRID_VALUES?t.getValuesFromRows(!1):e.values(t.uniqueValues(e.toStrings(t.providedValues)||[])),l=t.sortValues(r||[]);t.allValues=l,i(l);break;case y.PROVIDED_CALLBACK:t.setIsLoading(!0);var o=t.providedValues,n=t.filterParams,a=n.columnApi,s=n.api,u=n.context,c=n.column,h={success:function(r){var l=e.values(t.uniqueValues(e.toStrings(r)||[]));t.setIsLoading(!1);var o=t.sortValues(l||[]);t.allValues=o,i(o)},colDef:n.colDef,column:c,columnApi:a,api:s,context:u};window.setTimeout((function(){return o(h)}),0);break;default:throw new Error("Unrecognised valuesType")}})),this.allValuesPromise.then((function(e){return t.updateAvailableValues(e||[])})).then((function(){return t.initialised=!0})),this.allValuesPromise},o.prototype.setValuesType=function(e){this.valuesType=e},o.prototype.getValuesType=function(){return this.valuesType},o.prototype.isValueAvailable=function(e){return this.availableValues.has(e)},o.prototype.showAvailableOnly=function(){return this.valuesType===y.TAKEN_FROM_GRID_VALUES},o.prototype.updateAvailableValues=function(t){var i=this.showAvailableOnly()?this.sortValues(this.getValuesFromRows(!0)):t;this.availableValues=e.convertToSet(i),this.localEventService.dispatchEvent({type:o.EVENT_AVAILABLE_VALUES_CHANGED}),this.updateDisplayedValues()},o.prototype.sortValues=function(e){return this.suppressSorting?e:!this.filterParams.excelMode||e.indexOf(null)<0?e.sort(this.comparator):e.filter((function(e){return null!=e})).sort(this.comparator).concat(null)},o.prototype.getValuesFromRows=function(e){var t=this;if(void 0===e&&(e=!1),!this.clientSideValuesExtractor)return console.error("AG Grid: Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values"),[];return this.clientSideValuesExtractor.extractUniqueValues((function(i){return!e||t.doesRowPassOtherFilters(i)}))},o.prototype.setMiniFilter=function(t){return t=e.makeNull(t),this.miniFilterText!==t&&(this.miniFilterText=t,this.updateDisplayedValues(),!0)},o.prototype.getMiniFilter=function(){return this.miniFilterText},o.prototype.updateDisplayedValues=function(){var t=this;if(null!=this.miniFilterText){this.displayedValues=[];var i=this.caseFormat(this.formatter(this.miniFilterText)||""),r=function(e){return null!=e&&t.caseFormat(e).indexOf(i)>=0};this.availableValues.forEach((function(e){if(null==e)t.filterParams.excelMode&&r(t.translate("blanks"))&&t.displayedValues.push(e);else{var i=t.formatter(e),l=t.valueFormatterService.formatValue(t.column,null,i,t.filterParams.valueFormatter,!1);(r(i)||r(l))&&t.displayedValues.push(e)}}))}else this.displayedValues=e.values(this.availableValues)},o.prototype.getDisplayedValueCount=function(){return this.displayedValues.length},o.prototype.getDisplayedValue=function(e){return this.displayedValues[e]},o.prototype.hasSelections=function(){return this.filterParams.defaultToNothingSelected?this.selectedValues.size>0:this.allValues.length!==this.selectedValues.size},o.prototype.getValues=function(){return this.allValues.slice()},o.prototype.selectAllMatchingMiniFilter=function(t){var i=this;void 0===t&&(t=!1),null==this.miniFilterText?this.selectedValues=e.convertToSet(this.allValues):(t&&this.selectedValues.clear(),this.displayedValues.forEach((function(e){return i.selectedValues.add(e)})))},o.prototype.deselectAllMatchingMiniFilter=function(){var e=this;null==this.miniFilterText?this.selectedValues.clear():this.displayedValues.forEach((function(t){return e.selectedValues.delete(t)}))},o.prototype.selectValue=function(e){this.selectedValues.add(e)},o.prototype.deselectValue=function(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayedValues),this.selectedValues.delete(e)},o.prototype.isValueSelected=function(e){return this.selectedValues.has(e)},o.prototype.isEverythingVisibleSelected=function(){var e=this;return this.displayedValues.filter((function(t){return e.isValueSelected(t)})).length===this.displayedValues.length},o.prototype.isNothingVisibleSelected=function(){var e=this;return 0===this.displayedValues.filter((function(t){return e.isValueSelected(t)})).length},o.prototype.getModel=function(){return this.hasSelections()?e.values(this.selectedValues):null},o.prototype.setModel=function(e){var t=this;return this.allValuesPromise.then((function(i){if(null==e)t.resetSelectionState(i||[]);else{t.selectedValues.clear();var r=t.uniqueValues(i||[]);e.forEach((function(e){var i=r[t.uniqueKey(e)];void 0!==i&&t.selectedValues.add(i)}))}}))},o.prototype.uniqueValues=function(t){var i=this,r={};return(t||[]).forEach((function(t){var l=e.makeNull(t),o=i.uniqueKey(l);void 0===r[o]&&(r[o]=l)})),r},o.prototype.uniqueKey=function(e){return null==e?"__<ag-grid-pseudo-null>__":this.caseFormat(e)},o.prototype.resetSelectionState=function(t){this.filterParams.defaultToNothingSelected?this.selectedValues.clear():this.selectedValues=e.convertToSet(t||[])},o.EVENT_AVAILABLE_VALUES_CHANGED="availableValuesChanged",o}(),V=(F=function(e,t){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}F(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),M=function(e,t,i,r){var l,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(n=(o<3?l(n):o>3?l(t,i,n):l(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},S=function(e){function t(i,r,l,o){var n=e.call(this,t.TEMPLATE)||this;return n.value=i,n.params=r,n.translate=l,n.isSelected=o,n}return V(t,e),t.prototype.init=function(){var e=this;this.render(),this.eCheckbox.setValue(this.isSelected,!0),this.eCheckbox.setDisabled(!!this.params.readOnly),this.params.readOnly||this.eCheckbox.onValueChange((function(i){var r=i||!1;e.isSelected=r;var l={type:t.EVENT_SELECTION_CHANGED,isSelected:r};e.dispatchEvent(l)}))},t.prototype.toggleSelected=function(){this.params.readOnly||(this.isSelected=!this.isSelected,this.eCheckbox.setValue(this.isSelected))},t.prototype.render=function(){var e=this.params.column,t=this.value,i=null;if("function"==typeof t?t=t():i=this.getFormattedValue(this.params,e,t),this.params.showTooltips){var r=null!=i?i:t;this.setTooltip(r)}var l={value:t,valueFormatted:i,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),colDef:this.params.colDef,column:this.params.column};this.renderCell(l)},t.prototype.getTooltipParams=function(){var t=e.prototype.getTooltipParams.call(this);return t.location="setFilterValue",t.colDef=this.getComponentHolder(),t},t.prototype.getFormattedValue=function(e,t,i){var r=e&&e.valueFormatter;return this.valueFormatterService.formatValue(t,null,i,r,!1)},t.prototype.renderCell=function(e){var t=this,i=this.userComponentFactory.getSetFilterCellRendererDetails(this.params,e),r=i?i.newAgStackInstance():void 0;if(null!=r)r.then((function(e){e&&(t.eCheckbox.setLabel(e.getGui()),t.addDestroyFunc((function(){return t.destroyBean(e)})))}));else{var l=null==e.valueFormatted?e.value:e.valueFormatted;this.eCheckbox.setLabel(null==l?this.translate("blanks"):l)}},t.prototype.getComponentHolder=function(){return this.params.column.getColDef()},t.EVENT_SELECTION_CHANGED="selectionChanged",t.TEMPLATE='\n        <div class="ag-set-filter-item">\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',M([o("valueFormatterService")],t.prototype,"valueFormatterService",void 0),M([o("userComponentFactory")],t.prototype,"userComponentFactory",void 0),M([n("eCheckbox")],t.prototype,"eCheckbox",void 0),M([a],t.prototype,"init",null),t}(s),E={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",noMatches:"No matches."},A=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),w=function(e,t,i,r){var l,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(n=(o<3?l(n):o>3?l(t,i,n):l(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},L=function(t){function i(){var e=t.call(this,"setFilter")||this;return e.valueModel=null,e.setFilterParams=null,e.virtualList=null,e.caseSensitive=!1,e.appliedModelValues=null,e}return A(i,t),i.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.positionableFeature=new u(this.eSetFilterList,{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},i.prototype.updateUiVisibility=function(){},i.prototype.createBodyTemplate=function(){return'\n            <div class="ag-set-filter">\n                <div ref="eFilterLoading" class="ag-filter-loading ag-hidden">'+this.translateForSetFilter("loadingOoo")+'</div>\n                <ag-input-text-field class="ag-mini-filter" ref="eMiniFilter"></ag-input-text-field>\n                <div ref="eFilterNoMatches" class="ag-filter-no-matches ag-hidden">'+this.translateForSetFilter("noMatches")+'</div>\n                <div ref="eSetFilterList" class="ag-set-filter-list" role="presentation"></div>\n            </div>'},i.prototype.handleKeyDown=function(e){if(t.prototype.handleKeyDown.call(this,e),!e.defaultPrevented)switch(e.key){case c.SPACE:this.handleKeySpace(e);break;case c.ENTER:this.handleKeyEnter(e)}},i.prototype.handleKeySpace=function(e){var t=this.gridOptionsWrapper.getDocument();if(this.eSetFilterList.contains(t.activeElement)&&this.virtualList){var i=this.virtualList.getLastFocusedRow();if(null!=i){var r=this.virtualList.getComponentAt(i);if(null!=r)e.preventDefault(),(this.setFilterParams||{}).readOnly||r.toggleSelected()}}},i.prototype.handleKeyEnter=function(e){if(this.setFilterParams){var t=this.setFilterParams||{},i=t.excelMode,r=t.readOnly;i&&!r&&(e.preventDefault(),this.onBtApply(!1,!1,e),"mac"===this.setFilterParams.excelMode&&this.eMiniFilter.getInputElement().select())}},i.prototype.getCssIdentifier=function(){return"set-filter"},i.prototype.setModelAndRefresh=function(e){var t=this;return this.valueModel?this.valueModel.setModel(e).then((function(){return t.refresh()})):l.resolve()},i.prototype.resetUiToDefaults=function(){return this.setMiniFilter(null),this.setModelAndRefresh(null)},i.prototype.setModelIntoUi=function(e){this.setMiniFilter(null);var t=null==e?null:e.values;return this.setModelAndRefresh(t)},i.prototype.getModelFromUi=function(){if(!this.valueModel)throw new Error("Value model has not been created.");var e=this.valueModel.getModel();return e?{values:e,filterType:this.getFilterType()}:null},i.prototype.getFilterType=function(){return"set"},i.prototype.getValueModel=function(){return this.valueModel},i.prototype.areModelsEqual=function(t,i){return null==t&&null==i||null!=t&&null!=i&&e.areEqual(t.values,i.values)},i.prototype.setParams=function(e){var i=this;this.applyExcelModeOptions(e),t.prototype.setParams.call(this,e),this.setFilterParams=e,this.caseSensitive=e.caseSensitive||!1,this.valueModel=new g(e,(function(e){return i.showOrHideLoadingScreen(e)}),this.valueFormatterService,(function(e){return i.translateForSetFilter(e)}),(function(e){return i.caseFormat(e)})),this.initialiseFilterBodyUi(),e.rowModel.getType()!==r.ROW_MODEL_TYPE_CLIENT_SIDE||e.values||this.addEventListenersForDataChanges()},i.prototype.applyExcelModeOptions=function(e){"windows"===e.excelMode?(e.buttons||(e.buttons=["apply","cancel"]),null==e.closeOnApply&&(e.closeOnApply=!0)):"mac"===e.excelMode&&(e.buttons||(e.buttons=["reset"]),null==e.applyMiniFilterWhileTyping&&(e.applyMiniFilterWhileTyping=!0),null==e.debounceMs&&(e.debounceMs=500))},i.prototype.addEventListenersForDataChanges=function(){var e=this;this.addManagedListener(this.eventService,h.EVENT_ROW_DATA_UPDATED,(function(){return e.syncAfterDataChange()})),this.addManagedListener(this.eventService,h.EVENT_CELL_VALUE_CHANGED,(function(t){e.setFilterParams&&t.column===e.setFilterParams.column&&e.syncAfterDataChange()}))},i.prototype.syncAfterDataChange=function(e){var t=this;if(void 0===e&&(e=!0),!this.valueModel)throw new Error("Value model has not been created.");var i=l.resolve();return e&&(i=this.valueModel.refreshValues()),i.then((function(){t.refresh(),t.onBtApply(!1,!0)}))},i.prototype.showOrHideLoadingScreen=function(t){e.setDisplayed(this.eFilterLoading,t)},i.prototype.initialiseFilterBodyUi=function(){this.initVirtualList(),this.initMiniFilter()},i.prototype.initVirtualList=function(){var e=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var t=this.gridOptionsWrapper.getLocaleTextFunc()("ariaFilterList","Filter List"),i=this.virtualList=this.createBean(new p("filter","listbox",t)),r=this.getRefElement("eSetFilterList");r&&r.appendChild(i.getGui());var l,o=this.setFilterParams.cellHeight;null!=o&&i.setRowHeight(o),i.setComponentCreator((function(t){return e.createSetListItem(t)})),l=this.setFilterParams.suppressSelectAll?new b(this.valueModel):new _(this.valueModel,(function(){return e.isSelectAllSelected()})),i.setModel(l)},i.prototype.getSelectAllLabel=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var e=null!=this.valueModel.getMiniFilter()&&this.setFilterParams.excelMode?"selectAllSearchResults":"selectAll";return this.translateForSetFilter(e)},i.prototype.createSetListItem=function(e){var t,r=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");return e===i.SELECT_ALL_VALUE?((t=this.createBean(new S((function(){return r.getSelectAllLabel()}),this.setFilterParams,(function(e){return r.translateForSetFilter(e)}),this.isSelectAllSelected()))).addEventListener(S.EVENT_SELECTION_CHANGED,(function(e){return r.onSelectAll(e.isSelected)})),t):((t=this.createBean(new S(e,this.setFilterParams,(function(e){return r.translateForSetFilter(e)}),this.valueModel.isValueSelected(e)))).addEventListener(S.EVENT_SELECTION_CHANGED,(function(t){return r.onItemSelected(e,t.isSelected)})),t)},i.prototype.initMiniFilter=function(){var e=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var t=this.eMiniFilter,i=this.gridOptionsWrapper.getLocaleTextFunc();t.setDisplayed(!this.setFilterParams.suppressMiniFilter),t.setValue(this.valueModel.getMiniFilter()),t.onValueChange((function(){return e.onMiniFilterInput()})),t.setInputAriaLabel(i("ariaSearchFilterValues","Search filter values")),this.addManagedListener(t.getInputElement(),"keypress",(function(t){return e.onMiniFilterKeyPress(t)}))},i.prototype.afterGuiAttached=function(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");t.prototype.afterGuiAttached.call(this,e),this.setFilterParams.excelMode&&(this.resetUiToActiveModel(),this.showOrHideResults()),this.refreshVirtualList();var i=this.eMiniFilter;i.setInputPlaceholder(this.translateForSetFilter("searchOoo")),e&&e.suppressFocus||i.getFocusableElement().focus();var r,l=!(!e||"floatingFilter"!==e.container);r=this.gridOptionsWrapper.isEnableRtl()?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0},l?(this.positionableFeature.restoreLastSize(),this.positionableFeature.setResizable(r)):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1))},i.prototype.applyModel=function(){var e=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");this.setFilterParams.excelMode&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();var i=t.prototype.applyModel.call(this),r=this.getModel();return this.appliedModelValues=r?r.values.reduce((function(t,i){return t[e.caseFormat(String(i))]=!0,t}),{}):null,i},i.prototype.isModelValid=function(e){return!this.setFilterParams||!this.setFilterParams.excelMode||(null==e||e.values.length>0)},i.prototype.doesFilterPass=function(t){var i=this;if(!this.setFilterParams||!this.valueModel||!this.appliedModelValues)return!0;var r=t.node,l=t.data,o=this.setFilterParams,n=o.valueGetter,a=o.colDef.keyCreator,s=o.api,u=o.colDef,c=o.column,h=o.columnApi,p=o.context,d=n({api:s,colDef:u,column:c,columnApi:h,context:p,data:l,getValue:function(e){return l[e]},node:r});a&&(d=a({value:d,colDef:u,column:c,node:r,data:l,api:s,columnApi:h,context:p}));return d=e.makeNull(d),Array.isArray(d)?d.some((function(t){return!0===i.appliedModelValues[i.caseFormat(String(e.makeNull(t)))]})):!0===this.appliedModelValues[this.caseFormat(String(d))]},i.prototype.onNewRowsLoaded=function(){if(!this.valueModel)throw new Error("Value model has not been created.");var e=this.valueModel.getValuesType();this.syncAfterDataChange(e===y.TAKEN_FROM_GRID_VALUES)},i.prototype.setFilterValues=function(e){var t=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.overrideValues(e).then((function(){t.refresh(),t.onUiChanged()}))},i.prototype.resetFilterValues=function(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setValuesType(y.TAKEN_FROM_GRID_VALUES),this.syncAfterDataChange(!0)},i.prototype.refreshFilterValues=function(){var e=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.isInitialised()&&this.valueModel.refreshValues().then((function(){e.refresh(),e.onUiChanged()}))},i.prototype.onAnyFilterChanged=function(){var e=this;setTimeout((function(){if(e.isAlive()){if(!e.valueModel)throw new Error("Value model has not been created.");e.valueModel.refreshAfterAnyFilterChanged().then((function(){return e.refresh()}))}}),0)},i.prototype.onMiniFilterInput=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");if(this.valueModel.setMiniFilter(this.eMiniFilter.getValue())){var e=this.setFilterParams||{},t=e.applyMiniFilterWhileTyping;!e.readOnly&&t?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}},i.prototype.updateUiAfterMiniFilterChange=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var e=this.setFilterParams||{},t=e.excelMode,i=e.readOnly;null==t||i?this.refresh():null==this.valueModel.getMiniFilter()?this.resetUiToActiveModel():(this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged()),this.showOrHideResults()},i.prototype.showOrHideResults=function(){if(!this.valueModel)throw new Error("Value model has not been created.");var t=null!=this.valueModel.getMiniFilter()&&this.valueModel.getDisplayedValueCount()<1;e.setDisplayed(this.eNoMatches,t),e.setDisplayed(this.eSetFilterList,!t)},i.prototype.resetUiToActiveModel=function(){var e=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.eMiniFilter.setValue(null,!0),this.valueModel.setMiniFilter(null),this.setModelIntoUi(this.getModel()).then((function(){return e.onUiChanged(!1,"prevent")}))},i.prototype.onMiniFilterKeyPress=function(e){var t=this.setFilterParams||{},i=t.excelMode,r=t.readOnly;e.key!==c.ENTER||i||r||this.filterOnAllVisibleValues()},i.prototype.filterOnAllVisibleValues=function(e){void 0===e&&(e=!0);var t=(this.setFilterParams||{}).readOnly;if(!this.valueModel)throw new Error("Value model has not been created.");if(t)throw new Error("Unable to filter in readOnly mode.");this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()},i.prototype.focusRowIfAlive=function(e){var t=this;null!=e&&window.setTimeout((function(){if(!t.virtualList)throw new Error("Virtual list has not been created.");t.isAlive()&&t.virtualList.focusRow(e)}),0)},i.prototype.onSelectAll=function(e){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter();var t=this.virtualList.getLastFocusedRow();this.refresh(),this.onUiChanged(),this.focusRowIfAlive(t)},i.prototype.onItemSelected=function(e,t){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");t?this.valueModel.selectValue(e):this.valueModel.deselectValue(e);var i=this.virtualList.getLastFocusedRow();this.refresh(),this.onUiChanged(),this.focusRowIfAlive(i)},i.prototype.setMiniFilter=function(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()},i.prototype.getMiniFilter=function(){return this.valueModel?this.valueModel.getMiniFilter():null},i.prototype.refresh=function(){if(!this.virtualList)throw new Error("Virtual list has not been created.");this.virtualList.refresh()},i.prototype.getValues=function(){return this.valueModel?this.valueModel.getValues():[]},i.prototype.refreshVirtualList=function(){this.setFilterParams&&this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.refresh()},i.prototype.translateForSetFilter=function(e){return this.gridOptionsWrapper.getLocaleTextFunc()(e,E[e])},i.prototype.isSelectAllSelected=function(){if(!this.setFilterParams||!this.valueModel)return!1;if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}},i.prototype.destroy=function(){null!=this.virtualList&&(this.virtualList.destroy(),this.virtualList=null),t.prototype.destroy.call(this)},i.prototype.caseFormat=function(e){return null==e||"string"!=typeof e||this.caseSensitive?e:e.toUpperCase()},i.SELECT_ALL_VALUE="__AG_SELECT_ALL__",w([n("eMiniFilter")],i.prototype,"eMiniFilter",void 0),w([n("eFilterLoading")],i.prototype,"eFilterLoading",void 0),w([n("eSetFilterList")],i.prototype,"eSetFilterList",void 0),w([n("eFilterNoMatches")],i.prototype,"eNoMatches",void 0),w([o("valueFormatterService")],i.prototype,"valueFormatterService",void 0),i}(d),b=function(){function e(e){this.model=e}return e.prototype.getRowCount=function(){return this.model.getDisplayedValueCount()},e.prototype.getRow=function(e){return this.model.getDisplayedValue(e)},e.prototype.isRowSelected=function(e){return this.model.isValueSelected(this.getRow(e))},e}(),_=function(){function e(e,t){this.model=e,this.isSelectAllSelected=t}return e.prototype.getRowCount=function(){return this.model.getDisplayedValueCount()+1},e.prototype.getRow=function(e){return 0===e?L.SELECT_ALL_VALUE:this.model.getDisplayedValue(e-1)},e.prototype.isRowSelected=function(e){return 0===e?this.isSelectAllSelected():this.model.isValueSelected(this.getRow(e))},e}(),T=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),P=function(e,t,i,r){var l,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(n=(o<3?l(n):o>3?l(t,i,n):l(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},O=function(e){function t(){var t=e.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this;return t.availableValuesListenerAdded=!1,t}return T(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){var t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.gridOptionsWrapper.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(t+" "+i("ariaFilterInput","Filter Input")).addGuiEventListener("click",(function(){return e.showParentFilter()})),this.params=e},t.prototype.onParentModelChanged=function(e){this.updateFloatingFilterText(e)},t.prototype.parentSetFilterInstance=function(e){this.params.parentFilterInstance((function(t){if(!(t instanceof L))throw new Error("AG Grid - SetFloatingFilter expects SetFilter as it's parent");e(t)}))},t.prototype.addAvailableValuesListener=function(){var e=this;this.parentSetFilterInstance((function(t){var i=t.getValueModel();i&&e.addManagedListener(i,g.EVENT_AVAILABLE_VALUES_CHANGED,(function(){return e.updateFloatingFilterText()}))})),this.availableValuesListenerAdded=!0},t.prototype.updateFloatingFilterText=function(e){var t=this;this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance((function(i){var r=(e||i.getModel()||{}).values,l=i.getValueModel();if(null!=r&&null!=l){var o=t.gridOptionsWrapper.getLocaleTextFunc(),n=r.filter((function(e){return l.isValueAvailable(e)})).map((function(e){var i=t.params,r=i.column,l=i.filterParams,n=t.valueFormatterService.formatValue(r,null,e,l.valueFormatter,!1),a=null!=n?n:e;return null==a?o("blanks",E.blanks):a})),a=n.length>10?n.slice(0,10).concat("..."):n,s="("+n.length+") "+a.join(",");t.eFloatingFilterText.setValue(s)}else t.eFloatingFilterText.setValue("")}))},P([n("eFloatingFilterText")],t.prototype,"eFloatingFilterText",void 0),P([o("valueFormatterService")],t.prototype,"valueFormatterService",void 0),P([o("columnModel")],t.prototype,"columnModel",void 0),t}(s),C={moduleName:f.SetFilterModule,beans:[],userComponents:[{componentName:"agSetColumnFilter",componentClass:L},{componentName:"agSetColumnFloatingFilter",componentClass:O}],dependantModules:[v]};export{L as SetFilter,C as SetFilterModule};